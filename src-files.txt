
===== src/Pages/pos/newSales/components/ActionButtons.tsx =====
// src/Pages/pos/newSales/components/ActionButtons.tsx
import React from 'react';

interface ActionButtonsProps {
  selectedChips: string[];
  onChipClick: (chipType: string) => void;
  isExtraMode: boolean;
  isWithoutMode: boolean;
  onExtraClick: () => void;
  onWithoutClick: () => void;
  searchQuery: string;
  onSearchChange: (query: string) => void;
    hasSelectedOrderItem: boolean; // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©

}

const ActionButtons: React.FC<ActionButtonsProps> = ({
  selectedChips,
  onChipClick,
  isExtraMode,
  isWithoutMode,
  onExtraClick,
  onWithoutClick,
  searchQuery,
  onSearchChange,
  hasSelectedOrderItem

}) => {
  return (
    <div className="action-buttons-bar">
      <div className="action-chips">
        <button 
          className={`action-chip extra ${selectedChips.includes('extra') || isExtraMode ? 'active' : ''} ${!hasSelectedOrderItem ? 'disabled' : ''}`}
          onClick={hasSelectedOrderItem ? onExtraClick : undefined}
          disabled={!hasSelectedOrderItem}
          title={!hasSelectedOrderItem ? 'Ÿäÿ¨ÿ® ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÜÿ™ÿ¨ ŸÖŸÜ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ£ŸàŸÑÿßŸã' : ''}
        >
          <img src="/images/img_addcircle.svg" alt="" />
          <span>Extra</span>
        </button>
        <button 
          className={`action-chip without ${selectedChips.includes('without') || isWithoutMode ? 'active' : ''} ${!hasSelectedOrderItem ? 'disabled' : ''}`}
          onClick={hasSelectedOrderItem ? onWithoutClick : undefined}
          disabled={!hasSelectedOrderItem}
          title={!hasSelectedOrderItem ? 'Ÿäÿ¨ÿ® ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÜÿ™ÿ¨ ŸÖŸÜ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ£ŸàŸÑÿßŸã' : ''}
        >
          <img src="/images/img_removecircle.svg" alt="" />
          <span>Without</span>
        </button>
        <button 
          className={`action-chip offer ${selectedChips.includes('offer') ? 'active' : ''}`}
          onClick={() => onChipClick('offer')}
        >
          <img src="/images/img_tags.svg" alt="" />
          <span>Offer</span>
        </button>
      </div>
      
      <div className="search-container">
        <img src="/images/img_search01.svg" alt="search" className="search-icon" />
        <input
          type="text"
          placeholder="Search"
          value={searchQuery}
          onChange={(e) => onSearchChange(e.target.value)}
          className="search-input"
        />
        <button className="filter-button">
          <img src="/images/img_group_7.svg" alt="Filter" />
        </button>
      </div>
    </div>
  );
};

export default ActionButtons;

===== src/Pages/pos/newSales/components/common/Header.tsx =====
// src/Pages/pos/newSales/components/Header.tsx
import React, { useState, useRef, useEffect } from 'react';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import { DeliveryCompany } from '../../../../../utils/api/pagesApi/deliveryCompaniesApi';
import { Invoice } from '../../../../../utils/api/pagesApi/invoicesApi'; // ÿ•ÿ∂ÿßŸÅÿ© ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ Invoice type
import '../../styles/Header.css';
import TodayOrdersPopup from '../TodayOrdersPopup';

interface HeaderProps {
  selectedOrderType: string;
  onOrderTypeChange: (type: string) => void;
  onResetOrder?: () => void;
  onTableClick?: () => void;
  tableDisplayName?: string;
  deliveryCompanies?: DeliveryCompany[];
  selectedDeliveryCompany?: DeliveryCompany | null;
  onDeliveryCompanySelect?: (company: DeliveryCompany) => void;
  selectedCustomer?: Customer | null;
  selectedAddress?: CustomerAddress | null;
  // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© prop ŸÖÿ∑ŸÑŸàÿ® ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ®
  onViewOrder?: (invoiceData: Invoice & { isEditMode: boolean }) => void;
}

const Header: React.FC<HeaderProps> = ({ 
  selectedOrderType, 
  onOrderTypeChange, 
  onResetOrder,
  onTableClick,
  tableDisplayName = 'Table',
  deliveryCompanies = [],
  selectedDeliveryCompany,
  onDeliveryCompanySelect,
  selectedCustomer,
  selectedAddress,
  onViewOrder // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© ŸÅŸä destructuring
}) => {
  const [isDropdownOpen, setIsDropdownOpen] = useState(false);
  const dropdownRef = useRef<HTMLDivElement>(null);
  const [showTodayOrders, setShowTodayOrders] = useState(false);

  const orderTypes = [
    { id: 1, name: 'Takeaway', displayName: 'Takeaway', icon: '/images/takeaway.png', color: '#28a745', description: 'ÿπŸÖŸäŸÑ Ÿäÿ£ÿÆÿ∞ ÿßŸÑÿ∑ŸÑÿ®' },
    { id: 2, name: 'Dine-in', displayName: 'Dine-in', icon: '/images/dine-in.png', color: '#007bff', description: 'ÿ™ŸÜÿßŸàŸÑ ŸÅŸä ÿßŸÑŸÖÿ∑ÿπŸÖ' },
    { id: 3, name: 'Delivery', displayName: 'Delivery', icon: '/images/delivery.png', color: '#dc3545', description: 'ÿ™ŸàÿµŸäŸÑ ŸÑŸÑŸÖŸÜÿ≤ŸÑ' },
    { id: 4, name: 'Pickup', displayName: 'Pickup', icon: '/images/pickup.png', color: '#ffc107', description: 'ÿßÿ≥ÿ™ŸÑÿßŸÖ ŸÖŸÜ ÿßŸÑŸÖÿ∑ÿπŸÖ' }
  ];

  const handleDeliveryCompanySelect = (company: DeliveryCompany) => {
    if (onDeliveryCompanySelect) {
      onDeliveryCompanySelect(company);
    }
    setIsDropdownOpen(false);
  };

  const activeDeliveryCompanies = deliveryCompanies.filter(company => company.isActive);

  // ŸÖÿπÿßŸÑÿ¨ ÿßŸÑŸÜŸÇÿ± ÿπŸÑŸâ ÿ≤ÿ± Today Orders
  const handleTodayOrdersClick = (e: React.MouseEvent) => {
    e.preventDefault();
    setShowTodayOrders(true);
  };

  // ŸÖÿπÿßŸÑÿ¨ ÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ® - ÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
  const handleViewOrder = (invoiceData: Invoice & { isEditMode: boolean }) => {
    console.log('Header: ÿ™ŸÖ ÿßÿ≥ÿ™ŸÇÿ®ÿßŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸÑŸÑÿπÿ±ÿ∂:', invoiceData);
    
    // ÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
    if (onViewOrder) {
      onViewOrder(invoiceData);
    } else {
      console.warn('Header: onViewOrder prop ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±');
    }
    
    // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© Today Orders
    setShowTodayOrders(false);
  };

  // ÿ•ÿ∫ŸÑÿßŸÇ dropdown ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿá
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {
        setIsDropdownOpen(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  return (
    <>
      <header className="pos-header">
        <div className="header-content">
          <img src="/images/img_foodify_logo_2_78x166.png" alt="Foodify Logo" className="header-logo" />

          {/* Customer Info Section */}
          {selectedCustomer && (
            <div className="customer-info-section">
              <div className="customer-info-card">
                <div className="customer-basic-info">
                  <div className="customer-name">
                    <span className="customer-icon">üë§</span>
                    <span>{selectedCustomer.name}</span>
                    {selectedCustomer.isVIP && <span className="vip-badge">VIP</span>}
                  </div>
                  <div className="customer-phone">
                    <span className="phone-icon">üìû</span>
                    <span>{selectedCustomer.phone1}</span>
                  </div>
                </div>

                {selectedAddress && selectedAddress.addressLine && (
                  <div className="customer-address">
                    <span className="address-icon">üìç</span>
                    <span className="address-text">
                      {selectedAddress.addressLine}
                      {selectedAddress.zoneName && ` - ${selectedAddress.zoneName}`}
                    </span>
                  </div>
                )}
              </div>
            </div>
          )}

          <nav className="header-nav">
            <a
              href="#"
              className="nav-item active today-orders-btn"
              onClick={handleTodayOrdersClick}
              title="ÿπÿ±ÿ∂ ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸäŸàŸÖ"
            >
              <img src="/images/img_sending_order.svg" alt="Today Orders" />
              <span>Today Orders</span>
            </a>

            <a 
              href="#" 
              className="nav-item" 
              onClick={(e) => { 
                e.preventDefault(); 
                if (onTableClick) onTableClick(); 
              }}
            >
              <img src="/images/img_table_02.svg" alt="Table" />
              <span>{tableDisplayName}</span>
            </a>

            <a href="#" className="nav-item">
              <img src="/images/img_discount_tag_01.svg" alt="Discount" />
              <span>Discount</span>
            </a>

            <a href="#" className="nav-item">
              <img src="/images/img_delete_01.svg" alt="Void" />
              <span>Void</span>
            </a>

            <button 
              className="order-type-display clickable" 
              onClick={onResetOrder}
            >
              {selectedOrderType}
            </button>

            <div className="menu-dropdown-container" ref={dropdownRef}>
              <button 
                className="menu-button" 
                onClick={() => setIsDropdownOpen(!isDropdownOpen)}
                aria-expanded={isDropdownOpen}
                title="ÿßŸÑŸÇÿßÿ¶ŸÖÿ©"
              >
                <img src="/images/img_menu_01.svg" alt="Menu" />
              </button>

              {isDropdownOpen && (
                <div className="professional-dropdown">
                  <div className="dropdown-section">
                    <div className="section-header">
                      <h3 className="section-title">ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®</h3>
                      <div className="section-divider"></div>
                    </div>

                    <div className="order-types-grid">
                      {orderTypes.map((type) => (
                        <button
                          key={type.id}
                          className={`order-type-card ${selectedOrderType === type.name ? 'selected' : ''}`}
                          onClick={() => { 
                            onOrderTypeChange(type.name); 
                            setIsDropdownOpen(false); 
                          }}
                          style={{ '--accent-color': type.color } as React.CSSProperties}
                          title={type.description}
                        >
                          <div className="card-icon-container">
                            <img src={type.icon} alt={type.displayName} className="card-icon" />
                          </div>
                          <div className="card-content">
                            <div className="card-title">{type.displayName}</div>
                          </div>
                          <div className="card-check">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                              <path d="M13 4L6 11L3 8" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                            </svg>
                          </div>
                        </button>
                      ))}
                    </div>
                  </div>

                  {activeDeliveryCompanies.length > 0 && (
                    <div className="dropdown-section">
                      <div className="section-header">
                        <h3 className="section-title">ÿ¥ÿ±ŸÉÿßÿ° ÿßŸÑÿ™ŸàÿµŸäŸÑ</h3>
                        <div className="section-divider"></div>
                      </div>

                      <div className="delivery-partners-grid">
                        {activeDeliveryCompanies.map((company) => (
                          <button
                            key={company.id}
                            className={`delivery-partner-card ${selectedDeliveryCompany?.id === company.id ? 'selected' : ''}`}
                            onClick={() => handleDeliveryCompanySelect(company)}
                            style={{
                              '--partner-color': '#0373ed',
                              '--partner-bg': '#f8f9fa'
                            } as React.CSSProperties}
                            title={`ÿßÿÆÿ™Ÿäÿßÿ± ${company.name} - ${company.paymentType}`}
                          >
                            <div className="partner-icon-container">
                              <img src="/images/default-delivery.png" alt={company.name} className="partner-icon" />
                            </div>
                            <div className="partner-content">
                              <div className="partner-name">{company.name}</div>
                              <div className="partner-status">{company.paymentType}</div>
                            </div>
                            <div className="partner-badge">
                              <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <circle cx="6" cy="6" r="6" fill="currentColor" />
                              </svg>
                            </div>
                          </button>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              )}
            </div>
          </nav>
        </div>
      </header>

      {/* Today Orders Popup */}
      <TodayOrdersPopup
        isOpen={showTodayOrders}
        onClose={() => setShowTodayOrders(false)}
        currentOrderType={selectedOrderType}
        onViewOrder={handleViewOrder}
      />
    </>
  );
};

export default Header;

===== src/Pages/pos/newSales/components/CustomerDetailsPopup.tsx =====
// src/Pages/pos/newSales/components/CustomerDetailsPopup.tsx
import React, { useState, useEffect } from 'react';
import {
  Dialog, DialogTitle, DialogContent, DialogActions,
  TextField, Button, Box, Typography, Card, CardContent,
  Radio, RadioGroup, FormControlLabel, Divider, IconButton
} from '@mui/material';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import * as customersApi from 'src/utils/api/pagesApi/customersApi';
import * as deliveryZonesApi from 'src/utils/api/pagesApi/deliveryZonesApi';
import { Edit as EditIcon, LocationOn as LocationIcon } from '@mui/icons-material';
import CustomerForm from '../../customers/components/CustomerForm';

interface CustomerDetailsPopupProps {
  open: boolean;
  customer: Customer | null;
  onClose: () => void;
  onSelectCustomer: (customer: Customer, address: CustomerAddress) => void;
}

const CustomerDetailsPopup: React.FC<CustomerDetailsPopupProps> = ({
  open,
  customer,
  onClose,
  onSelectCustomer
}) => {
  const [selectedAddressId, setSelectedAddressId] = useState<string>('');
  const [showEditForm, setShowEditForm] = useState(false);
  const [zones, setZones] = useState<any[]>([]);
  const [updatedCustomer, setUpdatedCustomer] = useState<Customer | null>(null);

  useEffect(() => {
    if (customer) {
      setUpdatedCustomer(customer);
      setSelectedAddressId('');
    }
  }, [customer]);

  useEffect(() => {
    const loadZones = async () => {
      try {
        const zonesData = await deliveryZonesApi.getAll();
        setZones(zonesData);
      } catch (error) {
        console.error('Error loading zones:', error);
      }
    };
    
    if (open) {
      loadZones();
    }
  }, [open]);

  const handleAddressSelect = (addressId: string) => {
    setSelectedAddressId(addressId);
  };

  const handleConfirmSelection = () => {
    if (updatedCustomer && selectedAddressId) {
      const selectedAddress = updatedCustomer.addresses.find(
        addr => addr.id === selectedAddressId
      );
      if (selectedAddress) {
        onSelectCustomer(updatedCustomer, selectedAddress);
        onClose();
      }
    }
  };

  const handleEditCustomer = () => {
    setShowEditForm(true);
  };

  const handleCustomerUpdate = async (data: any) => {
    try {
      const updated = await customersApi.update(data);
      setUpdatedCustomer(updated);
      setShowEditForm(false);
    } catch (error) {
      console.error('Error updating customer:', error);
    }
  };

  const getZoneName = (zoneId: string): string => {
    const zone = zones.find(z => z.id === zoneId);
    return zone ? zone.name : 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
  };

  const getDeliveryCharge = (zoneId: string): number => {
    const zone = zones.find(z => z.id === zoneId);
    return zone ? zone.deliveryCharge : 0;
  };

  if (!updatedCustomer) return null;

  return (
    <>
      <Dialog 
        open={open && !showEditForm} 
        onClose={onClose} 
        maxWidth="md" 
        fullWidth
        PaperProps={{
          style: { minHeight: '600px' }
        }}
      >
        <DialogTitle>
          <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
            <Typography variant="h6">ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ</Typography>
            <IconButton onClick={handleEditCustomer} color="primary">
              <EditIcon />
            </IconButton>
          </Box>
        </DialogTitle>

        <DialogContent>
          {/* Customer Basic Info */}
          <Card sx={{ mb: 3 }}>
            <CardContent>
              <Typography variant="h6" gutterBottom>
                ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
              </Typography>
              <Box sx={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: 2 }}>
                <TextField
                  label="ÿßŸÑÿßÿ≥ŸÖ"
                  value={updatedCustomer.name}
                  InputProps={{ readOnly: true }}
                  variant="outlined"
                />
                <TextField
                  label="ÿßŸÑŸáÿßÿ™ŸÅ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä"
                  value={updatedCustomer.phone1}
                  InputProps={{ readOnly: true }}
                  variant="outlined"
                />
                {updatedCustomer.phone2 && (
                  <TextField
                    label="ÿßŸÑŸáÿßÿ™ŸÅ ÿßŸÑÿ´ÿßŸÜŸä"
                    value={updatedCustomer.phone2}
                    InputProps={{ readOnly: true }}
                    variant="outlined"
                  />
                )}
                {updatedCustomer.phone3 && (
                  <TextField
                    label="ÿßŸÑŸáÿßÿ™ŸÅ ÿßŸÑÿ´ÿßŸÑÿ´"
                    value={updatedCustomer.phone3}
                    InputProps={{ readOnly: true }}
                    variant="outlined"
                  />
                )}
              </Box>
              
              <Box sx={{ display: 'flex', gap: 2, mt: 2 }}>
                {updatedCustomer.isVIP && (
                  <Typography 
                    variant="body2" 
                    sx={{ 
                      bgcolor: 'gold', 
                      color: 'white', 
                      px: 1, 
                      py: 0.5, 
                      borderRadius: 1 
                    }}
                  >
                    ÿπŸÖŸäŸÑ VIP
                  </Typography>
                )}
                {updatedCustomer.isBlocked && (
                  <Typography 
                    variant="body2" 
                    sx={{ 
                      bgcolor: '#f44336', 
                      color: 'white', 
                      px: 1, 
                      py: 0.5, 
                      borderRadius: 1 
                    }}
                  >
                    ŸÖÿ≠ÿ∏Ÿàÿ±
                  </Typography>
                )}
              </Box>
            </CardContent>
          </Card>

          <Divider sx={{ my: 2 }} />

          {/* Address Selection */}
          <Typography variant="h6" sx={{ mb: 2 }}>
            ÿßÿÆÿ™ÿ± ÿßŸÑÿπŸÜŸàÿßŸÜ ŸÑŸÑÿ∑ŸÑÿ® ({updatedCustomer.addresses.length})
          </Typography>
          
          <RadioGroup
            value={selectedAddressId}
            onChange={(e) => handleAddressSelect(e.target.value)}
          >
            {updatedCustomer.addresses.map((address) => (
              <FormControlLabel
                key={address.id}
                value={address.id}
                control={<Radio />}
                label={
                  <Card 
                    sx={{ 
                      width: '100%', 
                      ml: 1,
                      border: selectedAddressId === address.id ? '2px solid #1976d2' : '1px solid #e0e0e0'
                    }}
                  >
                    <CardContent sx={{ py: 2 }}>
                      <Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 1 }}>
                        <LocationIcon color="primary" />
                        <Box sx={{ flex: 1 }}>
                          <Typography variant="body1" fontWeight="bold">
                            {address.addressLine}
                          </Typography>
                          <Typography variant="body2" color="text.secondary">
                            ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©: {getZoneName(address.zoneId)}
                          </Typography>
                          <Typography variant="body2" color="primary">
                            ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ™ŸàÿµŸäŸÑ: {getDeliveryCharge(address.zoneId)} ÿ¨ŸÜŸäŸá
                          </Typography>
                          
                          {address.floor && (
                            <Typography variant="body2" color="text.secondary">
                              ÿßŸÑÿØŸàÿ±: {address.floor}
                            </Typography>
                          )}
                          {address.apartment && (
                            <Typography variant="body2" color="text.secondary">
                              ÿßŸÑÿ¥ŸÇÿ©: {address.apartment}
                            </Typography>
                          )}
                          {address.landmark && (
                            <Typography variant="body2" color="text.secondary">
                              ÿπŸÑÿßŸÖÿ© ŸÖŸÖŸäÿ≤ÿ©: {address.landmark}
                            </Typography>
                          )}
                          {address.notes && (
                            <Typography variant="body2" color="text.secondary">
                              ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™: {address.notes}
                            </Typography>
                          )}
                        </Box>
                      </Box>
                    </CardContent>
                  </Card>
                }
                sx={{ 
                  alignItems: 'flex-start',
                  mb: 1,
                  ml: 0,
                  mr: 0
                }}
              />
            ))}
          </RadioGroup>

          {updatedCustomer.addresses.length === 0 && (
            <Box sx={{ textAlign: 'center', py: 4 }}>
              <Typography variant="body1" color="text.secondary">
                ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿπŸÜÿßŸàŸäŸÜ ŸÖÿ≥ÿ¨ŸÑÿ© ŸÑŸáÿ∞ÿß ÿßŸÑÿπŸÖŸäŸÑ
              </Typography>
            </Box>
          )}
        </DialogContent>

        <DialogActions>
          <Button onClick={onClose}>
            ÿ•ŸÑÿ∫ÿßÿ°
          </Button>
          <Button 
            variant="contained" 
            onClick={handleConfirmSelection}
            disabled={!selectedAddressId}
          >
            ÿ≠ŸÅÿ∏ ŸàÿßÿÆÿ™Ÿäÿßÿ±
          </Button>
        </DialogActions>
      </Dialog>

      {/* Customer Edit Form */}
      {showEditForm && (
        <CustomerForm
          open={showEditForm}
          mode="edit"
          initialValues={updatedCustomer}
          onClose={() => setShowEditForm(false)}
          onSubmit={handleCustomerUpdate}
        />
      )}
    </>
  );
};

export default CustomerDetailsPopup;

===== src/Pages/pos/newSales/components/OrderItemDetailsPopup.tsx =====
// src/Pages/pos/newSales/components/OrderItemDetailsPopup.tsx
import React, { useState, useEffect, useRef } from 'react';
import { OrderItem } from '../types/PosSystem';
import AddIcon from '@mui/icons-material/Add';
import RemoveIcon from '@mui/icons-material/Remove';
import styles from '../styles/OrderItemDetailsPopup.module.css';

interface OrderItemDetailsPopupProps {
  orderItem: OrderItem | null;
  isOpen: boolean;
  onClose: () => void;
  onUpdateItem: (itemId: string, updates: {
    quantity?: number;
    notes?: string;
    discountPercentage?: number;
    discountAmount?: number;
  }) => void;
  onRemoveItem: (itemId: string) => void;
}

const OrderItemDetailsPopup: React.FC<OrderItemDetailsPopupProps> = ({
  orderItem,
  isOpen,
  onClose,
  onUpdateItem
}) => {
  const [quantity, setQuantity] = useState(1);
  const [notes, setNotes] = useState('');
  const [discountPercentage, setDiscountPercentage] = useState(0);
  const [discountAmount, setDiscountAmount] = useState(0);
  
  // States ŸÖÿ§ŸÇÿ™ÿ© ŸÑŸÑÿ™ÿ≠ŸÉŸÖ ŸÅŸä ÿßŸÑÿ™ÿ≠ÿØŸäÿ´
  const [tempDiscountPercentage, setTempDiscountPercentage] = useState('0');
  const [tempDiscountAmount, setTempDiscountAmount] = useState('0');
  
  // Refs ŸÑŸÑŸÄ inputs
  const percentageInputRef = useRef<HTMLInputElement>(null);
  const amountInputRef = useRef<HTMLInputElement>(null);

  useEffect(() => {
    if (orderItem) {
      setQuantity(orderItem.quantity);
      setNotes(orderItem.notes || '');
      const currentDiscount = orderItem.discountAmount || 0;
      const baseTotal = orderItem.selectedPrice.price * orderItem.quantity;
      const currentDiscountPercentage = baseTotal > 0 ? (currentDiscount / baseTotal) * 100 : 0;
      setDiscountAmount(currentDiscount);
      setDiscountPercentage(currentDiscountPercentage);
      setTempDiscountAmount(currentDiscount.toFixed(2));
      setTempDiscountPercentage(currentDiscountPercentage.toFixed(1));
    }
  }, [orderItem]);

  if (!isOpen || !orderItem) return null;

  const unitPrice = orderItem.selectedPrice.price;
  const subItemsTotal = orderItem.subItems?.reduce((sum, item) => sum + item.price, 0) || 0;
  const baseTotal = (unitPrice * quantity) + subItemsTotal;
  const finalTotal = baseTotal - discountAmount;

  const handleQuantityChange = (change: number) => {
    const newQuantity = Math.max(1, quantity + change);
    setQuantity(newQuantity);
    
    const newBaseTotal = (unitPrice * newQuantity) + subItemsTotal;
    const newDiscountAmount = (newBaseTotal * discountPercentage) / 100;
    setDiscountAmount(newDiscountAmount);
    setTempDiscountAmount(newDiscountAmount.toFixed(2));
  };

  // ŸÖÿπÿßŸÑÿ¨ ÿ™ÿ∫ŸäŸäÿ± ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿÆÿµŸÖ
  const handleDiscountPercentageChange = (value: number) => {
    const percentage = Math.max(0, Math.min(100, value));
    setDiscountPercentage(percentage);
    const newDiscountAmount = (baseTotal * percentage) / 100;
    setDiscountAmount(newDiscountAmount);
    setTempDiscountAmount(newDiscountAmount.toFixed(2));
  };

  // ŸÖÿπÿßŸÑÿ¨ ÿ™ÿ∫ŸäŸäÿ± ŸÇŸäŸÖÿ© ÿßŸÑÿÆÿµŸÖ
  const handleDiscountAmountChange = (value: number) => {
    const amount = Math.max(0, Math.min(baseTotal, value));
    setDiscountAmount(amount);
    const newDiscountPercentage = baseTotal > 0 ? (amount / baseTotal) * 100 : 0;
    setDiscountPercentage(newDiscountPercentage);
    setTempDiscountPercentage(newDiscountPercentage.toFixed(1));
  };

  // ŸÖÿπÿßŸÑÿ¨ Focus ŸÑŸÑŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÖÿ¶ŸàŸäÿ©
  const handlePercentageFocus = () => {
    if (percentageInputRef.current) {
      percentageInputRef.current.select();
    }
  };

  // ŸÖÿπÿßŸÑÿ¨ Focus ŸÑŸÇŸäŸÖÿ© ÿßŸÑÿÆÿµŸÖ
  const handleAmountFocus = () => {
    if (amountInputRef.current) {
      amountInputRef.current.select();
    }
  };

  // ŸÖÿπÿßŸÑÿ¨ Blur ŸÑŸÑŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÖÿ¶ŸàŸäÿ©
  const handlePercentageBlur = () => {
    const value = parseFloat(tempDiscountPercentage) || 0;
    handleDiscountPercentageChange(value);
  };

  // ŸÖÿπÿßŸÑÿ¨ Blur ŸÑŸÇŸäŸÖÿ© ÿßŸÑÿÆÿµŸÖ
  const handleAmountBlur = () => {
    const value = parseFloat(tempDiscountAmount) || 0;
    handleDiscountAmountChange(value);
  };

  // ŸÖÿπÿßŸÑÿ¨ Enter ŸÑŸÑŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÖÿ¶ŸàŸäÿ©
  const handlePercentageKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      const value = parseFloat(tempDiscountPercentage) || 0;
      handleDiscountPercentageChange(value);
      percentageInputRef.current?.blur();
    }
  };

  // ŸÖÿπÿßŸÑÿ¨ Enter ŸÑŸÇŸäŸÖÿ© ÿßŸÑÿÆÿµŸÖ
  const handleAmountKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      const value = parseFloat(tempDiscountAmount) || 0;
      handleDiscountAmountChange(value);
      amountInputRef.current?.blur();
    }
  };

  const handleConfirm = () => {
    onUpdateItem(orderItem.id, {
      quantity,
      notes,
      discountPercentage,
      discountAmount
    });
    onClose();
  };

  return (
    <div className={styles.popupOverlay}>
      <div className={styles.orderItemDetails}>
        
        {/* ÿ≥ÿ∑ÿ± Ÿàÿßÿ≠ÿØ ŸÅŸÇÿ∑: ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ + ÿßŸÑÿ≥ÿπÿ± + ÿßŸÑŸÉŸÖŸäÿ© + ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä */}
        <div className={styles.mainRow}>
          {/* ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸàÿßŸÑÿ≥ÿπÿ± ÿπŸÑŸâ ÿßŸÑŸäŸÖŸäŸÜ */}
          <div className={styles.productInfo}>
            <span className={styles.productName}>{orderItem.product.nameArabic}</span>
            {orderItem.product.hasMultiplePrices && (
              <span className={styles.productSize}> - {orderItem.selectedPrice.nameArabic}</span>
            )}
            <span className={styles.unitPrice}>{unitPrice} EGP</span>
          </div>

          {/* ÿßŸÑŸÉŸÖŸäÿ© ŸÅŸä ÿßŸÑŸÜÿµ */}
          <div className={styles.quantityControls}>
            <button
              className={styles.quantityBtn}
              onClick={() => handleQuantityChange(-1)}
              disabled={quantity <= 1}
            >
              <RemoveIcon />
            </button>
            <span className={styles.quantityDisplay}>{quantity}</span>
            <button
              className={styles.quantityBtn}
              onClick={() => handleQuantityChange(1)}
            >
              <AddIcon />
            </button>
          </div>
          
          {/* ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿπŸÑŸâ ÿßŸÑÿ¥ŸÖÿßŸÑ */}
          <div className={styles.totalDisplay}>
            <span className={styles.totalAmount}>{finalTotal.toFixed(2)} EGP</span>
          </div>
        </div>

        {/* ÿ≠ŸÇŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ */}
        <div className={styles.notesSection}>
          <textarea
            value={notes}
            onChange={(e) => setNotes(e.target.value)}
            placeholder="ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿßŸÑÿµŸÜŸÅ..."
            className={styles.notesInput}
            rows={3}
          />
        </div>

        {/* ŸÇÿ≥ŸÖ ÿßŸÑÿÆÿµŸÖ */}
        <div className={styles.discountSection}>
          <div className={styles.discountInputs}>
            <div className={styles.discountField}>
              <label>ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿÆÿµŸÖ %</label>
              <input
                ref={percentageInputRef}
                type="number"
                value={tempDiscountPercentage}
                onChange={(e) => setTempDiscountPercentage(e.target.value)}
                onFocus={handlePercentageFocus}
                onBlur={handlePercentageBlur}
                onKeyDown={handlePercentageKeyDown}
                min="0"
                max="100"
                step="0.1"
                className={styles.discountInput}
              />
            </div>
            
            <div className={styles.discountField}>
              <label>ŸÇŸäŸÖÿ© ÿßŸÑÿÆÿµŸÖ</label>
              <input
                ref={amountInputRef}
                type="number"
                value={tempDiscountAmount}
                onChange={(e) => setTempDiscountAmount(e.target.value)}
                onFocus={handleAmountFocus}
                onBlur={handleAmountBlur}
                onKeyDown={handleAmountKeyDown}
                min="0"
                max={baseTotal}
                step="0.01"
                className={styles.discountInput}
              />
            </div>
          </div>
        </div>

        {/* ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ£ŸÉŸäÿØ ŸàÿßŸÑÿ•ŸÑÿ∫ÿßÿ° */}
        <div className={styles.actionButtons}>
          <button className={styles.confirmBtn} onClick={handleConfirm}>
            ÿ™ÿ£ŸÉŸäÿØ
          </button>
          <button className={styles.cancelBtn} onClick={onClose}>
            ÿ•ŸÑÿ∫ÿßÿ°
          </button>
        </div>
      </div>
    </div>
  );
};

export default OrderItemDetailsPopup;

===== src/Pages/pos/newSales/components/OrderManager.tsx =====
// src/Pages/pos/newSales/components/OrderManager.tsx - ÿßŸÑŸÉŸàÿØ ÿßŸÑŸÉÿßŸÖŸÑ ÿßŸÑŸÖŸèÿ≠ÿØÿ´
import React from 'react';
import { PosProduct, PosPrice, SelectedOption, OrderItem, SubItem } from '../types/PosSystem';
import * as posService from '../../../../services/posService';

interface OrderManagerProps {
  keypadValue: string;
  isExtraMode: boolean;
  isWithoutMode: boolean;
  selectedOrderItemId: string | null;
  onOrderAdd: (orderItem: OrderItem) => void;
  onOrderUpdate: (itemId: string, updateType: 'addSubItem' | 'removeSubItem', data: any) => void;
  onModeReset: () => void;
  onLoadNormalProducts: () => void;
}

export const useOrderManager = ({
  keypadValue,
  isExtraMode,
  isWithoutMode,
  selectedOrderItemId,
  onOrderAdd,
  onOrderUpdate,
  onModeReset,
  onLoadNormalProducts
}: OrderManagerProps) => {
  
  const addToOrder = React.useCallback((
    product: PosProduct, 
    price: PosPrice, 
    selectedOptions: SelectedOption[]
  ) => {
  const quantity = parseFloat(keypadValue) || 1; // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ parseFloat ÿ®ÿØŸÑÿßŸã ŸÖŸÜ parseInt
    const basePrice = posService.calculateTotalPrice(price.price, selectedOptions, quantity);
    
    // ÿ•ÿ∞ÿß ŸÉÿßŸÜ Extra ÿ£Ÿà Without mode ŸÖÿπ ŸÖŸÜÿ™ÿ¨ ŸÖÿ≠ÿØÿØ
    if ((isExtraMode || isWithoutMode) && selectedOrderItemId) {
      const subItem: SubItem = {
        id: `${product.id}_${price.id}_${Date.now()}`,
        type: isExtraMode ? 'extra' : 'without',
        name: `${product.nameArabic}${price.nameArabic ? ` - ${price.nameArabic}` : ''}`,
        quantity,
        price: isWithoutMode ? 0 : basePrice,
        productId: product.id
      };
      
      onOrderUpdate(selectedOrderItemId, 'addSubItem', subItem);
    } else {
      // ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ ÿ¨ÿØŸäÿØ (ÿ≥Ÿàÿßÿ° ÿπÿßÿØŸä ÿ£Ÿà Extra/Without ŸÖŸÜŸÅÿµŸÑ)
      const subItems: SubItem[] = [];
      
      // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿ•ŸÑŸâ sub-items
      selectedOptions.forEach(option => {
        subItems.push({
          id: `option_${option.itemId}_${Date.now()}`,
          type: 'option',
          name: option.itemName,
          quantity: option.quantity,
          price: option.extraPrice * option.quantity,
          isRequired: true,
          groupId: option.groupId
        });
      });
      
      const orderItem: OrderItem = {
        id: `${product.id}_${price.id}_${Date.now()}`,
        product,
        selectedPrice: price,
        quantity,
        totalPrice: basePrice,
        subItems: subItems.length > 0 ? subItems : undefined,
        // ÿ•ÿ∂ÿßŸÅÿ© ŸÉŸÖŸÜÿ™ÿ¨ Extra/Without ŸÖŸÜŸÅÿµŸÑ ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸáŸÜÿßŸÉ ŸÖŸÜÿ™ÿ¨ ŸÖÿ≠ÿØÿØ
        isExtra: isExtraMode && !selectedOrderItemId,
        isWithout: isWithoutMode && !selectedOrderItemId,
      };

      onOrderAdd(orderItem);
    }
    
    onModeReset();
    onLoadNormalProducts();
  }, [
    keypadValue, 
    isExtraMode, 
    isWithoutMode, 
    selectedOrderItemId, 
    onOrderAdd,
    onOrderUpdate,
    onModeReset, 
    onLoadNormalProducts
  ]);

  const removeSubItem = React.useCallback((orderItemId: string, subItemId: string) => {
    onOrderUpdate(orderItemId, 'removeSubItem', subItemId);
  }, [onOrderUpdate]);

  return { addToOrder, removeSubItem };
};

===== src/Pages/pos/newSales/components/OrderSummary.tsx =====
// src/Pages/pos/newSales/components/OrderSummary.tsx - ÿ™ÿµÿ≠Ÿäÿ≠ ŸÖÿ¥ŸÉŸÑÿ© ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÄ dropdown
import React, { useState, useEffect, useRef, useCallback } from 'react';
import { OrderSummary as OrderSummaryType, OrderItem, SubItem } from '../types/PosSystem';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import * as customersApi from 'src/utils/api/pagesApi/customersApi';
import * as deliveryZonesApi from 'src/utils/api/pagesApi/deliveryZonesApi';
import CustomerDetailsPopup from './CustomerDetailsPopup';
import CustomerForm from '../../customers/components/CustomerForm';
import styles from '../styles/OrderSummary.module.css';
import PaymentPopup from './PaymentPopup';
import { useInvoiceManager } from '../hooks/useInvoiceManager';

interface OrderSummaryProps {
  orderSummary: OrderSummaryType;
  customerName: string;
  onCustomerNameChange: (name: string) => void;
  onRemoveOrderItem: (itemId: string) => void;
  onRemoveSubItem: (orderItemId: string, subItemId: string) => void;
  selectedOrderItemId: string | null;
  onOrderItemSelect: (itemId: string) => void;
  onOrderItemDoubleClick?: (item: OrderItem) => void;
  selectedCustomer: Customer | null;
  selectedAddress: CustomerAddress | null;
  onCustomerSelect: (customer: Customer, address: CustomerAddress) => void;
  orderType: string;
  onDeliveryChargeChange: (charge: number) => void;
  readOnly: boolean;
  onOrderCompleted?: (result: any) => void;
  selectedTable?: any;
  selectedDeliveryCompany?: any;
  // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÄ props ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© ŸÑŸàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
  isEditMode?: boolean;
  currentInvoiceId?: string | null;
}

export enum InvoiceStatus {
  SENT = 1,
  PRINTED = 2,
  PAID = 3
}

const OrderSummary: React.FC<OrderSummaryProps> = ({
  orderSummary,
  customerName,
  onCustomerNameChange,
  onRemoveOrderItem,
  onRemoveSubItem,
  selectedOrderItemId,
  onOrderItemSelect,
  onOrderItemDoubleClick,
  selectedCustomer,
  selectedAddress,
  onCustomerSelect,
  onOrderCompleted,
  orderType,
  onDeliveryChargeChange,
  readOnly = false,
  selectedTable,
  selectedDeliveryCompany,
  // ÿßÿ≥ÿ™ŸÇÿ®ÿßŸÑ ÿßŸÑŸÄ props ÿßŸÑÿ¨ÿØŸäÿØÿ© ŸÖÿπ ŸÇŸäŸÖ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
  isEditMode = false,
  currentInvoiceId = null
}) => {
  const [selectedSubItemId, setSelectedSubItemId] = useState<string | null>(null);
  const [phoneInput, setPhoneInput] = useState('');
  const [searchResults, setSearchResults] = useState<Customer[]>([]);
  const [showDropdown, setShowDropdown] = useState(false);
  const [isSearching, setIsSearching] = useState(false);
  const [showCustomerForm, setShowCustomerForm] = useState(false);
  const [showCustomerDetails, setShowCustomerDetails] = useState(false);
  const [selectedCustomerForDetails, setSelectedCustomerForDetails] = useState<Customer | null>(null);
  const [deliveryCharge, setDeliveryCharge] = useState(0);
  const [zones, setZones] = useState<any[]>([]);
  const [selectedResultIndex, setSelectedResultIndex] = useState(-1);
  const [searchCache, setSearchCache] = useState<{[key: string]: Customer[]}>({});
  const [inputHasFocus, setInputHasFocus] = useState(false);
  const [showPaymentPopup, setShowPaymentPopup] = useState(false);
  const [pendingEnterAction, setPendingEnterAction] = useState<string | null>(null);
const { saveInvoice, isSubmitting } = useInvoiceManager();

  // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ useRef ÿ®ÿØŸÑÿßŸã ŸÖŸÜ state ŸÑŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©
  const searchDebounceTimer = useRef<NodeJS.Timeout | null>(null);
  const searchAbortController = useRef<AbortController | null>(null);
  const lastSearchQuery = useRef<string>('');
  const inputRef = useRef<HTMLInputElement>(null);
  const dropdownRef = useRef<HTMLDivElement>(null);
const [selectedActionType, setSelectedActionType] = useState<'send' | 'print' | 'pay'>('pay');

  // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿπŸÜÿØ ÿ®ÿØÿ° ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ
  useEffect(() => {
    const loadZones = async () => {
      try {
        const zonesData = await deliveryZonesApi.getAll();
        setZones(zonesData);
      } catch (error) {
        console.error('Error loading zones:', error);
      }
    };
    
    loadZones();
  }, []);




  // ÿ≠ÿ≥ÿßÿ® ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ™ŸàÿµŸäŸÑ ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿπŸÜŸàÿßŸÜ ÿ£Ÿà ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®
  useEffect(() => {
    if (orderType === 'Delivery' && selectedAddress && selectedAddress.zoneId) {
      const zone = zones.find(z => z.id === selectedAddress.zoneId);
      const charge = zone ? zone.deliveryCharge : 0;
      setDeliveryCharge(charge);
      onDeliveryChargeChange(charge);
    } else {
      setDeliveryCharge(0);
      onDeliveryChargeChange(0);
    }
  }, [orderType, selectedAddress, zones, onDeliveryChargeChange]);

  // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑŸÖÿµÿ≠ÿ≠ÿ©
  const searchCustomers = useCallback(async (query: string): Promise<Customer[]> => {
    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑŸÉÿßÿ¥
    if (searchCache[query]) {
      return searchCache[query];
    }

    // ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑÿ≥ÿßÿ®ŸÇ
    if (searchAbortController.current) {
      searchAbortController.current.abort();
    }

    const newController = new AbortController();
    searchAbortController.current = newController;

    try {
      const results = await customersApi.searchByPhone(query);
      
      // ÿ≠ŸÅÿ∏ ŸÅŸä ÿßŸÑŸÉÿßÿ¥
      setSearchCache(prev => ({
        ...prev,
        [query]: results
      }));
      
      return results;
    } catch (error: any) {
      if (error.name === 'AbortError') {
        throw error;
      }
      console.error('Error searching customers:', error);
      throw error;
    }
  }, [searchCache]);

  // useEffect ŸÑŸÑÿ®ÿ≠ÿ´ ŸÖÿπ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿπÿ±ÿ∂ ÿßŸÑŸÄ dropdown
  useEffect(() => {
    // ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑŸÖÿ§ŸÇÿ™ ÿßŸÑÿ≥ÿßÿ®ŸÇ
    if (searchDebounceTimer.current) {
      clearTimeout(searchDebounceTimer.current);
    }

    const query = phoneInput.trim();
    
    // ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ŸÅÿßÿ∂Ÿäÿå ÿßŸÖÿ≥ÿ≠ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸàŸÑŸÉŸÜ ŸÑÿß ÿ™ŸèÿÆŸÅŸä ÿßŸÑŸÄ dropdown ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÄ input ŸÑŸá focus
    if (!query) {
      setSearchResults([]);
      if (!inputHasFocus) {
        setShowDropdown(false);
      }
      setSelectedResultIndex(-1);
      setIsSearching(false);
      return;
    }

    // ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ÿ£ŸÇŸÑ ŸÖŸÜ 3 ÿ£ÿ≠ÿ±ŸÅÿå ŸÖÿß ÿ™ÿ®ÿ≠ÿ´ÿ¥ ŸàŸÑŸÉŸÜ ÿ£ÿ∏Ÿáÿ± ÿ±ÿ≥ÿßŸÑÿ©
    if (query.length < 3) {
      setSearchResults([]);
      setSelectedResultIndex(-1);
      // ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÄ dropdown ŸÖÿπ ÿ±ÿ≥ÿßŸÑÿ© "ÿßŸÉÿ™ÿ® 3 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ" ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÄ input ŸÑŸá focus
      if (inputHasFocus) {
        setShowDropdown(true);
      }
      return;
    }

    // ÿ•ÿ∞ÿß ŸáŸà ŸÜŸÅÿ≥ ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑÿ≥ÿßÿ®ŸÇ ŸàÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÖŸàÿ¨ŸàÿØÿ©ÿå ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÅŸÇÿ∑
    if (query === lastSearchQuery.current && searchResults.length >= 0) {
      if (inputHasFocus) {
        setShowDropdown(true);
      }
      return;
    }

    // ÿ®ÿØÿ° ÿßŸÑÿ®ÿ≠ÿ´ ŸÖÿπ ÿ™ÿ£ÿÆŸäÿ±
    const performSearch = async () => {
      // ÿßŸÑÿ™ÿ£ŸÉÿØ ÿ•ŸÜ ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá (ŸÖÿ¥ ÿßÿ™ÿ∫Ÿäÿ± ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ÿ£ÿÆŸäÿ±)
      if (phoneInput.trim() !== query) {
        return;
      }

      setIsSearching(true);
      lastSearchQuery.current = query;
      
      try {
        const results = await searchCustomers(query);
        
        // ÿßŸÑÿ™ÿ£ŸÉÿØ ÿ•ŸÜ ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá ÿ®ÿπÿØ ÿßŸÑÿ®ÿ≠ÿ´
        if (phoneInput.trim() === query) {
          setSearchResults(results);
          // ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÄ dropdown ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÄ input ŸÑŸá focus ÿ£Ÿà ŸÉÿßŸÜ ŸÖŸÅÿ™Ÿàÿ≠ ŸÖŸÜ ŸÇÿ®ŸÑ
          if (inputHasFocus || showDropdown) {
            setShowDropdown(true);
          }
          setSelectedResultIndex(-1);
        }
      } catch (error: any) {
        if (error.name !== 'AbortError') {
          console.error('Search failed:', error);
          // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÅÿßÿ±ÿ∫ÿ© ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá ŸàÿßŸÑŸÄ input ŸÑŸá focus
          if (phoneInput.trim() === query && inputHasFocus) {
            setSearchResults([]);
            setShowDropdown(true);
          }
        }
      } finally {
        // ÿ•ŸäŸÇÿßŸÅ ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá
        if (phoneInput.trim() === query) {
          setIsSearching(false);
        }
      }
    };

    // ÿ™ÿ£ÿÆŸäÿ± ÿßŸÑÿ®ÿ≠ÿ´ 500ms
    searchDebounceTimer.current = setTimeout(performSearch, 500);

    // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÖÿ§ŸÇÿ™ ÿπŸÜÿØ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±
    return () => {
      if (searchDebounceTimer.current) {
        clearTimeout(searchDebounceTimer.current);
      }
    };
  }, [phoneInput, searchCustomers, inputHasFocus, showDropdown, searchResults.length]);

  // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÄ dropdown ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿÆÿßÿ±ÿ¨Ÿá
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {
        setShowDropdown(false);
        setSelectedResultIndex(-1);
        setInputHasFocus(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  // ÿ™ŸÜÿ∏ŸäŸÅ ÿπŸÜÿØ ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑŸÖŸÉŸàŸÜ
  useEffect(() => {
    return () => {
      if (searchAbortController.current) {
        searchAbortController.current.abort();
      }
      if (searchDebounceTimer.current) {
        clearTimeout(searchDebounceTimer.current);
      }
    };
  }, []);

  const handleInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {
    const value = e.target.value;
    setPhoneInput(value);
    onCustomerNameChange(value);
    
    // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÜÿµ
    setSelectedResultIndex(-1);
    
    // ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÄ dropdown ÿπŸÜÿØ ÿßŸÑŸÉÿ™ÿßÿ®ÿ©
    if (value.trim().length > 0) {
      setShowDropdown(true);
    }
  }, [onCustomerNameChange]);

  // ŸÖÿπÿßŸÑÿ¨ Focus ŸÑŸÑŸÄ input
  const handleInputFocus = useCallback(() => {
    setInputHasFocus(true);
    // ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÄ dropdown ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ŸÜÿµ ÿ£Ÿà ŸÜÿ™ÿßÿ¶ÿ¨
    if (phoneInput.trim().length > 0 || searchResults.length > 0) {
      setShowDropdown(true);
    }
  }, [phoneInput, searchResults.length]);

  const canOpenPayment = orderSummary.items.length > 0;


const handleActionButtonClick = useCallback(async (actionType: 'send' | 'print' | 'pay') => {
  if (!canOpenPayment) return;
  
  if (actionType === 'pay') {
    // ŸÅŸÇÿ∑ Pay ŸäŸÅÿ™ÿ≠ payment popup
    setSelectedActionType(actionType);
    setShowPaymentPopup(true);
  } else {
    // Send Ÿà Print Ÿäÿ≠ŸÅÿ∏Ÿàÿß ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ®ÿØŸàŸÜ popup
    await handleDirectSave(actionType);
  }
}, [canOpenPayment]);




  // ŸÖÿπÿßŸÑÿ¨ Blur ŸÑŸÑŸÄ input
  const handleInputBlur = useCallback(() => {
    // ÿ™ÿ£ÿÆŸäÿ± ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÄ dropdown ŸÑŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÑŸÜŸÇÿ± ÿπŸÑŸâ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
    setTimeout(() => {
      setInputHasFocus(false);
    }, 200);
  }, []);

  const handleCustomerSelect = useCallback((customer: Customer) => {
    setSelectedCustomerForDetails(customer);
    setShowCustomerDetails(true);
    setShowDropdown(false);
    setSelectedResultIndex(-1);
    setInputHasFocus(false);
  }, []);


const handleKeyDown = useCallback(async (e: React.KeyboardEvent<HTMLInputElement>) => {
  if (showDropdown && searchResults.length > 0) {
    switch (e.key) {
      case 'ArrowDown':
        e.preventDefault();
        setSelectedResultIndex(prev => 
          prev < searchResults.length - 1 ? prev + 1 : prev
        );
        break;
      case 'ArrowUp':
        e.preventDefault();
        setSelectedResultIndex(prev => prev > 0 ? prev - 1 : -1);
        break;
      case 'Enter':
        e.preventDefault();
        
        // ÿßÿÆÿ™Ÿäÿßÿ± ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ÿπŸÜÿµÿ± ŸÖÿ≠ÿØÿØ ÿ®ÿßŸÑÿ£ÿ≥ŸáŸÖ
        if (selectedResultIndex >= 0 && selectedResultIndex < searchResults.length) {
          handleCustomerSelect(searchResults[selectedResultIndex]);
        } else {
          // ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ŸÖÿ∑ÿßÿ®ŸÇÿ© ÿ™ÿßŸÖÿ© ŸÑŸÑÿ±ŸÇŸÖ ÿßŸÑŸÉÿßŸÖŸÑ
          const query = phoneInput.trim();
          const exactMatch = searchResults.find(customer => 
            customer.phone1 === query || 
            customer.phone2 === query ||
            customer.phone3 === query ||
            customer.phone4 === query
          );
          
          if (exactMatch) {
            handleCustomerSelect(exactMatch);
          } else if (!isSearching) {
            // ŸÖŸÅŸäÿ¥ ŸÖÿ∑ÿßÿ®ŸÇÿ© ÿ™ÿßŸÖÿ© ŸàÿßŸÜÿ™ŸáŸâ ÿßŸÑÿ®ÿ≠ÿ´ÿå ÿßŸÅÿ™ÿ≠ dialog ÿßŸÑÿ•ÿ∂ÿßŸÅÿ©
            setShowCustomerForm(true);
            setShowDropdown(false);
          }
        }
        break;
      case 'Escape':
        setShowDropdown(false);
        setSelectedResultIndex(-1);
        inputRef.current?.blur();
        break;
    }
  } else if (e.key === 'Enter') {
    e.preventDefault();
    
    const query = phoneInput.trim();
    if (query.length >= 3) {
      // ÿ•ÿ∞ÿß ÿßŸÑÿ®ÿ≠ÿ´ ŸÑÿ≥Ÿá ÿ¥ÿ∫ÿßŸÑÿå ÿßÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ÿßŸÑŸÖÿ∑ŸÑŸàÿ® ŸàÿßŸÜÿ™ÿ∏ÿ±
      if (isSearching) {
        setPendingEnterAction(query);
        return;
      }

      // ÿ•ÿ∞ÿß ÿßŸÑÿ®ÿ≠ÿ´ ÿÆŸÑÿµÿå ÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿßŸÑÿ∑ŸÑÿ®
      await handleEnterAction(query);
    }
  }
}, [showDropdown, searchResults, selectedResultIndex, phoneInput, isSearching, searchCustomers, handleCustomerSelect]);

// ÿ£ÿ∂ŸÅ ÿØÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ Enter:
const handleEnterAction = useCallback(async (query: string) => {
  try {
    setIsSearching(true);
    const results = await searchCustomers(query);
    
    if (results.length > 0) {
      // ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ŸÖÿ∑ÿßÿ®ŸÇÿ© ÿ™ÿßŸÖÿ© ŸÑŸÑÿ±ŸÇŸÖ ÿßŸÑŸÉÿßŸÖŸÑ
      const exactMatch = results.find(customer => 
        customer.phone1 === query || 
        customer.phone2 === query ||
        customer.phone3 === query ||
        customer.phone4 === query
      );
      
      setSearchResults(results);
      setShowDropdown(true);
      setSelectedResultIndex(-1);
      
      if (exactMatch) {
        // ÿ•ÿ∞ÿß Ÿàÿ¨ÿØÿ™ ŸÖÿ∑ÿßÿ®ŸÇÿ© ÿ™ÿßŸÖÿ©ÿå ÿßÿÆÿ™ÿßÿ±Ÿáÿß ŸÖÿ®ÿßÿ¥ÿ±ÿ©
        handleCustomerSelect(exactMatch);
      } else {
        // ÿ•ÿ∞ÿß ŸÖŸÅŸäÿ¥ ŸÖÿ∑ÿßÿ®ŸÇÿ© ÿ™ÿßŸÖÿ©ÿå ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÅŸÇÿ∑
        // ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸäÿÆÿ™ÿßÿ± ÿ®ŸÜŸÅÿ≥Ÿá ÿ£Ÿà Ÿäÿ∂ŸäŸÅ ÿπŸÖŸäŸÑ ÿ¨ÿØŸäÿØ ŸÖŸÜ ÿßŸÑÿ≤ÿ±
      }
    } else {
      // ŸÖŸÅŸäÿ¥ ŸÜÿ™ÿßÿ¶ÿ¨ÿå ÿßŸÅÿ™ÿ≠ ÿπŸÖŸäŸÑ ÿ¨ÿØŸäÿØ
      setShowCustomerForm(true);
    }
  } catch (error) {
    console.error('Search failed:', error);
    setShowCustomerForm(true);
  } finally {
    setIsSearching(false);
  }
}, [searchCustomers, handleCustomerSelect]);

// ÿ£ÿ∂ŸÅ useEffect ŸÑŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑŸÖÿπŸÑŸÇÿ©:
useEffect(() => {
  // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ÿ•ÿ¨ÿ±ÿßÿ° ŸÖÿπŸÑŸÇ ŸàÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÜÿ™ŸáŸâ
  if (pendingEnterAction && !isSearching) {
    const query = pendingEnterAction;
    setPendingEnterAction(null);
    
    // ÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ÿßŸÑŸÖÿπŸÑŸÇ
    handleEnterAction(query);
  }
}, [isSearching, pendingEnterAction, handleEnterAction]);

// ÿπÿØŸÑ useEffect ÿßŸÑÿÆÿßÿµ ÿ®ÿßŸÑÿ®ÿ≠ÿ´ ŸÑŸäŸÖŸÜÿπ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ®ÿ≠ÿ´:
useEffect(() => {
  // ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑŸÖÿ§ŸÇÿ™ ÿßŸÑÿ≥ÿßÿ®ŸÇ
  if (searchDebounceTimer.current) {
    clearTimeout(searchDebounceTimer.current);
  }

  const query = phoneInput.trim();
  
  // ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ŸÅÿßÿ∂Ÿäÿå ÿßŸÖÿ≥ÿ≠ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸàŸÑŸÉŸÜ ŸÑÿß ÿ™ŸèÿÆŸÅŸä ÿßŸÑŸÄ dropdown ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÄ input ŸÑŸá focus
  if (!query) {
    setSearchResults([]);
    if (!inputHasFocus) {
      setShowDropdown(false);
    }
    setSelectedResultIndex(-1);
    setIsSearching(false);
    // ÿ•ŸÑÿ∫ÿßÿ° ÿ£Ÿä ÿ•ÿ¨ÿ±ÿßÿ° ŸÖÿπŸÑŸÇ
    setPendingEnterAction(null);
    return;
  }

  // ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ÿ£ŸÇŸÑ ŸÖŸÜ 3 ÿ£ÿ≠ÿ±ŸÅÿå ŸÖÿß ÿ™ÿ®ÿ≠ÿ´ÿ¥ ŸàŸÑŸÉŸÜ ÿ£ÿ∏Ÿáÿ± ÿ±ÿ≥ÿßŸÑÿ©
  if (query.length < 3) {
    setSearchResults([]);
    setSelectedResultIndex(-1);
    setPendingEnterAction(null);
    // ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÄ dropdown ŸÖÿπ ÿ±ÿ≥ÿßŸÑÿ© "ÿßŸÉÿ™ÿ® 3 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ" ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÄ input ŸÑŸá focus
    if (inputHasFocus) {
      setShowDropdown(true);
    }
    return;
  }

  // ÿ•ÿ∞ÿß ŸáŸà ŸÜŸÅÿ≥ ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑÿ≥ÿßÿ®ŸÇ ŸàÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÖŸàÿ¨ŸàÿØÿ©ÿå ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÅŸÇÿ∑
  if (query === lastSearchQuery.current && searchResults.length >= 0) {
    if (inputHasFocus) {
      setShowDropdown(true);
    }
    return;
  }

  // ÿ®ÿØÿ° ÿßŸÑÿ®ÿ≠ÿ´ ŸÖÿπ ÿ™ÿ£ÿÆŸäÿ±
  const performSearch = async () => {
    // ÿßŸÑÿ™ÿ£ŸÉÿØ ÿ•ŸÜ ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá (ŸÖÿ¥ ÿßÿ™ÿ∫Ÿäÿ± ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ÿ£ÿÆŸäÿ±)
    if (phoneInput.trim() !== query) {
      return;
    }

    setIsSearching(true);
    lastSearchQuery.current = query;
    
    try {
      const results = await searchCustomers(query);
      
      // ÿßŸÑÿ™ÿ£ŸÉÿØ ÿ•ŸÜ ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá ÿ®ÿπÿØ ÿßŸÑÿ®ÿ≠ÿ´
      if (phoneInput.trim() === query) {
        setSearchResults(results);
        // ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÄ dropdown ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÄ input ŸÑŸá focus ÿ£Ÿà ŸÉÿßŸÜ ŸÖŸÅÿ™Ÿàÿ≠ ŸÖŸÜ ŸÇÿ®ŸÑ
        if (inputHasFocus || showDropdown) {
          setShowDropdown(true);
        }
        setSelectedResultIndex(-1);
      }
    } catch (error: any) {
      if (error.name !== 'AbortError') {
        console.error('Search failed:', error);
        // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÅÿßÿ±ÿ∫ÿ© ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá ŸàÿßŸÑŸÄ input ŸÑŸá focus
        if (phoneInput.trim() === query && inputHasFocus) {
          setSearchResults([]);
          setShowDropdown(true);
        }
      }
    } finally {
      // ÿ•ŸäŸÇÿßŸÅ ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ÿßŸÑŸÜÿµ ŸÑÿ≥Ÿá ŸÜŸÅÿ≥Ÿá
      if (phoneInput.trim() === query) {
        setIsSearching(false);
      }
    }
  };

  // ÿ™ÿ£ÿÆŸäÿ± ÿßŸÑÿ®ÿ≠ÿ´ 500ms
  searchDebounceTimer.current = setTimeout(performSearch, 500);

  // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÖÿ§ŸÇÿ™ ÿπŸÜÿØ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±
  return () => {
    if (searchDebounceTimer.current) {
      clearTimeout(searchDebounceTimer.current);
    }
  };
}, [phoneInput, searchCustomers, inputHasFocus, showDropdown, searchResults.length]);
  const handleCustomerDetailsSelect = useCallback((customer: Customer, address: CustomerAddress) => {
    onCustomerSelect(customer, address);
    
    // ÿ•ŸÅÿ±ÿßÿ∫ ÿ≠ŸÇŸÑ ÿßŸÑÿ®ÿ≠ÿ´
    setPhoneInput('');
    setShowCustomerDetails(false);
    
    // ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÄ dropdown
    setShowDropdown(false);
    setSearchResults([]);
    setSelectedResultIndex(-1);
    setInputHasFocus(false);
  }, [onCustomerSelect]);

  const handleAddCustomerClick = useCallback(() => {
    setShowCustomerForm(true);
    setShowDropdown(false);
    setSelectedResultIndex(-1);
    setInputHasFocus(false);
  }, []);

  const handleCustomerFormSubmit = useCallback(async (data: any) => {
    try {
      const newCustomer = await customersApi.add(data);
      if (newCustomer.addresses.length > 0) {
        onCustomerSelect(newCustomer, newCustomer.addresses[0]);
        // ÿ•ŸÅÿ±ÿßÿ∫ ÿ≠ŸÇŸÑ ÿßŸÑÿ®ÿ≠ÿ´
        setPhoneInput('');
      }
      setShowCustomerForm(false);
      
      // ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÄ dropdown
      setShowDropdown(false);
      setSearchResults([]);
      setSelectedResultIndex(-1);
      setInputHasFocus(false);
    } catch (error) {
      console.error('Error creating customer:', error);
    }
  }, [onCustomerSelect]);

  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ÿ•ÿ∫ŸÑÿßŸÇ ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿπŸÖŸäŸÑ
  const handleCustomerFormClose = useCallback(() => {
    setShowCustomerForm(false);
  }, []);

  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ÿ•ÿ∫ŸÑÿßŸÇ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿπŸÖŸäŸÑ
  const handleCustomerDetailsClose = useCallback(() => {
    setShowCustomerDetails(false);
  }, []);

  useEffect(() => {
    if (selectedCustomer) {
      // ÿ•ŸÅÿ±ÿßÿ∫ ÿ≠ŸÇŸÑ ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜÿØ ÿßÿÆÿ™Ÿäÿßÿ± ÿπŸÖŸäŸÑ ŸÅŸÇÿ∑
      setPhoneInput('');
      setShowDropdown(false);
      setSearchResults([]);
      setSelectedResultIndex(-1);
      setInputHasFocus(false);
    }
  }, [selectedCustomer]);

  // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä
  const subtotalWithDelivery = orderSummary.subtotal + deliveryCharge;
  const taxAmount = 0;
  const finalTotal = subtotalWithDelivery + taxAmount - orderSummary.discount;


  // ÿØÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ± ŸÑŸÄ Send Ÿà Print
// ÿØÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ± ŸÑŸÄ Send Ÿà Print
const handleDirectSave = useCallback(async (actionType: 'send' | 'print') => {
  try {
    console.log(`ÿ®ÿØÿ° ŸÖÿπÿßŸÑÿ¨ÿ© ${actionType}...`);
    console.log('ŸÖÿ≠ÿ™ŸàŸâ orderSummary.items:', orderSummary.items);
    
    // ‚úÖ ÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ¨ŸàÿØ items ŸÇÿ®ŸÑ ÿßŸÑŸÖÿ™ÿßÿ®ÿπÿ©
    if (!orderSummary.items || orderSummary.items.length === 0) {
      console.error('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿπŸÜÿßÿµÿ± ŸÅŸä ÿßŸÑÿ∑ŸÑÿ®');
      return;
    }
    
    // ‚úÖ ÿ•ŸÜÿ¥ÿßÿ° ÿØŸÅÿπÿ© ŸÉÿßÿ¥ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ÿ®ŸÇŸäŸÖÿ© 0 (ŸÅŸÇÿ∑ ŸÑÿ™ÿ¨ÿßŸàÿ≤ validation ŸÑŸà ŸÉÿßŸÜ ŸÖÿ∑ŸÑŸàÿ®)
    const defaultPayments: { method: string; amount: number; isSelected: boolean }[] = [
      {
        method: 'cash',
        amount: 0,
        isSelected: true
      }
    ];
    
    // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿ≠ÿßŸÑÿ©
    const invoiceStatus = actionType === 'send' ? 1 : 2;
    
    console.log(`ÿ•ÿ±ÿ≥ÿßŸÑ ${orderSummary.items.length} ÿπŸÜÿµÿ± ŸÑŸÑÿ™ÿ≠ÿØŸäÿ´...`);
    
    // ‚úÖ ÿ≠ŸÅÿ∏ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÖÿπ ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ÿ±ÿ≥ÿßŸÑ orderSummary ŸÉÿßŸÖŸÑÿßŸã
    const result = await saveInvoice(
      orderSummary, // ‚úÖ Ÿáÿ∞ÿß Ÿäÿ≠ÿ™ŸàŸä ÿπŸÑŸâ items
      orderType,
      defaultPayments,
      invoiceStatus,
      {
        isEditMode,
        invoiceId: currentInvoiceId,
        selectedCustomer,
        selectedAddress,
        selectedDeliveryCompany,
        selectedTable,
        servicePercentage: 0,
        taxPercentage: 0,
        discountPercentage: 0,
        notes: customerName
      }
    );
    
    const actionName = actionType === 'send' ? 'ÿ•ÿ±ÿ≥ÿßŸÑ' : 'ÿ∑ÿ®ÿßÿπÿ©';
    console.log(`ÿ™ŸÖ ${actionName} ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${result.invoiceNumber}`);
    
    // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÜÿ∏ÿßŸÖ
    if (onOrderCompleted) {
      onOrderCompleted({
        success: true,
        invoice: result,
        actionType: actionType
      });
    }
    
  } catch (error) {
    console.error(`ÿÆÿ∑ÿ£ ŸÅŸä ${actionType}:`, error);
  }
}, [saveInvoice, orderSummary, orderType, isEditMode, currentInvoiceId, 
    selectedCustomer, selectedAddress, selectedDeliveryCompany, selectedTable, 
    customerName, onOrderCompleted]);





  // ÿØŸàÿßŸÑ ÿßŸÑÿπÿ±ÿ∂
  const renderSubItem = (subItem: SubItem, orderItemId: string) => {
    const canDelete = subItem.type === 'extra' || subItem.type === 'without';
    const isSelected = selectedSubItemId === subItem.id && canDelete;
    
    
    return (
      <div 
        key={subItem.id} 
        className={`${styles.subItem} ${isSelected ? styles.selectedSubItem : ''}`}
        onClick={(e) => {
          e.stopPropagation();
          
          if (canDelete) {
            const rect = e.currentTarget.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            
            if (isSelected && clickX <= 30) {
              onRemoveSubItem(orderItemId, subItem.id);
              setSelectedSubItemId(null);
            } else {
              setSelectedSubItemId(isSelected ? null : subItem.id);
            }
          }
        }}
        style={{
          cursor: canDelete ? 'pointer' : 'default'
        }}
      >
        <div className={styles.subItemDetails}>
          <div className={styles.subItemInfo}>
            {!isSelected && (
              <span className={`${styles.subItemBadge} ${styles[subItem.type]}`}>
                {subItem.type === 'extra' && '+'}
                {subItem.type === 'without' && '-'}
                {subItem.type === 'option' && '‚Ä¢'}
              </span>
            )}
            <div className={styles.subItemName}>
              {subItem.quantity} X {subItem.name}
            </div>
          </div>
        </div>
        
        <div className={styles.subItemPrices}>
          <div className={styles.subItemPrice}>
            {subItem.type === 'without' ? '0' : (subItem.price / subItem.quantity).toFixed(2)}
          </div>
          <div className={`${styles.subItemTotal} ${subItem.price < 0 ? styles.negative : ''}`}>
            {subItem.type === 'without' ? '0' : subItem.price.toFixed(2)}
          </div>
        </div>
      </div>
    );
  };

  const renderOptions = (options: any[]) => {
    return options.map((option: any, index: number) => (
      <div key={index} className={styles.optionDetail}>
        <span className={styles.optionText}>
          {option.quantity} X {option.itemName}
        </span>
        <div className={styles.optionPrices}>
          <div className={styles.optionPrice}>
            {option.extraPrice > 0 ? `+${option.extraPrice}` : '0'}
          </div>
          <div className={styles.optionTotal}>
            {(option.extraPrice * option.quantity).toFixed(2)}
          </div>
        </div>
      </div>
    ));
  };

  const renderNotes = (notes: string) => {
    if (!notes || notes.trim() === '') return null;
    
    return (
      <div className={styles.commentsContainer}>
        <div className={styles.commentItem}>
          <span className={styles.commentIcon}>üí¨</span>
          <span className={styles.commentText}>{notes}</span>
        </div>
      </div>
    );
  };

  // ÿ™ÿ≠ÿØŸäÿØ ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÄ dropdown
  const renderDropdownContent = () => {
    const query = phoneInput.trim();
    
    if (isSearching) {
      return (
        <div className={styles.searchingMessage}>
          <div className={styles.loadingSpinner}></div>
          <span>ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ®ÿ≠ÿ´...</span>
        </div>
      );
    }
    
    if (query.length < 3) {
      return (
        <div className={styles.minLengthMessage}>
          <span>ÿßŸÉÿ™ÿ® 3 ÿ£ÿ±ŸÇÿßŸÖ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ ŸÑŸÑÿ®ÿ≠ÿ´</span>
        </div>
      );
    }
    
    if (searchResults.length > 0) {
      return (
        <>
          <div className={styles.dropdownHeader}>
            <span>ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´ ({searchResults.length})</span>
          </div>
          {searchResults.map((customer, index) => (
            <div
              key={customer.id}
              className={`${styles.customerOption} ${
                index === selectedResultIndex ? styles.selectedOption : ''
              }`}
              onClick={() => handleCustomerSelect(customer)}
            >
              <div className={styles.customerInfo}>
                <div className={styles.customerName}>{customer.name}</div>
                <div className={styles.customerPhone}>
                  {customer.phone1}
                  {customer.phone2 && ` - ${customer.phone2}`}
                </div>
                <div className={styles.customerDetails}>
                  {customer.addresses.length} ÿπŸÜŸàÿßŸÜ
                  {customer.isVIP && ' ‚Ä¢ VIP'}
                  {customer.isBlocked && ' ‚Ä¢ ŸÖÿ≠ÿ∏Ÿàÿ±'}
                </div>
              </div>
            </div>
          ))}
        </>
      );
    }
    
    return (
      <div className={styles.noResults}>
        <span>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨ ŸÑŸáÿ∞ÿß ÿßŸÑÿ±ŸÇŸÖ</span>
        <button 
          className={styles.addNewCustomerBtn}
          onClick={handleAddCustomerClick}
          disabled={isSearching}
        >
          ÿ•ÿ∂ÿßŸÅÿ© ÿπŸÖŸäŸÑ ÿ¨ÿØŸäÿØ
        </button>
      </div>
    );
  };

  const shouldShowAllButtons = orderType !== 'Takeaway';
  const shouldShowPayOnly = orderType === 'Takeaway';

  return (
    <aside className={styles.orderSummary}>
      <div className={styles.orderHeader}>
        <div className={styles.orderNumber}>
          {isEditMode && currentInvoiceId ? 
            `#${currentInvoiceId.substring(0, 8)}...` : 
            '#123'
          }
        </div>
        <div className={styles.orderTotal}>
          <span className={styles.amount}>{finalTotal.toFixed(2)}</span>
          <span className={styles.currency}>EGP</span>
        </div>
      </div>

      <div className={styles.orderContent}>
        {/* Customer Search Input with Enhanced Dropdown */}
        <div className={styles.customerInputContainer} ref={dropdownRef}>
          <div className={styles.customerInput}>
            <input
              ref={inputRef}
              type="text"
              placeholder="Customer Phone Number - ÿ±ŸÇŸÖ Ÿáÿßÿ™ŸÅ ÿßŸÑÿπŸÖŸäŸÑ"
              value={phoneInput}
              onChange={handleInputChange}
              onFocus={handleInputFocus}
              onBlur={handleInputBlur}
              onKeyDown={handleKeyDown}
              className={styles.customerField}
            />
            <button 
              className={styles.customerButton}
              onClick={handleAddCustomerClick}
              disabled={isSearching}
            >
              <img src="/images/img_group_1000004320.svg" alt="Add customer" />
            </button>
          </div>

          {/* Search Results Dropdown */}
          {showDropdown && (
            <div className={styles.customerDropdown}>
              {renderDropdownContent()}
            </div>
          )}
        </div>

        {/* Order Items */}
        <div className={styles.orderItems}>
          {orderSummary.items.map((item) => (
            <div key={item.id} className={styles.orderItemContainer}>
              <div 
                className={`${styles.orderItem} ${selectedOrderItemId === item.id ? styles.selected : ''} ${item.isExtra ? styles.extraItem : ''} ${item.isWithout ? styles.withoutItem : ''}`}
                onClick={(e) => {
                  const rect = e.currentTarget.getBoundingClientRect();
                  const clickX = e.clientX - rect.left;
                  
                  if (selectedOrderItemId === item.id && clickX <= 30) {
                    onRemoveOrderItem(item.id);
                  } else {
                    onOrderItemSelect(item.id);
                  }
                }}
                onDoubleClick={() => onOrderItemDoubleClick?.(item)}
              >
                <div className={styles.itemDetails}>
                  <div className={styles.itemInfo}>
                    <div className={styles.itemName}>
                      {item.isExtra && <span className={styles.extraBadge}>+</span>}
                      {item.isWithout && <span className={styles.withoutBadge}>-</span>}
                      {item.quantity} X {item.product.nameArabic}
                      {item.product.hasMultiplePrices && (
                        <span className={styles.itemSizeInline}> - {item.selectedPrice.nameArabic}</span>
                      )}
                    </div>
                  </div>
                </div>
                
                <div className={styles.itemPrices}>
                  <div className={styles.itemPrice}>{item.selectedPrice.price}</div>
                  <div className={`${styles.itemTotal} ${item.isWithout ? styles.negative : ''}`}>
                    {item.totalPrice}
                  </div>
                </div>
              </div>
              
              {item.notes && renderNotes(item.notes)}
              
              {item.subItems && item.subItems.length > 0 && (
                <div className={styles.subItemsContainer}>
                  {item.subItems.map(subItem => renderSubItem(subItem, item.id))}
                </div>
              )}
              
              {item.selectedOptions && item.selectedOptions.length > 0 && !item.subItems && (
                <div className={styles.itemOptions}>
                  {renderOptions(item.selectedOptions)}
                </div>
              )}
            </div>
          ))}
        </div>
      </div>

      <div className={styles.orderFooter}>
        <div className={styles.summaryRows}>
          <div className={styles.summaryRow}>
            <span>Sub Total</span>
            <span>{orderSummary.subtotal.toFixed(2)} <small>EGP</small></span>
          </div>
          
          {deliveryCharge > 0 && (
            <div className={styles.summaryRow}>
              <span>Delivery</span>
              <span>{deliveryCharge.toFixed(2)} <small>EGP</small></span>
            </div>
          )}
          
          <div className={styles.summaryRow}>
            <span>Discount</span>
            <span>{orderSummary.discount.toFixed(2)} <small>EGP</small></span>
          </div>
          
          <div className={styles.summaryRow}>
            <span>Tax</span>
            <span>{taxAmount.toFixed(2)} <small>EGP</small></span>
          </div>
          
          <div className={styles.summaryRow}>
            <span>Service</span>
            <span>{orderSummary.service.toFixed(2)} <small>EGP</small></span>
          </div>
        </div>

        <div className={styles.totalRow}>
          <span>Total</span>
          <span>{finalTotal.toFixed(2)} <small>EGP</small></span>
        </div>

        {!readOnly && (
          <div className={`${styles.actionButtons} ${shouldShowPayOnly ? styles.takeawayButtons : ''}`}>
            {shouldShowAllButtons && (
              <>
<button 
  className={`${styles.actionButton} ${styles.send}`}
  onClick={() => handleActionButtonClick('send')}
  disabled={!canOpenPayment || isSubmitting}
>
  <img src="/images/img_tabler_send.svg" alt="Send" />
  <span>{isSubmitting ? 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ...' : 'Send'}</span>
</button>
<button 
  className={`${styles.actionButton} ${styles.print}`}
  onClick={() => handleActionButtonClick('print')}
  disabled={!canOpenPayment || isSubmitting}
>
  <img src="/images/img_printer.svg" alt="Print" />
  <span>{isSubmitting ? 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ∑ÿ®ÿßÿπÿ©...' : 'Print'}</span>
</button>
              </>
            )}
<button
  onClick={() => handleActionButtonClick('pay')}
  disabled={!canOpenPayment}
  className={`${styles.actionButton} ${styles.pay} ${shouldShowPayOnly ? styles.fullWidth : ''} ${!canOpenPayment ? styles.disabledBtn : ''}`}
>
  <img src="/images/img_payment_02.svg" alt="Pay" />
  <span>{isEditMode ? 'ÿ™ÿ≠ÿØŸäÿ´' : 'Pay'}</span>
</button>
          </div>
        )}
      </div>

      {/* Customer Details Popup */}
      <CustomerDetailsPopup
        open={showCustomerDetails}
        customer={selectedCustomerForDetails}
        onClose={handleCustomerDetailsClose}
        onSelectCustomer={handleCustomerDetailsSelect}
      />

      {/* Payment Popup ŸÖÿπ ÿßŸÑŸÄ props ÿßŸÑŸÖÿµÿ≠ÿ≠ÿ© */}
      <PaymentPopup
        isOpen={showPaymentPopup}
        onClose={() => setShowPaymentPopup(false)}
        orderSummary={orderSummary}
        customerName={customerName}
        onCustomerNameChange={onCustomerNameChange}
        onRemoveOrderItem={onRemoveOrderItem}
        onRemoveSubItem={onRemoveSubItem}
        selectedOrderItemId={selectedOrderItemId}
        onOrderItemSelect={onOrderItemSelect}
        onOrderItemDoubleClick={onOrderItemDoubleClick}
        selectedCustomer={selectedCustomer}
        selectedAddress={selectedAddress}
        onCustomerSelect={onCustomerSelect}
        orderType={orderType}
        onDeliveryChargeChange={onDeliveryChargeChange}
        selectedTable={selectedTable}
        actionType={selectedActionType} // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
        selectedDeliveryCompany={selectedDeliveryCompany}
        isEditMode={isEditMode} // ‚úÖ ÿ™ŸÖÿ±Ÿäÿ± ÿµÿ≠Ÿäÿ≠
        currentInvoiceId={currentInvoiceId} // ‚úÖ ÿ™ŸÖÿ±Ÿäÿ± ÿµÿ≠Ÿäÿ≠
        onPaymentComplete={(result) => {
          if (result.success) {
            console.log('ÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠:', result.invoice);
            console.log('ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸÅÿπ:', result.payments);
            
            setShowPaymentPopup(false);
            
            // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ•ÿ¥ÿßÿ±ÿ© ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸÑÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿπŸäŸäŸÜ
            if (onOrderCompleted) {
              onOrderCompleted(result);
            }
          }
        }}
      />

      {/* Customer Form Popup */}
      {showCustomerForm && (
        <CustomerForm
          key={phoneInput}
          open={showCustomerForm}
          mode="add"
          onClose={handleCustomerFormClose}
          onSubmit={handleCustomerFormSubmit}
          initialValues={{
            id: '',
            name: '',
            phone1: phoneInput.trim(),
            phone2: '',
            phone3: '',
            phone4: '',
            isVIP: false,
            isBlocked: false,
            isActive: true,
            addresses: []
          }}
        />
      )}
    </aside>
  );
};

export default OrderSummary;

===== src/Pages/pos/newSales/components/paymentPopup components/PaymentCenter.tsx =====
// src/Pages/pos/newSales/components/paymentPopup components/PaymentCenter.tsx
import React from 'react';
import styles from './styles/PaymentCenter.module.css';

interface PaymentCenterProps {
  totalAmount: number;
  paidAmount: string;
  cashAmount: number;
  remainingForCustomer: number;
  selectedPaymentMethod: string | null;
  onAmountChange: (amount: string) => void;
  onQuickAmountSelect: (amount: number) => void;
  isFirstInput: boolean;
  nonCashTotal: number;
}

const PaymentCenter: React.FC<PaymentCenterProps> = ({
  totalAmount,
  paidAmount,
  cashAmount,
  remainingForCustomer,
  selectedPaymentMethod,
  onAmountChange,
  onQuickAmountSelect,
  isFirstInput,
  nonCashTotal
}) => {
  // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ© ŸáŸä ÿßŸÑŸÉÿßÿ¥
  const isCashSelected = selectedPaymentMethod?.toLowerCase().includes('ŸÉÿßÿ¥') || 
                        selectedPaymentMethod?.toLowerCase().includes('cash');

  const handleKeypadClick = (value: string) => {
    if (value === 'c') {
      onAmountChange('0');
    } else if (value === 'erase') {
      const newValue = paidAmount.slice(0, -1);
      onAmountChange(newValue || '0');
    } else if (value === '.') {
      if (paidAmount === '0' || paidAmount === '0.00' || !paidAmount.includes('.')) {
        onAmountChange(paidAmount === '0' || paidAmount === '0.00' ? '0.' : paidAmount + '.');
      }
    } else {
      // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ£ŸàŸÑÿå ÿßÿ®ÿØÿ£ ŸÖŸÜ ÿßŸÑÿµŸÅÿ±
      if (isFirstInput || paidAmount === '0' || paidAmount === '0.00') {
        onAmountChange(value);
      } else {
        onAmountChange(paidAmount + value);
      }
    }
  };

  // ÿ™ÿπÿØŸäŸÑ ÿØÿßŸÑÿ© ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© ŸÑŸÑÿ¨ŸÖÿπ
  const handleQuickAmountClick = (amount: number) => {
    const currentAmount = parseFloat(paidAmount) || 0;
    
    // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ£ŸàŸÑ (ŸÇŸäŸÖÿ© ÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©)ÿå ÿßÿ®ÿØÿ£ ŸÖŸÜ ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ∂ÿßŸÅÿ© ŸÅŸÇÿ∑
    if (isFirstInput) {
      onQuickAmountSelect(amount);
    } else {
      // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖŸèÿØÿÆŸÑ ŸäÿØŸàŸäÿßŸãÿå ÿßÿ¨ŸÖÿπ ÿπŸÑŸâ ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
      const newAmount = currentAmount + amount;
      onQuickAmountSelect(newAmount);
    }
  };

  return (
    <div className={styles.wrapper}>
      <div className={styles.headerRow}>
        <h2 className={styles.balanceTitle}>
          ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: {totalAmount.toFixed(2)} ÿ¨ŸÜŸäŸá
        </h2>
      </div>

      <div className={styles.fieldsRow}>
        <div className={styles.fieldBlock}>
          <label className={styles.label}>ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä (ŸÉÿßÿ¥)</label>
          <div className={styles.remainingBox}>
            {remainingForCustomer.toFixed(2)}
          </div>
        </div>

        <div className={styles.fieldBlock}>
          <label className={styles.label}>ÿßŸÑŸÖÿØŸÅŸàÿπ ŸÉÿßÿ¥</label>
          <div className={styles.cashPaidBox}>
            {cashAmount.toFixed(2)}
          </div>
        </div>
      </div>

      <div className={styles.quickButtons}>
        {[5, 10, 15, 20].map(val => (
          <button 
            key={val} 
            className={`${styles.quickBtn} ${!selectedPaymentMethod ? styles.disabled : ''}`}
            onClick={() => handleQuickAmountClick(val)}
            disabled={!selectedPaymentMethod}
          >
            {val} EGP
          </button>
        ))}
      </div>

      <div className={styles.keypad}>
        {[
          ['1','2','3','50'],
          ['4','5','6','100'],
          ['7','8','9','200'],
          ['c','0','.','erase']
        ].map((row, rowIndex) => (
          <div key={rowIndex} className={styles.keypadRow}>
            {row.map(key => (
              <button
                key={key}
                className={`${styles.keypadBtn} ${['50','100','200'].includes(key) ? styles.gray : ''} ${!selectedPaymentMethod ? styles.disabled : ''}`}
                onClick={() => selectedPaymentMethod && (
                  key === 'erase' ? handleKeypadClick('erase') : 
                  ['50','100','200'].includes(key) ? handleQuickAmountClick(parseInt(key)) : 
                  handleKeypadClick(key)
                )}
                disabled={!selectedPaymentMethod}
              >
                {key === 'erase' ? '√ó' : 
                 key === 'c' ? 'C' : 
                 ['50','100','200'].includes(key) ? `${key} EGP` : key}
              </button>
            ))}
          </div>
        ))}
      </div>

      {!selectedPaymentMethod && (
        <div className={styles.noSelectionMessage}>
          ÿßÿÆÿ™ÿ± ÿ∑ÿ±ŸäŸÇÿ© ÿØŸÅÿπ ŸÖŸÜ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸäŸÖŸäŸÜ ŸÑÿ®ÿØÿ° ÿßŸÑÿ•ÿØÿÆÿßŸÑ
        </div>
      )}
    </div>
  );
};

export default PaymentCenter;

===== src/Pages/pos/newSales/components/paymentPopup components/PaymentLeft.tsx =====
// src/Pages/pos/newSales/components/paymentPopup components/PaymentLeft.tsx
import React from 'react';
import PaymentOrderSummary from './PaymentOrderSummary';
import styles from './styles/PaymentLeft.module.css';

interface PaymentLeftProps {
  orderSummary: any;
  selectedCustomer: any;
  selectedAddress: any;
  orderType: string;
  deliveryCharge: number;
}

const PaymentLeft: React.FC<PaymentLeftProps> = ({
  orderSummary,
  selectedCustomer,
  selectedAddress,
  orderType,
  deliveryCharge,
}) => {
  return (
    <div className={styles.container}>
        <PaymentOrderSummary 
          orderSummary={orderSummary}
          selectedCustomer={selectedCustomer}
          selectedAddress={selectedAddress}
          orderType={orderType}
          deliveryCharge={deliveryCharge} onGoBack={function (): void {
            throw new Error('Function not implemented.');
          } }        />
    </div>
  );
};

export default PaymentLeft;

===== src/Pages/pos/newSales/components/paymentPopup components/PaymentOrderSummary.tsx =====
// src/Pages/pos/newSales/components/paymentPopup components/PaymentOrderSummary.tsx
import React from 'react';
import { OrderSummary as OrderSummaryType, SubItem } from '../../types/PosSystem';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import styles from './styles/PaymentOrderSummary.module.css';

interface PaymentOrderSummaryProps {
  orderSummary: OrderSummaryType;
  selectedCustomer: Customer | null;
  selectedAddress: CustomerAddress | null;
  orderType: string;
  deliveryCharge: number;
    onGoBack: () => void;

}

const PaymentOrderSummary: React.FC<PaymentOrderSummaryProps> = ({
  orderSummary,
  selectedCustomer,
  selectedAddress,
  deliveryCharge}) => {
  // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä
  const subtotalWithDelivery = orderSummary.subtotal + deliveryCharge;
  const taxAmount = 0;
  const finalTotal = subtotalWithDelivery + taxAmount - orderSummary.discount;

  // ÿØÿßŸÑÿ© ÿπÿ±ÿ∂ SubItem
  const renderSubItem = (subItem: SubItem) => {
    return (
      <div key={subItem.id} className={styles.subItem}>
        <div className={styles.subItemDetails}>
          <div className={styles.subItemInfo}>
            <span className={`${styles.subItemBadge} ${styles[subItem.type]}`}>
              {subItem.type === 'extra' && '+'}
              {subItem.type === 'without' && '-'}
              {subItem.type === 'option' && '‚Ä¢'}
            </span>
            <div className={styles.subItemName}>
              {subItem.quantity} X {subItem.name}
            </div>
          </div>
        </div>
        
        <div className={styles.subItemPrices}>
          <div className={styles.subItemPrice}>
            {subItem.type === 'without' ? '0' : (subItem.price / subItem.quantity).toFixed(2)}
          </div>
          <div className={`${styles.subItemTotal} ${subItem.price < 0 ? styles.negative : ''}`}>
            {subItem.type === 'without' ? '0' : subItem.price.toFixed(2)}
          </div>
        </div>
      </div>
    );
  };

  // ÿØÿßŸÑÿ© ÿπÿ±ÿ∂ Options
  const renderOptions = (options: any[]) => {
    return options.map((option: any, index: number) => (
      <div key={index} className={styles.optionDetail}>
        <span className={styles.optionText}>
          {option.quantity} X {option.itemName}
        </span>
        <div className={styles.optionPrices}>
          <div className={styles.optionPrice}>
            {option.extraPrice > 0 ? `+${option.extraPrice}` : '0'}
          </div>
          <div className={styles.optionTotal}>
            {(option.extraPrice * option.quantity).toFixed(2)}
          </div>
        </div>
      </div>
    ));
  };

  // ÿØÿßŸÑÿ© ÿπÿ±ÿ∂ Notes
  const renderNotes = (notes: string) => {
    if (!notes || notes.trim() === '') return null;
    
    return (
      <div className={styles.commentsContainer}>
        <div className={styles.commentItem}>
          <span className={styles.commentIcon}>üí¨</span>
          <span className={styles.commentText}>{notes}</span>
        </div>
      </div>
    );
  };

  return (
    <div className={styles.orderSummary}>
      {/* Header */}
      <div className={styles.orderHeader}>
        <div className={styles.orderNumber}>#123</div>
        <div className={styles.orderTotal}>
          <span className={styles.amount}>{finalTotal.toFixed(2)}</span>
          <span className={styles.currency}>EGP</span>
        </div>
      </div>

      {/* Content */}
      <div className={styles.orderContent}>
        {/* Customer Info */}
        {selectedCustomer && (
          <div className={styles.customerInfo}>
            <div className={styles.customerName}>
              üë§ {selectedCustomer.name}
              {selectedCustomer.isVIP && <span className={styles.vipBadge}>VIP</span>}
            </div>
            <div className={styles.customerPhone}>
              üìû {selectedCustomer.phone1}
            </div>
            {selectedAddress && selectedAddress.addressLine && (
              <div className={styles.customerAddress}>
                üìç {selectedAddress.addressLine}
                {selectedAddress.zoneName && ` - ${selectedAddress.zoneName}`}
              </div>
            )}
          </div>
        )}

        {/* Order Items */}
        <div className={styles.orderItems}>
          {orderSummary.items.map((item) => (
            <div key={item.id} className={styles.orderItemContainer}>
              <div className={`${styles.orderItem} ${item.isExtra ? styles.extraItem : ''} ${item.isWithout ? styles.withoutItem : ''}`}>
                <div className={styles.itemDetails}>
                  <div className={styles.itemInfo}>
                    <div className={styles.itemName}>
                      {item.isExtra && <span className={styles.extraBadge}>+</span>}
                      {item.isWithout && <span className={styles.withoutBadge}>-</span>}
                      {item.quantity} X {item.product.nameArabic}
                      {item.product.hasMultiplePrices && (
                        <span className={styles.itemSizeInline}> - {item.selectedPrice.nameArabic}</span>
                      )}
                    </div>
                  </div>
                </div>
                
                <div className={styles.itemPrices}>
                  <div className={styles.itemPrice}>{item.selectedPrice.price}</div>
                  <div className={`${styles.itemTotal} ${item.isWithout ? styles.negative : ''}`}>
                    {item.totalPrice.toFixed(2)}
                  </div>
                </div>
              </div>
              
              {item.notes && renderNotes(item.notes)}
              
              {item.subItems && item.subItems.length > 0 && (
                <div className={styles.subItemsContainer}>
                  {item.subItems.map(subItem => renderSubItem(subItem))}
                </div>
              )}
              
              {item.selectedOptions && item.selectedOptions.length > 0 && !item.subItems && (
                <div className={styles.itemOptions}>
                  {renderOptions(item.selectedOptions)}
                </div>
              )}
            </div>
          ))}
        </div>
      </div>

      {/* Footer */}
      <div className={styles.orderFooter}>
        <div className={styles.summaryRows}>
          <div className={styles.summaryRow}>
            <span>Sub Total</span>
            <span>{orderSummary.subtotal.toFixed(2)} <small>EGP</small></span>
          </div>
          
          {deliveryCharge > 0 && (
            <div className={styles.summaryRow}>
              <span>Delivery</span>
              <span>{deliveryCharge.toFixed(2)} <small>EGP</small></span>
            </div>
          )}
          
          <div className={styles.summaryRow}>
            <span>Discount</span>
            <span>{orderSummary.discount.toFixed(2)} <small>EGP</small></span>
          </div>
          
          <div className={styles.summaryRow}>
            <span>Tax</span>
            <span>{taxAmount.toFixed(2)} <small>EGP</small></span>
          </div>
          
          <div className={styles.summaryRow}>
            <span>Service</span>
            <span>{orderSummary.service.toFixed(2)} <small>EGP</small></span>
          </div>
        </div>

        <div className={styles.totalRow}>
          <span>Total</span>
          <span>{finalTotal.toFixed(2)} <small>EGP</small></span>
        </div>

              {/* <div className={styles.backButtonContainer}>
        <button className={styles.backButton} onClick={onGoBack}>
          ÿ±ÿ¨Ÿàÿπ
        </button>
      </div> */}
      </div>
    </div>
  );
};

export default PaymentOrderSummary;

===== src/Pages/pos/newSales/components/paymentPopup components/PaymentRight.tsx =====
import React from 'react';
import styles from './styles/PaymentRight.module.css';

interface PaymentMethodData {
  method: string;
  amount: number;
  isSelected: boolean;
}

interface PaymentRightProps {
  availablePaymentMethods: string[];
  selectedPayments: PaymentMethodData[];
  selectedPaymentMethod: string | null;
  onPaymentMethodSelect: (method: string) => void;
  onPaymentMethodToggle: (method: string) => void;
  onFinishPayment: () => void;
  canFinish: boolean;
  totalPaidAllMethods: number;
  totalAmount: number;
  nonCashTotal: number;
  onShowWarning?: (message: string) => void;
  // ÿ•ÿ∂ÿßŸÅÿ© prop ÿ¨ÿØŸäÿØ ŸÑÿØÿπŸÖ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
  isEditMode?: boolean;
  isSubmitting?: boolean; // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
}

const PaymentRight: React.FC<PaymentRightProps> = ({
  availablePaymentMethods = [],
  selectedPayments,
  selectedPaymentMethod,
  onPaymentMethodSelect,
  onPaymentMethodToggle,
  onFinishPayment,
  canFinish,
  totalAmount,
  nonCashTotal,
  onShowWarning,
  isEditMode = false, // ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© false
  isSubmitting = false // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
}) => {
  const getPaymentData = (methodName: string) => {
    return selectedPayments.find(payment => payment.method === methodName);
  };

  // ÿØÿßŸÑÿ© ŸÑÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÅÿπŸÑŸä ÿßŸÑŸÖÿ≥ÿßŸáŸÖ ŸÅŸä ÿßŸÑÿ£Ÿàÿ±ÿØÿ± ŸÑŸÉŸÑ ÿ∑ÿ±ŸäŸÇÿ© ÿØŸÅÿπ
  const getActualContributionAmount = (method: string, amount: number) => {
    const isCash = method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                   method.toLowerCase().includes('cash');
    
    if (!isCash) {
      // ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿ∫Ÿäÿ± ÿßŸÑŸÉÿßÿ¥: ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÅÿπŸÑŸä ŸÅŸÇÿ∑
      return Math.min(amount, totalAmount);
    } else {
      // ŸÑŸÑŸÉÿßÿ¥: ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ≥ÿßŸáŸÖÿ© ÿßŸÑŸÅÿπŸÑŸäÿ© ŸÅŸä ÿßŸÑÿ£Ÿàÿ±ÿØÿ± ŸÅŸÇÿ∑
      const actualCashContribution = Math.max(0, totalAmount - nonCashTotal);
      return Math.min(amount, actualCashContribution);
    }
  };

  // ÿØÿßŸÑÿ© ÿßŸÑŸÜŸÇÿ± ÿπŸÑŸâ ÿßŸÑŸÉÿßÿ±ÿØ ŸÖÿπ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ
  const handleCardClick = (method: string) => {
    const paymentData = getPaymentData(method);
    const isCurrentlyActive = paymentData?.isSelected || false;
    const isCash = method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                   method.toLowerCase().includes('cash');
    
    if (!isCurrentlyActive && !isCash) {
      // ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿπÿØÿØ ÿßŸÑÿ∑ÿ±ŸÇ ÿßŸÑŸÜÿ¥ÿ∑ÿ© ÿ∫Ÿäÿ± ÿßŸÑŸÜŸÇÿØŸäÿ©
      const activeNonCashCount = selectedPayments.filter(p => {
        const isNonCash = !(p.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                           p.method.toLowerCase().includes('cash'));
        return isNonCash && p.isSelected && p.amount > 0;
      }).length;
      
      if (activeNonCashCount >= 2) {
        onShowWarning?.('ŸÑÿß ŸäŸÖŸÉŸÜ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ£ŸÉÿ´ÿ± ŸÖŸÜ Ÿàÿ≥ŸäŸÑÿ™Ÿä ÿØŸÅÿπ ÿ∫Ÿäÿ± ŸÜŸÇÿØŸäÿ©');
        return;
      }
    }
    
    if (!isCurrentlyActive) {
      onPaymentMethodToggle(method);
      onPaymentMethodSelect(method);
    } else {
      onPaymentMethodSelect(method);
    }
  };

  // ÿØÿßŸÑÿ© ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÄ checkbox
  const handleCheckboxChange = (method: string, event: React.ChangeEvent<HTMLInputElement>) => {
    event.stopPropagation();
    
    const isCash = method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                   method.toLowerCase().includes('cash');
    const paymentData = getPaymentData(method);
    const isCurrentlyActive = paymentData?.isSelected || false;
    
    if (!isCurrentlyActive && !isCash) {
      // ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿπÿØÿØ ÿßŸÑÿ∑ÿ±ŸÇ ÿßŸÑŸÜÿ¥ÿ∑ÿ© ÿ∫Ÿäÿ± ÿßŸÑŸÜŸÇÿØŸäÿ©
      const activeNonCashCount = selectedPayments.filter(p => {
        const isNonCash = !(p.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                           p.method.toLowerCase().includes('cash'));
        return isNonCash && p.isSelected && p.amount > 0;
      }).length;
      
      if (activeNonCashCount >= 2) {
        onShowWarning?.('ŸÑÿß ŸäŸÖŸÉŸÜ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ£ŸÉÿ´ÿ± ŸÖŸÜ Ÿàÿ≥ŸäŸÑÿ™Ÿä ÿØŸÅÿπ ÿ∫Ÿäÿ± ŸÜŸÇÿØŸäÿ©');
        return;
      }
    }
    
    onPaymentMethodToggle(method);
    
    const willBeSelected = !isCurrentlyActive;
    
    if (!willBeSelected && selectedPaymentMethod === method) {
      const otherActiveMethod = selectedPayments.find(p => 
        p.method !== method && p.isSelected && p.amount > 0
      );
      if (otherActiveMethod) {
        onPaymentMethodSelect(otherActiveMethod.method);
      } else {
        const cashMethod = selectedPayments.find(p => 
          (p.method.toLowerCase().includes('ŸÉÿßÿ¥') || p.method.toLowerCase().includes('cash')) && 
          p.method !== method &&
          p.isSelected
        );
        if (cashMethod) {
          onPaymentMethodSelect(cashMethod.method);
        }
      }
    }
  };

  const isLongName = (name: string) => name.length > 15;

  // ÿ™ÿ≠ÿØŸäÿØ ŸÜÿµ ÿßŸÑÿ≤ÿ± ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
  const getButtonText = () => {
    if (isEditMode) {
      return 'ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ∑ŸÑÿ®';
    }
    return 'ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿØŸÅÿπ';
  };

  // ÿ™ÿ≠ÿØŸäÿØ ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÇÿ≥ŸÖ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
  const getSectionTitle = () => {
    if (isEditMode) {
      return 'ÿ™ÿπÿØŸäŸÑ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ';
    }
    return 'ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©';
  };

  if (availablePaymentMethods.length === 0) {
    return (
      <div className={styles.container}>
        <div style={{ 
          display: 'flex', 
          justifyContent: 'center', 
          alignItems: 'center', 
          height: '100%',
          fontFamily: 'Cairo, sans-serif',
          color: '#666'
        }}>
          ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ...
        </div>
      </div>
    );
  }

  return (
    <div className={styles.container}>
      {/* ÿ•ÿ∂ÿßŸÅÿ© ÿπŸÜŸàÿßŸÜ ŸÑŸÑŸÇÿ≥ŸÖ */}
      {isEditMode && (
        <div className={styles.sectionHeader}>
          <h3 className={styles.sectionTitle}>
            {getSectionTitle()}
          </h3>
        </div>
      )}
      
<button 
  className={`${styles.finishBtn} ${!canFinish || isSubmitting ? styles.disabled : ''} ${isEditMode ? styles.editMode : ''}`}
  onClick={onFinishPayment}
  disabled={!canFinish || isSubmitting}
  title={isEditMode ? 'ÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸÖÿπ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑÿ¨ÿØŸäÿØÿ©' : 'ÿ•ŸÜŸáÿßÿ° ÿπŸÖŸÑŸäÿ© ÿßŸÑÿØŸÅÿπ'}
>
  {isSubmitting ? (
    <>
      <span className={styles.loadingSpinner}></span>
      {isEditMode ? 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ÿØŸäÿ´...' : 'ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...'}
    </>
  ) : (
    <>
      {getButtonText()}
      {isEditMode && (
        <span className={styles.editIcon}>
          ‚úèÔ∏è
        </span>
      )}
    </>
  )}
</button>
      
      <div className={styles.methodsList}>
        {availablePaymentMethods.map((method) => {
          const paymentData = getPaymentData(method);
          const amount = paymentData?.amount || 0;
          const isActive = paymentData?.isSelected || false;
          const isSelectedForEdit = selectedPaymentMethod === method;
          const longName = isLongName(method);
          
          // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÅÿπŸÑŸä ÿßŸÑŸÖÿ≥ÿßŸáŸÖ ŸÅŸä ÿßŸÑÿ£Ÿàÿ±ÿØÿ±
          const actualContribution = getActualContributionAmount(method, amount);
          const hasAmount = actualContribution > 0;
          
          return (
            <div 
              key={method} 
              className={`${styles.methodItem} ${isActive ? styles.active : ''} ${isSelectedForEdit ? styles.selectedForEdit : ''} ${hasAmount ? styles.hasAmount : ''} ${longName ? styles.longName : ''} ${isEditMode ? styles.editModeItem : ''}`}
              onClick={() => handleCardClick(method)}
            >
              <div className={styles.methodHeader}>
                <input
                  type="checkbox"
                  checked={isActive}
                  onChange={(e) => handleCheckboxChange(method, e)}
                  className={styles.methodCheckbox}
                />
                <span className={styles.methodName}>{method}</span>
              </div>
              
              {hasAmount && (
                <div className={styles.methodAmount}>
                  {actualContribution.toFixed(2)} ÿ¨ŸÜŸäŸá
                  {isEditMode && (
                    <span className={styles.editLabel}>
                      (ŸÇÿßÿ®ŸÑ ŸÑŸÑÿ™ÿπÿØŸäŸÑ)
                    </span>
                  )}
                </div>
              )}
              
              {isSelectedForEdit && (
                <div className={styles.editIndicator}>
                  {isEditMode ? 'Ÿäÿ™ŸÖ ÿ™ÿπÿØŸäŸÑŸáÿß ÿßŸÑÿ¢ŸÜ' : 'Ÿäÿ™ŸÖ ÿßŸÑÿ™ÿπÿØŸäŸÑ ÿπŸÑŸäŸáÿß ÿßŸÑÿ¢ŸÜ'}
                  {isEditMode && (
                    <span className={styles.editingIcon}>
                      üîÑ
                    </span>
                  )}
                </div>
              )}
            </div>
          );
        })}
      </div>

      <div className={styles.paymentSummary}>
        <div className={styles.summaryRow}>
          <span>
            {isEditMode ? 'ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖÿ≠ÿØÿ´ÿ©:' : 'ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖÿ©:'}
          </span>
          <span className={styles.methodsCount}>
            {selectedPayments.filter(p => p.isSelected && getActualContributionAmount(p.method, p.amount) > 0).length}
          </span>
        </div>
      </div>
    </div>
  );
};

export default PaymentRight;

===== src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentCenter.module.css =====
/* src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentCenter.module.css */

.wrapper {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  padding: 0.8rem;
  box-sizing: border-box;
  font-family: "Cairo", sans-serif;
  overflow: hidden;
  gap: 0.6rem;
}

.headerRow {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
  height: 50px;
}

.balanceTitle {
  font-size: 1.4rem;
  font-weight: 700;
  color: #000;
  direction: rtl;
  text-align: center;
}

.fieldsRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.8rem;
  flex-shrink: 0;
  height: 80px;
}

.fieldBlock {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
  height: 100%;
}

.label {
  font-size: 0.8rem;
  font-weight: 700;
  color: #333;
  direction: rtl;
  text-align: right;
  flex-shrink: 0;
}

.remainingBox, .totalPaidBox {
  padding: 0.6rem;
  font-size: 1.1rem;
  text-align: center;
  border-radius: 8px;
  font-weight: 600;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

.remainingBox {
  background-color: #28a745;
  color: white;
}

.totalPaidBox {
  background-color: #0373ed;
  color: white;
}

.selectedMethodRow {
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
  flex-shrink: 0;
  height: 70px;
}

.selectedMethodLabel {
  font-size: 0.9rem;
  font-weight: 700;
  color: #0373ed;
  direction: rtl;
  text-align: right;
}

.selectedMethodInput {
  padding: 0.6rem;
  font-size: 1.1rem;
  text-align: center;
  border-radius: 8px;
  font-weight: 600;
  border: 2px solid #0373ed;
  background: #f8f9ff;
  flex: 1;
}

.quickButtons {
  display: flex;
  justify-content: space-between;
  gap: 0.6rem;
  flex-shrink: 0;
  height: 45px;
}

.quickBtn {
  flex: 1;
  background-color: #d9d9d9;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s ease;
  height: 100%;
}

.quickBtn:hover:not(:disabled) {
  background-color: #c8c8c8;
}

.quickBtn:disabled {
  background-color: #f0f0f0;
  color: #999;
  cursor: not-allowed;
}

.keypad {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

.keypadRow {
  display: flex;
  justify-content: space-between;
  gap: 0.5rem;
  flex: 1;
  min-height: 0;
}

.keypadBtn {
  flex: 1;
  font-size: 1.5rem;
  font-weight: 700;
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.keypadBtn.gray {
  background-color: #d9d9d9;
}

.keypadBtn:hover:not(.disabled) {
  background-color: #f0f0f0;
}

.keypadBtn:active:not(.disabled) {
  transform: scale(0.96);
}

.keypadBtn.disabled {
  background-color: #f5f5f5;
  color: #999;
  cursor: not-allowed;
  border-color: #e0e0e0;
}

.noSelectionMessage {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1rem;
  background-color: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  color: #666;
  font-size: 0.9rem;
  direction: rtl;
  text-align: center;
  flex-shrink: 0;
}



/* ÿ•ÿ∂ÿßŸÅÿ© ŸÅŸä PaymentCenter.module.css */

.cashPaidBox {
  padding: 0.6rem;
  font-size: 1.1rem;
  text-align: center;
  border-radius: 8px;
  font-weight: 600;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #0373ed;
  color: white;
}

.selectedMethodInfo {
  background: #f8f9fa;
  border: 1px solid #dee2e6;
  border-radius: 8px;
  padding: 0.6rem;
  text-align: center;
  flex-shrink: 0;
  direction: rtl;
}

.selectedMethodName {
  display: block;
  font-size: 0.9rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 0.2rem;
}

.limitWarning {
  display: block;
  font-size: 0.8rem;
  color: #dc3545;
  font-weight: 500;
}

===== src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentLeft.module.css =====
.container {
  width: 100%;
  height: 100%;
  background: white;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #e9ecef;
  display: flex;
  flex-direction: column;
}

/* ŸÇÿßÿπÿØÿ© ÿπÿßŸÖÿ© ŸÑŸÑÿÆÿ∑Ÿàÿ∑ */
:where(.container,
       .container *) { 
  font-size: var(--fs); 
}

.header {
  background: #0373ed;
  color: white;
  padding: clamp(12px, 2vw, 20px);
  text-align: center;
  border-bottom: 2px solid #e9ecef;
}

.title {
  margin: 0;
  font-family: "Cairo-Bold", Helvetica;
  font-weight: 700;
  font-size: calc(var(--fs) * 1.4);
  direction: rtl;
}

.orderSummaryWrapper {
  flex: 1;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  padding: clamp(8px, 1.5vw, 16px);
}

.orderSummaryWrapper::-webkit-scrollbar {
  width: clamp(4px, 0.8vw, 8px);
}

.orderSummaryWrapper::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

.orderSummaryWrapper::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 10px;
}

.orderSummaryWrapper::-webkit-scrollbar-thumb:hover {
  background: #a8a8a8;
}

/* Responsive ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸÖÿÆÿ™ŸÑŸÅÿ© */
@media (max-width: 1600px) {
  .orderSummaryWrapper {
    padding: clamp(6px, 1.2vw, 14px);
  }
}

@media (max-width: 1024px) {
  .container {
    border-radius: 8px;
  }
  
  .orderSummaryWrapper {
    padding: clamp(6px, 1vw, 12px);
  }
}



===== src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentOrderSummary.module.css =====
/* src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentOrderSummary.module.css */
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap');

:root {
  --primary-blue: #0373ed;
  --primary-green: #23a929;
  --primary-red: #e53935;
  --bg-white: #ffffff;
  --text-primary: #000000;
  --text-secondary: rgba(0, 0, 0, 0.7);
  --border-color: rgba(0, 0, 0, 0.2);
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
}

.orderSummary {
  width: 100%;
  height: 100%;
  background: var(--bg-white);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 2px 16px rgba(0, 0, 0, 0.1);
}

/* Header */
.orderHeader {
  height: clamp(50px, 7vh, 80px);
  display: flex;
  flex-shrink: 0;
}

.orderNumber {
  flex: 1;
  background: var(--primary-blue);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(16px, 2vw, 24px);
  font-weight: 700;
  border-radius: 8px 0 0 0;
}

.orderTotal {
  width: clamp(100px, 12vw, 150px);
  border: 2px solid var(--primary-blue);
  color: var(--primary-blue);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  border-radius: 0 8px 0 0;
}

.orderTotal .amount {
  font-size: clamp(16px, 2vw, 24px);
  font-weight: 700;
}

.orderTotal .currency {
  font-size: clamp(10px, 1.2vw, 16px);
  font-weight: 600;
}

/* Content */
.orderContent {
  flex: 1;
  padding: var(--spacing-lg);
  overflow-y: auto;
  scrollbar-width: none;
}

.orderContent::-webkit-scrollbar {
  width: 6px;
}

.orderContent::-webkit-scrollbar-track {
  background: transparent;
}

.orderContent::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

/* Customer Info */
.customerInfo {
  background: #e3f2fd;
  border: 1px solid #bbdefb;
  border-radius: 8px;
  padding: 12px;
  margin-bottom: var(--spacing-lg);
  font-family: 'Cairo', sans-serif;
}

.customerName {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  font-size: 14px;
  color: #1976d2;
  margin-bottom: 4px;
}

.vipBadge {
  background: linear-gradient(135deg, #ffd700 0%, #ffed4a 100%);
  color: #8b4513;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
}

.customerPhone {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #1976d2;
  font-size: 12px;
  margin-bottom: 4px;
}

.customerAddress {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #1976d2;
  font-size: 11px;
}

/* Order Items */
.orderItems {
  max-height: 50vh;
  margin-bottom: var(--spacing-md);
  scrollbar-width: thin;
}

.orderItems::-webkit-scrollbar {
  width: 4px;
}

.orderItems::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

.orderItemContainer {
  margin-bottom: clamp(12px, 1.5vw, 16px);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: clamp(8px, 1vw, 12px);
}

.orderItemContainer:last-child {
  border-bottom: none;
}

.orderItem {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  border-radius: 6px;
  margin-bottom: 0;
}

.orderItem.extraItem {
  border-left: 3px solid #28a745;
}

.orderItem.withoutItem {
  border-left: 3px solid #dc3545;
}

.itemDetails {
  display: flex;
  gap: var(--spacing-sm);
  align-items: flex-start;
  flex: 1;
  min-width: 0;
}

.itemInfo {
  flex: 1;
  min-width: 0;
}

.itemName {
  font-size: clamp(11px, 1.3vw, 16px);
  font-weight: 600;
  margin-bottom: var(--spacing-xs);
  color: var(--text-primary);
  line-height: 1.2;
  font-family: 'Cairo', sans-serif;
}

.itemSizeInline {
  color: var(--primary-blue);
  font-weight: 500;
  font-size: 0.9em;
}

.extraBadge, .withoutBadge {
  color: white;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 10px;
  margin-right: 4px;
  font-weight: 600;
}

.extraBadge {
  background: #28a745;
}

.withoutBadge {
  background: #dc3545;
}

.itemPrices {
  display: flex;
  align-items: center;
  gap: clamp(6px, 1vw, 10px);
  flex-shrink: 0;
  min-width: fit-content;
}

.itemPrice {
  font-size: clamp(10px, 1.2vw, 14px);
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  padding-right: clamp(6px, 1vw, 10px);
  border-right: 1px solid #ccc;
}

.itemTotal {
  font-size: clamp(11px, 1.3vw, 16px);
  font-weight: 700;
  color: var(--primary-blue);
  white-space: nowrap;
  padding-left: clamp(6px, 1vw, 10px);
}

.itemTotal.negative {
  color: #dc3545;
  font-weight: 600;
}

/* Sub Items */
.subItemsContainer {
  margin-top: 0;
  padding-left: 16px;
  border-left: 2px solid #f0f0f0;
}

.subItem {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1px 0;
  margin-bottom: 0px;
  min-height: 18px;
  border-radius: 4px;
}

.subItemDetails {
  display: flex;
  align-items: center;
  gap: 6px;
  flex: 1;
}

.subItemInfo {
  display: flex;
  align-items: center;
  gap: 4px;
  flex: 1;
}

.subItemBadge {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 7px;
  font-weight: 600;
  color: white;
  flex-shrink: 0;
}

.subItemBadge.extra {
  background: #28a745;
}

.subItemBadge.without {
  background: #dc3545;
}

.subItemBadge.option {
  background: #6c757d;
}

.subItemName {
  font-size: 10px;
  color: #666;
  line-height: 1.2;
  font-family: 'Cairo', sans-serif;
}

.subItemPrices {
  display: flex;
  align-items: center;
  gap: clamp(4px, 0.8vw, 8px);
  min-width: fit-content;
}

.subItemPrice {
  font-size: 8px;
  color: #999;
  font-weight: 500;
  white-space: nowrap;
  padding-right: clamp(4px, 0.8vw, 8px);
  border-right: 1px solid #ddd;
}

.subItemTotal {
  font-size: 9px;
  color: #333;
  font-weight: 600;
  white-space: nowrap;
  padding-left: clamp(4px, 0.8vw, 8px);
}

.subItemTotal.negative {
  color: #dc3545;
}

/* Options */
.itemOptions {
  margin-top: 0;
  padding-left: 16px;
}

.optionDetail {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1px;
  padding: 2px 0;
  min-height: 18px;
}

.optionText {
  font-size: 10px;
  color: #666;
  font-weight: 400;
  line-height: 1.2;
  font-family: 'Cairo', sans-serif;
  flex: 1;
}

.optionPrices {
  display: flex;
  align-items: center;
  gap: clamp(4px, 0.8vw, 8px);
  min-width: fit-content;
}

.optionPrice {
  font-size: 8px;
  color: #999;
  font-weight: 500;
  white-space: nowrap;
  padding-right: clamp(4px, 0.8vw, 8px);
  border-right: 1px solid #ddd;
}

.optionTotal {
  font-size: 9px;
  color: #333;
  font-weight: 600;
  white-space: nowrap;
  padding-left: clamp(4px, 0.8vw, 8px);
}

/* Comments */
.commentsContainer {
  margin-top: 0;
  padding-left: 16px;
  border-left: 2px solid #e3f2fd;
}

.commentItem {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  padding: 3px 0;
  margin-bottom: 2px;
  min-height: 20px;
}

.commentIcon {
  font-size: 10px;
  color: #2196f3;
  margin-top: 1px;
  flex-shrink: 0;
}

.commentText {
  font-size: 10px;
  color: #2196f3;
  line-height: 1.3;
  font-family: 'Cairo', sans-serif;
  font-style: italic;
  word-wrap: break-word;
  flex: 1;
}

/* Footer */
.orderFooter {
  padding: var(--spacing-md);
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
}

.summaryRows {
  display: flex;
  flex-direction: column;
  gap: calc(var(--spacing-sm) * 0.8);
  margin-bottom: var(--spacing-md);
}

.summaryRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(10px, 1.2vw, 15px);
  font-weight: 500;
  line-height: 1.3;
}

.summaryRow span:last-child {
  font-weight: 700;
  color: var(--text-primary);
}

.totalRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(13px, 1.5vw, 19px);
  font-weight: 700;
  padding-top: var(--spacing-md);
  border-top: 2px solid var(--border-color);
  margin-bottom: var(--spacing-md);
}

/* Responsive */
@media (max-width: 1024px) {
  .summaryRows {
    gap: calc(var(--spacing-sm) * 0.6);
  }
  
  .orderItems {
    max-height: 42vh;
  }
  
  .itemPrices, .subItemPrices, .optionPrices {
    gap: 4px;
  }
}

@media (max-width: 768px) {
  .subItemName {
    font-size: 9px;
  }
  
  .subItemPrice {
    font-size: 7px;
  }
  
  .subItemTotal {
    font-size: 8px;
  }
  
  .optionText {
    font-size: 9px;
  }
  
  .optionPrice {
    font-size: 7px;
  }
  
  .optionTotal {
    font-size: 8px;
  }
  
  .commentText {
    font-size: 9px;
  }
}



/* ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸÜŸÖÿßÿ∑ ÿ≤ÿ± ÿßŸÑÿ±ÿ¨Ÿàÿπ */
.backButtonContainer {
  padding: clamp(8px, 1.5vw, 16px);
}

.backButton {
  background: var(--primary-blue);
  color: white;
  border: none;
  border-radius: 8px;
  padding: clamp(12px, 2vw, 16px) clamp(24px, 4vw, 32px);
  font-size: clamp(14px, 1.6vw, 18px);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: 'Cairo', sans-serif;
  width: 100%;
  margin: 0 auto;
  display: block;
}

.backButton:hover {
  background: #025bb5;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(3, 115, 237, 0.3);
}

.backButton:active {
  transform: translateY(0);
}

===== src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentRight.module.css =====
/* src/Pages/pos/newSales/components/paymentPopup components/styles/PaymentRight.module.css */

.container {
  width: 100%;
  height: 100%;
  background: white;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #e9ecef;
  display: flex;
  flex-direction: column;
  padding: 0.8rem;
  font-family: "Cairo", sans-serif;
  gap: 0.6rem;
  min-height: 0;
}

.finishBtn {
  width: 100%;
  height: 50px;
  font-size: 1.2rem;
  font-weight: 700;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  direction: rtl;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.finishBtn:hover:not(.disabled) {
  background: #218838;
}

.finishBtn.disabled {
  background: #6c757d;
  cursor: not-allowed;
}

.methodsList {
  flex: 1;
  overflow-y: auto;
  padding-right: 0.2rem;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.6rem;
  align-content: start;
}

.methodItem {
  border: 2px solid #e9ecef;
  border-radius: 8px;
  padding: 0.6rem;
  background: #f8f9fa;
  transition: all 0.3s ease;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  min-height: 60px;
  position: relative;
  user-select: none; /* ŸÖŸÜÿπ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÜÿµ */
}

.methodItem:hover {
  background: #e9ecef;
  border-color: #dee2e6;
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖŸÅÿπŸÑÿ© */
.methodItem.active {
  background: #e8f5e8;
  border-color: #28a745;
}

.methodItem.active:hover {
  background: #d4edda;
  border-color: #1e7e34;
}

/* ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖÿ≠ÿØÿØÿ© ŸÑŸÑÿ™ÿπÿØŸäŸÑ */
.methodItem.selectedForEdit {
  background: #e8f4fd;
  border-color: #0373ed;
  box-shadow: 0 0 0 2px rgba(3, 115, 237, 0.2);
}

.methodItem.selectedForEdit:hover {
  background: #d1ecf1;
}

/* ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÖŸÅÿπŸÑÿ© ŸàÿßŸÑŸÖÿ≠ÿØÿØÿ© ŸÑŸÑÿ™ÿπÿØŸäŸÑ */
.methodItem.active.selectedForEdit {
  background: #d4edda;
  border-color: #0373ed;
  box-shadow: 0 0 0 2px rgba(3, 115, 237, 0.3);
}

/* ÿ∑ÿ±ŸäŸÇÿ© ÿØŸÅÿπ ÿ®Ÿáÿß ŸÖÿ®ŸÑÿ∫ */
.methodItem.hasAmount {
  border-width: 3px;
}

.methodHeader {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  direction: rtl;
  margin-bottom: 0.3rem;
}

.methodCheckbox {
  width: 18px;
  height: 18px;
  cursor: pointer;
  accent-color: #28a745;
  flex-shrink: 0;
}

.methodName {
  font-size: 0.9rem;
  color: #333;
  flex: 1;
  text-align: right;
  line-height: 1.2;
  word-break: break-word;
  font-weight: 600;
}

.methodAmount {
  font-size: 0.8rem;
  color: #28a745;
  font-weight: 700;
  background: rgba(40, 167, 69, 0.15);
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  text-align: center;
  margin-top: 0.2rem;
  border: 1px solid rgba(40, 167, 69, 0.3);
}

.editIndicator {
  font-size: 0.7rem;
  color: #0373ed;
  font-weight: 600;
  background: rgba(3, 115, 237, 0.1);
  padding: 0.1rem 0.3rem;
  border-radius: 3px;
  text-align: center;
  margin-top: 0.2rem;
  border: 1px solid rgba(3, 115, 237, 0.2);
}

.paymentSummary {
  border-top: 1px solid #e9ecef;
  padding-top: 0.6rem;
  flex-shrink: 0;
}

.summaryRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.3rem 0;
  direction: rtl;
  font-size: 0.9rem;
}

.totalPaid {
  color: #28a745;
  font-weight: 700;
  font-size: 1rem;
}

.methodsCount {
  color: #0373ed;
  font-weight: 600;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
@media (max-width: 768px) {
  .methodsList {
    grid-template-columns: 1fr;
  }
  
  .methodName {
    font-size: 0.85rem;
  }
  
  .methodAmount {
    font-size: 0.75rem;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸàÿßÿ≥ÿπÿ© ÿ¨ÿØÿßŸã */
@media (min-width: 1400px) {
  .methodsList {
    grid-template-columns: 1fr 1fr 1fr;
  }
}

/* ÿ£ŸÜŸÖÿßÿ∑ ŸÑŸÑÿ£ÿ≥ŸÖÿßÿ° ÿßŸÑÿ∑ŸàŸäŸÑÿ© */
.methodItem.longName .methodName {
  font-size: 0.8rem;
  line-height: 1.1;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± */
.methodsList {
  scrollbar-width: thin;
  scrollbar-color: #ccc #f1f1f1;
}

.methodsList::-webkit-scrollbar {
  width: 6px;
}

.methodsList::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 3px;
}

.methodsList::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 3px;
}

.methodsList::-webkit-scrollbar-thumb:hover {
  background: #999;
}

===== src/Pages/pos/newSales/components/PaymentPopup.tsx =====
import React, { useState, useEffect, useRef, useCallback } from 'react';
import { OrderSummary as OrderSummaryType } from '../types/PosSystem';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import PaymentLeft from './paymentPopup components/PaymentLeft';
import PaymentCenter from './paymentPopup components/PaymentCenter';
import PaymentRight from './paymentPopup components/PaymentRight';
import styles from '../styles/PaymentPopup.module.css';
import { usePosPaymentMethods } from '../hooks/usePosPaymentMethods';
import { Snackbar, Alert } from '@mui/material';
import { useInvoiceManager } from '../hooks/useInvoiceManager';

interface PaymentMethodData {
  method: string;
  amount: number;
  isSelected: boolean;
  wasModified?: boolean;
}

interface PaymentPopupProps {
  isOpen: boolean;
  onClose: () => void;
  onPaymentComplete: (result: {
    success: boolean;
    invoice?: any;
    payments: PaymentMethodData[];
    error?: string;
  }) => void;
  orderSummary: OrderSummaryType;
  customerName: string;
  onCustomerNameChange: (name: string) => void;
  onRemoveOrderItem: (itemId: string) => void;
  onRemoveSubItem: (orderItemId: string, subItemId: string) => void;
  selectedOrderItemId: string | null;
  onOrderItemSelect: (itemId: string) => void;
  onOrderItemDoubleClick?: (item: any) => void;
  selectedCustomer: Customer | null;
  selectedAddress: CustomerAddress | null;
  onCustomerSelect: (customer: Customer, address: CustomerAddress) => void;
  orderType: string;
  onDeliveryChargeChange: (charge: number) => void;
  selectedTable?: any;
  selectedDeliveryCompany?: any;
  // ÿ•ÿ∂ÿßŸÅÿ© props ÿ¨ÿØŸäÿØÿ© ŸÑÿØÿπŸÖ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
  isEditMode?: boolean;
  currentInvoiceId?: string | null;
  actionType?: 'send' | 'print' | 'pay'; // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©

}

const PaymentPopup: React.FC<PaymentPopupProps> = ({
  isOpen,
  onClose,
  orderSummary,
  customerName,
  onCustomerNameChange,
  onRemoveOrderItem,
  onRemoveSubItem,
  selectedOrderItemId,
  onOrderItemSelect,
  onOrderItemDoubleClick,
  selectedCustomer,
  selectedAddress,
  onCustomerSelect,
  orderType,
  onDeliveryChargeChange,
  onPaymentComplete,
  selectedTable,
  selectedDeliveryCompany,
  isEditMode = false, // ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© false
  currentInvoiceId = null, // ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© null
  actionType = 'pay' // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
}) => {
  const overlayRef = useRef<HTMLDivElement>(null);
  const { paymentMethods, loading, error } = usePosPaymentMethods();
  
  // ÿ•ÿ∂ÿßŸÅÿ© state ŸÑŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ≠ŸÑŸäÿ©
  const [localAlert, setLocalAlert] = useState({
    open: false,
    message: '',
    severity: 'warning' as 'warning' | 'error' | 'success' | 'info'
  });

  const [selectedPayments, setSelectedPayments] = useState<PaymentMethodData[]>([]);
  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState<string | null>(null);
  const [paidAmount, setPaidAmount] = useState('0');
  const [lastNonCashTotal, setLastNonCashTotal] = useState(0);
  const [isFirstInput, setIsFirstInput] = useState(true);
  const { saveInvoice, isSubmitting: isInvoiceSubmitting } = useInvoiceManager();
  const [isSubmitting, setIsSubmitting] = useState(false);

  // ÿØŸàÿßŸÑ ÿπÿ±ÿ∂ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÖÿ≠ŸÑŸäÿ©
  const showLocalSuccess = (message: string) => {
    setLocalAlert({
      open: true,
      message,
      severity: 'success'
    });
  };

  const showLocalWarning = (message: string) => {
    setLocalAlert({
      open: true,
      message,
      severity: 'warning'
    });
  };

  const showLocalError = (message: string) => {
    setLocalAlert({
      open: true,
      message,
      severity: 'error'
    });
  };

  const getInvoiceStatus = (): number => {
  switch (actionType) {
    case 'send': return 1;
    case 'print': return 2;
    case 'pay': return 3;
    default: return 3;
  }
};


const getSuccessMessage = (invoiceNumber: string): string => {
  if (isEditMode) {
    switch (actionType) {
      case 'send': return 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠!';
      case 'print': return 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠!';
      case 'pay': return 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ŸàÿØŸÅÿπ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠!';
      default: return 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠!';
    }
  } else {
    switch (actionType) {
      case 'send': return `ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${invoiceNumber}`;
      case 'print': return `ÿ™ŸÖ ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${invoiceNumber}`;
      case 'pay': return `ÿ™ŸÖ ÿØŸÅÿπ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${invoiceNumber}`;
      default: return `ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${invoiceNumber}`;
    }
  }
};

  // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ÿßŸÑÿ∫
  const deliveryCharge = 0;
  const subtotalWithDelivery = orderSummary.subtotal + deliveryCharge;
  const taxAmount = 0;
  const totalAmount = subtotalWithDelivery + taxAmount - orderSummary.discount;

  // ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ∑ÿ±ŸäŸÇÿ© ÿØŸÅÿπ ÿßŸÑŸÉÿßÿ¥
  const getCashMethod = () => {
    return paymentMethods.find(
      m => m.name.toLowerCase().includes('ŸÉÿßÿ¥') || m.name.toLowerCase().includes('cash')
    );
  };

  // ÿØÿßŸÑÿ© ŸÑÿ≠ÿ≥ÿßÿ® ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÜÿ¥ÿ∑ÿ© ÿ∫Ÿäÿ± ÿßŸÑŸÉÿßÿ¥
  const getActiveNonCashPayments = () => {
    return selectedPayments.filter(payment => {
      const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                     payment.method.toLowerCase().includes('cash');
      return !isCash && payment.isSelected && payment.amount > 0;
    });
  };

  // ÿ≠ÿ≥ÿßÿ® ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿØŸÅŸàÿπ ÿ®ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿ∫Ÿäÿ± ÿßŸÑŸÉÿßÿ¥
  const nonCashTotal = selectedPayments
    .filter(payment => {
      const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                     payment.method.toLowerCase().includes('cash');
      return !isCash && payment.amount > 0;
    })
    .reduce((sum, payment) => sum + payment.amount, 0);

  // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÉÿßÿ¥ ÿßŸÑÿ≠ÿßŸÑŸä
  const getCurrentCashAmount = () => {
    const cashPayment = selectedPayments.find(payment => {
      const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                     payment.method.toLowerCase().includes('cash');
      return isCash;
    });
    return cashPayment?.amount || 0;
  };

  const cashAmount = getCurrentCashAmount();
  
  // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÑŸÑÿπŸÖŸäŸÑ (ŸÅŸÇÿ∑ ŸÖŸÜ ÿßŸÑŸÉÿßÿ¥)
  const remainingForCustomer = Math.max(0, cashAmount - Math.max(0, totalAmount - nonCashTotal));

  // ÿØÿßŸÑÿ© ÿßŸÑÿ™ÿ®ÿØŸäŸÑ ŸÖÿπ ŸÖŸÜÿ∑ŸÇ ÿßŸÑŸÜŸÇŸÑ ÿßŸÑÿ∞ŸÉŸä
  const handlePaymentMethodToggle = (method: string) => {
    const isCash = method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                   method.toLowerCase().includes('cash');
    
    // ŸÑŸÑÿ∑ÿ±ŸÇ ÿ∫Ÿäÿ± ÿßŸÑŸÜŸÇÿØŸäÿ©: ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿπÿØÿØ ÿßŸÑŸÖÿ≥ŸÖŸàÿ≠
    if (!isCash) {
      const activeNonCashPayments = getActiveNonCashPayments();
      const isCurrentlyActive = selectedPayments.find(p => p.method === method)?.isSelected || false;
      
      // ÿ•ÿ∞ÿß ŸÉÿßŸÜ Ÿäÿ≠ÿßŸàŸÑ ÿ™ŸÅÿπŸäŸÑ ÿ∑ÿ±ŸäŸÇÿ© ÿ´ÿßŸÑÿ´ÿ© ÿ∫Ÿäÿ± ŸÜŸÇÿØŸäÿ©
      if (!isCurrentlyActive && activeNonCashPayments.length >= 2) {
        showLocalWarning('ŸÑÿß ŸäŸÖŸÉŸÜ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ£ŸÉÿ´ÿ± ŸÖŸÜ Ÿàÿ≥ŸäŸÑÿ™Ÿä ÿØŸÅÿπ ÿ∫Ÿäÿ± ŸÜŸÇÿØŸäÿ©');
        return;
      }
    }

    setSelectedPayments(prevPayments => {
      return prevPayments.map(payment => {
        if (payment.method === method) {
          const newIsSelected = !payment.isSelected;
          
          if (isCash && newIsSelected) {
            // ŸÑŸÑŸÉÿßÿ¥: ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÅŸÇÿ∑
            const currentNonCashTotal = prevPayments
              .filter(p => {
                const isOtherCash = p.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                                 p.method.toLowerCase().includes('cash');
                return !isOtherCash && p.isSelected && p.amount > 0;
              })
              .reduce((sum, p) => sum + p.amount, 0);
            
            const remainingAmount = Math.max(0, totalAmount - currentNonCashTotal);
            
            return {
              ...payment,
              isSelected: true,
              amount: remainingAmount,
              wasModified: false
            };
          } else if (!isCash && newIsSelected) {
            // ŸÑŸÑÿ∑ÿ±ŸÇ ÿ∫Ÿäÿ± ÿßŸÑŸÜŸÇÿØŸäÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©: ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÖŸÜÿ∑ŸÇ ÿßŸÑÿ∞ŸÉŸä
            const currentActiveNonCash = prevPayments.find(p => {
              const isOtherCash = p.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                               p.method.toLowerCase().includes('cash');
              return !isOtherCash && p.method !== method && p.isSelected && p.amount > 0;
            });
            
            let amountToAssign = 0;
            
            if (currentActiveNonCash) {
              // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ÿ∑ÿ±ŸäŸÇÿ© ŸÜÿ¥ÿ∑ÿ© ÿ£ÿÆÿ±Ÿâ
              if (currentActiveNonCash.wasModified) {
                // ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ÿπÿØŸäŸÑŸáÿß: ÿ£ÿÆÿ∞ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÖŸÜ ÿßŸÑŸÉÿßÿ¥
                const currentCash = prevPayments.find(p => {
                  const isCashPayment = p.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                                       p.method.toLowerCase().includes('cash');
                  return isCashPayment;
                });
                amountToAssign = currentCash?.amount || 0;
              } else {
                // ÿ•ÿ∞ÿß ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿπÿØŸäŸÑŸáÿß: ŸÜŸÇŸÑ ŸÉÿßŸÖŸÑ ÿßŸÑŸÇŸäŸÖÿ©
                amountToAssign = currentActiveNonCash.amount;
              }
            } else {
              // ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ∑ÿ±ŸäŸÇÿ© ŸÜÿ¥ÿ∑ÿ© ÿ£ÿÆÿ±Ÿâ: ÿ£ÿÆÿ∞ ŸÉÿßŸÖŸÑ ÿßŸÑŸÖÿ®ŸÑÿ∫
              amountToAssign = totalAmount;
            }
            
            return {
              ...payment,
              isSelected: true,
              amount: amountToAssign,
              wasModified: false
            };
          } else {
            // ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ™ŸÅÿπŸäŸÑ
            return {
              ...payment,
              isSelected: false,
              amount: 0,
              wasModified: false
            };
          }
        } else {
          // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ∑ÿ±ŸÇ ÿßŸÑÿ£ÿÆÿ±Ÿâ ÿπŸÜÿØ ÿ™ŸÅÿπŸäŸÑ ÿ∑ÿ±ŸäŸÇÿ© ÿ¨ÿØŸäÿØÿ©
          const newMethodData = prevPayments.find(p => p.method === method);
          const isNewMethodBeingActivated = newMethodData && !newMethodData.isSelected;
          
          if (isNewMethodBeingActivated && !isCash) {
            const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                           payment.method.toLowerCase().includes('cash');
            const isCurrentNonCash = !(payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                                     payment.method.toLowerCase().includes('cash'));
            
            // ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ© ÿ∫Ÿäÿ± ŸÜŸÇÿØŸäÿ© ŸàŸÜÿ¥ÿ∑ÿ©
            if (isCurrentNonCash && payment.isSelected) {
              if (payment.wasModified) {
                // ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ÿπÿØŸäŸÑŸáÿß: ÿßÿ≠ÿ™ŸÅÿ∏ ÿ®Ÿáÿß ŸàŸÇŸÑŸÑ ŸÖŸÜ ÿßŸÑŸÉÿßÿ¥
                return payment;
              } else {
                // ÿ•ÿ∞ÿß ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿπÿØŸäŸÑŸáÿß: ÿßŸÜŸÇŸÑ ŸÇŸäŸÖÿ™Ÿáÿß ŸÑŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©
                return {
                  ...payment,
                  isSelected: false,
                  amount: 0,
                  wasModified: false
                };
              }
            } else if (isCash) {
              // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÉÿßÿ¥ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿ≠ÿßŸÑÿ©
              const currentActiveNonCash = prevPayments.find(p => {
                const isOtherCash = p.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                                   p.method.toLowerCase().includes('cash');
                return !isOtherCash && p.method !== method && p.isSelected && p.amount > 0;
              });
              
              if (currentActiveNonCash?.wasModified) {
                // ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ© ŸÖÿπÿØŸÑÿ©: ÿßŸÑŸÉÿßÿ¥ ŸäŸÅŸÇÿØ ŸÇŸäŸÖÿ™Ÿá ŸÑŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©
                const newMethodAmount = payment.amount;
                return {
                  ...payment,
                  amount: Math.max(0, payment.amount - newMethodAmount),
                  isSelected: Math.max(0, payment.amount - newMethodAmount) > 0
                };
              } else {
                // ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ŸÉŸÜ ŸÖÿπÿØŸÑÿ©: ÿßŸÑŸÉÿßÿ¥ Ÿäÿ£ÿÆÿ∞ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä
                const newAmount = Math.max(0, totalAmount - (currentActiveNonCash?.amount || totalAmount));
                return {
                  ...payment,
                  amount: newAmount,
                  isSelected: newAmount > 0
                };
              }
            }
          }
          
          return payment;
        }
      });
    });
  };

  // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÉÿßÿ¥ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿ∫Ÿäÿ± ÿßŸÑŸÉÿßÿ¥
  useEffect(() => {
    const cashMethod = getCashMethod();
    if (!cashMethod) return;

    if (nonCashTotal !== lastNonCashTotal) {
      const autoCalculatedCashAmount = Math.max(0, totalAmount - nonCashTotal);

      setSelectedPayments(prevPayments => {
        return prevPayments.map(payment => {
          const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                         payment.method.toLowerCase().includes('cash');
          
          if (isCash) {
            return {
              ...payment,
              amount: autoCalculatedCashAmount,
              isSelected: autoCalculatedCashAmount > 0
            };
          }
          return payment;
        });
      });

      const selectedCash = selectedPaymentMethod?.toLowerCase().includes('ŸÉÿßÿ¥') || 
                          selectedPaymentMethod?.toLowerCase().includes('cash');
      if (selectedCash) {
        setPaidAmount(autoCalculatedCashAmount === 0 ? '0' : autoCalculatedCashAmount.toFixed(2));
        setIsFirstInput(true);
      }

      setLastNonCashTotal(nonCashTotal);
    }
  }, [nonCashTotal, totalAmount, selectedPaymentMethod, lastNonCashTotal]);

  // ÿ™ŸáŸäÿ¶ÿ© ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ
  useEffect(() => {
    if (!isOpen || !paymentMethods?.length) return;
    
    const cashMethod = getCashMethod();
    const initialPayments = paymentMethods.map(method => {
      const isCash = method.name.toLowerCase().includes('ŸÉÿßÿ¥') || 
                     method.name.toLowerCase().includes('cash');
      
      return {
        method: method.name,
        amount: isCash ? totalAmount : 0,
        isSelected: isCash,
        wasModified: false
      };
    });
    
    setSelectedPayments(initialPayments);
    
    if (cashMethod) {
      setSelectedPaymentMethod(cashMethod.name);
      setPaidAmount(totalAmount.toFixed(2));
      setIsFirstInput(true);
    }
    
    setLastNonCashTotal(0);
  }, [isOpen, paymentMethods, totalAmount]);

  // ŸÖÿπÿßŸÑÿ¨ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÖÿ®ŸÑÿ∫ ŸÖÿπ ÿ™ÿ≠ÿØŸäÿØ flag ÿßŸÑÿ™ÿπÿØŸäŸÑ
  const handleAmountChange = (amount: string) => {
    setIsFirstInput(false);
    setPaidAmount(amount);
    
    if (selectedPaymentMethod) {
      const numericAmount = parseFloat(amount) || 0;
      const isCashSelected = selectedPaymentMethod.toLowerCase().includes('ŸÉÿßÿ¥') || 
                            selectedPaymentMethod.toLowerCase().includes('cash');
      
      if (!isCashSelected) {
        // ŸÑŸÑÿ∑ÿ±ŸÇ ÿ∫Ÿäÿ± ÿßŸÑŸÜŸÇÿØŸäÿ©: ŸÖŸÜÿπ ÿßŸÑÿ™ÿ¨ÿßŸàÿ≤ ÿπŸÜ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä Ÿàÿ™ÿ≠ÿØŸäÿØ wasModified
        const currentOtherNonCashTotal = selectedPayments
          .filter(payment => {
            const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                           payment.method.toLowerCase().includes('cash');
            return !isCash && payment.method !== selectedPaymentMethod && payment.amount > 0;
          })
          .reduce((sum, payment) => sum + payment.amount, 0);
        
        const maxAllowed = Math.max(0, totalAmount - currentOtherNonCashTotal);
        const finalAmount = Math.min(numericAmount, maxAllowed);
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØÿÆŸÑ ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ŸÇŸÑŸäŸÑŸá
        if (finalAmount !== numericAmount) {
          setPaidAmount(finalAmount.toFixed(2));
        }
        
        setSelectedPayments(prevPayments => {
          return prevPayments.map(payment => {
            if (payment.method === selectedPaymentMethod) {
              return {
                ...payment,
                amount: finalAmount,
                isSelected: finalAmount > 0,
                wasModified: true // ÿ™ÿ≠ÿØŸäÿØ ÿ£ŸÜŸá ÿ™ŸÖ ÿßŸÑÿ™ÿπÿØŸäŸÑ
              };
            } else {
              const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                             payment.method.toLowerCase().includes('cash');
              
              if (isCash) {
                const remainingAmount = Math.max(0, totalAmount - currentOtherNonCashTotal - finalAmount);
                return {
                  ...payment,
                  amount: remainingAmount,
                  isSelected: remainingAmount > 0
                };
              }
              return payment;
            }
          });
        });
      } else {
        // ŸÑŸÑŸÉÿßÿ¥: ŸäŸÖŸÉŸÜ ÿ£Ÿä ŸÖÿ®ŸÑÿ∫
        setSelectedPayments(prevPayments => {
          return prevPayments.map(payment => {
            if (payment.method === selectedPaymentMethod) {
              return {
                ...payment,
                amount: numericAmount,
                isSelected: numericAmount > 0,
                wasModified: true // ÿ™ÿ≠ÿØŸäÿØ ÿ£ŸÜŸá ÿ™ŸÖ ÿßŸÑÿ™ÿπÿØŸäŸÑ
              };
            }
            return payment;
          });
        });
      }
    }
  };

  const handleQuickAmountSelect = (amount: number) => {
    setIsFirstInput(false);
    
    if (selectedPaymentMethod) {
      const isCashSelected = selectedPaymentMethod.toLowerCase().includes('ŸÉÿßÿ¥') || 
                            selectedPaymentMethod.toLowerCase().includes('cash');
      
      setPaidAmount(amount.toFixed(2));
      
      if (!isCashSelected) {
        // ŸÑŸÑÿ∑ÿ±ŸÇ ÿ∫Ÿäÿ± ÿßŸÑŸÜŸÇÿØŸäÿ©: ŸÖŸÜÿπ ÿßŸÑÿ™ÿ¨ÿßŸàÿ≤ Ÿàÿ™ÿ≠ÿØŸäÿØ wasModified
        const currentOtherNonCashTotal = selectedPayments
          .filter(payment => {
            const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                           payment.method.toLowerCase().includes('cash');
            return !isCash && payment.method !== selectedPaymentMethod && payment.amount > 0;
          })
          .reduce((sum, payment) => sum + payment.amount, 0);
        
        const maxAllowed = Math.max(0, totalAmount - currentOtherNonCashTotal);
        const finalAmount = Math.min(amount, maxAllowed);
        
        if (finalAmount !== amount) {
          setPaidAmount(finalAmount.toFixed(2));
        }
        
        setSelectedPayments(prevPayments => {
          return prevPayments.map(payment => {
            if (payment.method === selectedPaymentMethod) {
              return {
                ...payment,
                amount: finalAmount,
                isSelected: true,
                wasModified: true // ÿ™ÿ≠ÿØŸäÿØ ÿ£ŸÜŸá ÿ™ŸÖ ÿßŸÑÿ™ÿπÿØŸäŸÑ
              };
            } else {
              const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                             payment.method.toLowerCase().includes('cash');
              
              if (isCash) {
                const remainingAmount = Math.max(0, totalAmount - currentOtherNonCashTotal - finalAmount);
                return {
                  ...payment,
                  amount: remainingAmount,
                  isSelected: remainingAmount > 0
                };
              }
              return payment;
            }
          });
        });
      } else {
        // ŸÑŸÑŸÉÿßÿ¥: ŸÑÿß ÿ™ÿ£ÿ´Ÿäÿ± ÿπŸÑŸâ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ ÿßŸÑÿ£ÿÆÿ±Ÿâ Ÿàÿ™ÿ≠ÿØŸäÿØ wasModified
        setSelectedPayments(prevPayments => {
          return prevPayments.map(payment => {
            if (payment.method === selectedPaymentMethod) {
              return {
                ...payment,
                amount: amount,
                isSelected: true,
                wasModified: true // ÿ™ÿ≠ÿØŸäÿØ ÿ£ŸÜŸá ÿ™ŸÖ ÿßŸÑÿ™ÿπÿØŸäŸÑ
              };
            }
            return payment;
          });
        });
      }
    }
  };

  const handlePaymentMethodSelect = (method: string) => {
    setSelectedPaymentMethod(method);
    
    const isCashSelected = method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                          method.toLowerCase().includes('cash');
    
    if (!isCashSelected) {
      // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÑŸÑÿ£Ÿàÿ±ÿØÿ±
      const currentNonCashTotal = selectedPayments
        .filter(payment => {
          const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                         payment.method.toLowerCase().includes('cash');
          return !isCash && payment.method !== method && payment.amount > 0;
        })
        .reduce((sum, payment) => sum + payment.amount, 0);
      
      const remainingAmountForOrder = Math.max(0, totalAmount - currentNonCashTotal);
      
      // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ŸÖÿ®ŸÑÿ∫ ŸÖÿ™ÿ®ŸÇŸäÿå ÿ∂ÿπŸá ŸÅŸä ÿßŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ©
      if (remainingAmountForOrder > 0) {
        setSelectedPayments(prevPayments => {
          return prevPayments.map(payment => {
            if (payment.method === method) {
              return {
                ...payment,
                amount: remainingAmountForOrder,
                isSelected: true,
                wasModified: false // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿπŸÜÿØ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±
              };
            } else {
              const isCash = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                             payment.method.toLowerCase().includes('cash');
              
              if (isCash) {
                // ÿµŸÅÿ± ÿßŸÑŸÉÿßÿ¥ ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ™ÿ∫ÿ∑Ÿäÿ© ÿßŸÑÿ£Ÿàÿ±ÿØÿ± ÿ®ÿßŸÑŸÉÿßŸÖŸÑ
                return {
                  ...payment,
                  amount: 0,
                  isSelected: false
                };
              }
              return payment;
            }
          });
        });
        
        setPaidAmount(remainingAmountForOrder.toFixed(2));
      } else {
        const currentPayment = selectedPayments.find(p => p.method === method);
        const amount = currentPayment?.amount || 0;
        setPaidAmount(amount === 0 ? '0' : amount.toFixed(2));
      }
      
      setIsFirstInput(true);
    } else {
      const currentPayment = selectedPayments.find(p => p.method === method);
      const amount = currentPayment?.amount || 0;
      setPaidAmount(amount === 0 ? '0' : amount.toFixed(2));
      setIsFirstInput(true);
    }
  };
  const canFinish = (nonCashTotal + cashAmount) >= totalAmount;

  // ÿßŸÑÿØÿßŸÑÿ© ÿßŸÑŸÖÿ≠ÿØÿ´ÿ© ŸÑŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿØŸÅÿπ
const handleFinishPayment = useCallback(async () => {
  if (isSubmitting) return; // ŸÖŸÜÿπ ÿßŸÑÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑŸÖÿ™ŸÉÿ±ÿ±
  if (!canFinish) return;

  try {
    setIsSubmitting(true);

    // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÄ hook ÿßŸÑÿ¨ÿØŸäÿØ
    const invoiceResult = await saveInvoice(
      orderSummary,
      orderType,
      selectedPayments,
      getInvoiceStatus(), // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ÿßŸÑÿ®ÿ±ÿßŸÖÿ™ÿ±
      {
        isEditMode,
        invoiceId: currentInvoiceId,
        selectedCustomer,
        selectedAddress,
        selectedDeliveryCompany,
        selectedTable,
        servicePercentage: 0, // ŸäŸÖŸÉŸÜ ÿ™ÿÆÿµŸäÿµŸá
        taxPercentage: 0, // ŸäŸÖŸÉŸÜ ÿ™ÿÆÿµŸäÿµŸá
        discountPercentage: 0, // ŸäŸÖŸÉŸÜ ÿ™ÿÆÿµŸäÿµŸá
        notes: customerName,
        
      }
    );

    showLocalSuccess(
      isEditMode 
        ? `ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠!`
        : `ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©: ${invoiceResult.invoiceNumber}`
    );

    // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ŸÑŸÑŸÖŸÉŸàŸÜ ÿßŸÑÿ£ÿµŸÑŸä
    onPaymentComplete({
      success: true,
      invoice: invoiceResult,
      payments: selectedPayments.filter(p => p.isSelected && p.amount > 0)
    });

  } catch (error: any) {
    console.error('Error processing payment:', error);
    showLocalError(error.message || 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿØŸÅÿπ');
    
    onPaymentComplete({
      success: false,
      payments: selectedPayments,
      error: error.message || 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿØŸÅÿπ'
    });
  } finally {
    setIsSubmitting(false);
  }
}, [
  canFinish,
  orderSummary,
  orderType,
  selectedPayments,
  selectedCustomer,
  selectedAddress,
  selectedDeliveryCompany,
  selectedTable,
  customerName,
  isEditMode,
  currentInvoiceId,
  saveInvoice,
  onPaymentComplete
]);


  if (!isOpen) return null;

  return (
    <div className={styles.overlay} ref={overlayRef}>
      <div className={styles.popup}>
        <div className={styles.header}>
          <div className={styles.logo}>
            <img src="/images/img_foodify_logo_2_78x166.png" alt="Foodify" />
          </div>
          <h2 className={styles.title}>
            {isEditMode ? 'ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ∑ŸÑÿ®' : 'ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿØŸÅÿπ'}
          </h2>
          <button className={styles.closeBtn} onClick={onClose}>√ó</button>
        </div>

        <div className={styles.content}>
          <div className={styles.leftSection}>
            <PaymentLeft
              orderSummary={orderSummary}
              selectedCustomer={selectedCustomer}
              selectedAddress={selectedAddress}
              orderType={orderType}
              deliveryCharge={deliveryCharge}
            />
          </div>
          <div className={styles.centerSection}>
            <PaymentCenter
              totalAmount={totalAmount}
              paidAmount={paidAmount}
              cashAmount={cashAmount}
              remainingForCustomer={remainingForCustomer}
              selectedPaymentMethod={selectedPaymentMethod}
              onAmountChange={handleAmountChange}
              onQuickAmountSelect={handleQuickAmountSelect}
              isFirstInput={isFirstInput}
              nonCashTotal={nonCashTotal}
            />
          </div>
          <div className={styles.rightSection}>
            {loading ? (
              <div style={{
                display: 'flex',
                justifyContent: 'center',
                alignItems: 'center',
                height: '100%',
                fontFamily: 'Cairo, sans-serif'
              }}>
                ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ...
              </div>
            ) : error ? (
              <div style={{ color: 'red', textAlign: 'center', marginTop: 20 }}>{error}</div>
            ) : (
              <PaymentRight
                availablePaymentMethods={paymentMethods.map(m => m.name)}
                selectedPayments={selectedPayments}
                selectedPaymentMethod={selectedPaymentMethod}
                onPaymentMethodSelect={handlePaymentMethodSelect}
                onPaymentMethodToggle={handlePaymentMethodToggle}
                onFinishPayment={handleFinishPayment}
                canFinish={canFinish}
                totalPaidAllMethods={nonCashTotal + cashAmount}
                totalAmount={totalAmount}
                nonCashTotal={nonCashTotal}
                onShowWarning={showLocalWarning}
                isEditMode={isEditMode} // ÿ™ŸÖÿ±Ÿäÿ± ŸÖÿπŸÑŸàŸÖÿ© Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
                  isSubmitting={isInvoiceSubmitting} // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©

              />
            )}
          </div>
        </div>

        {/* ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÄ Snackbar ÿßŸÑŸÖÿ≠ŸÑŸä ÿØÿßÿÆŸÑ ÿßŸÑŸÄ popup */}
        <Snackbar
          open={localAlert.open}
          anchorOrigin={{ vertical: 'top', horizontal: 'center' }}
          autoHideDuration={4000}
          onClose={() => setLocalAlert(prev => ({ ...prev, open: false }))}
          sx={{ 
            position: 'absolute', // ŸÖŸáŸÖ: ŸÜÿ≥ÿ®Ÿä ŸÑŸÖŸàÿ∂ÿπ ÿßŸÑŸÄ popup
            zIndex: 10 // ŸÅŸàŸÇ ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÄ popup
          }}
        >
          <Alert
            onClose={() => setLocalAlert(prev => ({ ...prev, open: false }))}
            severity={localAlert.severity}
            variant="filled"
            sx={{ 
              width: '100%',
              fontFamily: 'Cairo, sans-serif'
            }}
          >
            {localAlert.message}
          </Alert>
        </Snackbar>
      </div>
    </div>
  );
};

export default PaymentPopup;

===== src/Pages/pos/newSales/components/PriceSelectionPopup.tsx =====
// src/Pages/pos/newSales/components/PriceSelectionPopup.tsx
import React, { useEffect, useRef } from 'react';
import { PosProduct, PosPrice } from '../types/PosSystem';
import CloseIcon from '@mui/icons-material/Close';
import styles from '../styles/PriceSelectionPopup.module.css';

interface PriceSelectionPopupProps {
  product: PosProduct | null;
  quantity: number;
  isOpen: boolean;
  onClose: () => void;
  onSelectPrice: (price: PosPrice) => void;
}

const PriceSelectionPopup: React.FC<PriceSelectionPopupProps> = ({
  product,
  isOpen,
  onClose,
  onSelectPrice
}) => {
  const overlayRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const handleOverlayClick = (e: MouseEvent) => {
      if (overlayRef.current && e.target === overlayRef.current) {
        onClose();
      }
    };

    if (isOpen) {
      document.addEventListener('mousedown', handleOverlayClick);
    }

    return () => {
      document.removeEventListener('mousedown', handleOverlayClick);
    };
  }, [isOpen, onClose]);

  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        onClose();
      }
    };

    if (isOpen) {
      document.addEventListener('keydown', handleEscape);
    }

    return () => {
      document.removeEventListener('keydown', handleEscape);
    };
  }, [isOpen, onClose]);

  if (!isOpen || !product) return null;

  return (
    <div className={styles.popupOverlay} ref={overlayRef}>
      <div className={styles.popupContent}>
        <div className={styles.popupHeader}>
          <h3 className={styles.popupTitle}>{product.nameArabic}</h3>
          <button className={styles.popupClose} onClick={onClose}>
            <CloseIcon />
          </button>
        </div>
        
        <div className={styles.popupBody}>
          
          <div className={styles.pricesGrid}>
            {product.productPrices.map((price) => (
              <button
                key={price.id}
                className={styles.priceCard}
                onClick={() => onSelectPrice(price)}
              >
                <div className={styles.priceName}>{price.nameArabic}</div>
                <div className={styles.priceValue}>
                  <span className={styles.price}>{price.price}</span>
                  <span className={styles.currency}>EGP</span>
                </div>
              </button>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

export default PriceSelectionPopup;

===== src/Pages/pos/newSales/components/ProductCard.tsx =====
// src/Pages/pos/newSales/components/ProductCard.tsx
import React from 'react';
import { PosProduct } from '../types/PosSystem';
import styles from '../styles/ProductCard.module.css';

interface ProductCardProps {
  product: PosProduct;
  onClick: (product: PosProduct) => void;
}

const ProductCard: React.FC<ProductCardProps> = ({ product, onClick }) => {
  const handleClick = () => {
    onClick(product);
  };

  // ÿ™ÿ≠ÿØŸäÿØ ŸÖÿß ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÑŸá ÿ≥ÿπÿ± Ÿàÿßÿ≠ÿØ ÿ£ŸÖ ÿ£ŸÉÿ´ÿ±
  const hasMultiplePrices = product.hasMultiplePrices;
  const singlePrice = !hasMultiplePrices && product.productPrices.length > 0 
    ? product.productPrices[0].price 
    : null;

  return (
    <div className={styles.productCard} onClick={handleClick}>
      <div className={styles.productImageContainer}>
        <img 
          src={product.image} 
          alt={product.nameArabic} 
          className={styles.productImage}
        />
        
        {/* ÿπÿ±ÿ∂ ÿßŸÑÿ≥ÿπÿ± ÿπŸÑŸâ ÿßŸÑÿµŸàÿ±ÿ© ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÑŸá ÿ≥ÿπÿ± Ÿàÿßÿ≠ÿØ */}
        {singlePrice !== null && (
          <div className={styles.priceOverlay}>
            {singlePrice.toFixed(2)} EGP
          </div>
        )}
      </div>
      
      <div className={styles.productInfo}>
        <h3 className={styles.productName}>
          {product.nameArabic}
        </h3>
      </div>
    </div>
  );
};

export default ProductCard;

===== src/Pages/pos/newSales/components/ProductOptionsPopup.tsx =====
// src/Pages/pos/newSales/components/ProductOptionsPopup.tsx
import React, { useState, useEffect } from 'react';
import { PosProduct, PosPrice, ProductOptionGroup, ProductOptionItem, SelectedOption } from '../types/PosSystem';
import CloseIcon from '@mui/icons-material/Close';
import AddIcon from '@mui/icons-material/Add';
import RemoveIcon from '@mui/icons-material/Remove';
import CheckIcon from '@mui/icons-material/Check';
import ArrowBackIcon from '@mui/icons-material/ArrowBack';
import ArrowForwardIcon from '@mui/icons-material/ArrowForward';
import styles from '../styles/ProductOptionsPopup.module.css';

interface ProductOptionsPopupProps {
  product: PosProduct | null;
  selectedPrice: PosPrice | null;
  quantity: number;
  isOpen: boolean;
  onClose: () => void;
  onComplete: (selectedOptions: SelectedOption[]) => void;
}

const ProductOptionsPopup: React.FC<ProductOptionsPopupProps> = ({
  product,
  selectedPrice,
  quantity,
  isOpen,
  onClose,
  onComplete
}) => {
  const [selectedOptions, setSelectedOptions] = useState<SelectedOption[]>([]);
  const [groupSelections, setGroupSelections] = useState<{[groupId: string]: {[itemId: string]: number}}>({});
  const [currentGroupIndex, setCurrentGroupIndex] = useState(0);

  useEffect(() => {
    if (isOpen && product) {
      setSelectedOptions([]);
      setGroupSelections({});
      setCurrentGroupIndex(0);
    }
  }, [isOpen, product]);

  if (!isOpen || !product || !selectedPrice) return null;

  const optionGroups = product.productOptionGroups || [];

  if (optionGroups.length === 0) {
    onComplete([]);
    return null;
  }

  const currentGroup = optionGroups[currentGroupIndex];

  const handleItemSelection = (group: ProductOptionGroup, item: ProductOptionItem, change: number) => {
    const newSelections = { ...groupSelections };
    
    if (!newSelections[group.id]) {
      newSelections[group.id] = {};
    }
    
    const currentCount = newSelections[group.id][item.id] || 0;
    const newCount = Math.max(0, currentCount + change);
    
    const totalSelected = Object.values(newSelections[group.id]).reduce((sum, count) => sum + count, 0);
    const otherItemsTotal = totalSelected - currentCount;
    
    if (group.allowMultiple) {
      if (newCount + otherItemsTotal <= group.maxSelection) {
        newSelections[group.id][item.id] = newCount;
      }
    } else {
      if (newCount > 0) {
        newSelections[group.id] = { [item.id]: 1 };
      } else {
        newSelections[group.id][item.id] = 0;
      }
    }
    
    setGroupSelections(newSelections);
  };

  const handleCardClick = (group: ProductOptionGroup, item: ProductOptionItem) => {
    const currentCount = groupSelections[group.id]?.[item.id] || 0;
    const totalSelected = Object.values(groupSelections[group.id] || {}).reduce((sum, count) => sum + count, 0);
    const otherItemsTotal = totalSelected - currentCount;
    
    if (group.allowMultiple) {
      // ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÖÿ™ÿπÿØÿØÿ©: ÿ≤ŸäÿßÿØÿ© ÿßŸÑŸÉŸÖŸäÿ©
      if (otherItemsTotal < group.maxSelection) {
        handleItemSelection(group, item, 1);
      }
    } else {
      // ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÅÿ±ÿØŸäÿ©: ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ≠ÿßŸÑÿ©
      handleItemSelection(group, item, currentCount > 0 ? -1 : 1);
    }
  };

  const isCurrentGroupValid = (): boolean => {
    const selections = groupSelections[currentGroup.id] || {};
    const totalSelected = Object.values(selections).reduce((sum, count) => sum + count, 0);
    
    if (currentGroup.isRequired) {
      return totalSelected >= currentGroup.minSelection;
    }
    
    return true; // ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ© ÿØÿßÿ¶ŸÖÿß
  };

  const isAllGroupsValid = (): boolean => {
    return optionGroups.every(group => {
      const selections = groupSelections[group.id] || {};
      const totalSelected = Object.values(selections).reduce((sum, count) => sum + count, 0);
      
      if (group.isRequired) {
        return totalSelected >= group.minSelection;
      }
      
      return totalSelected === 0 || totalSelected >= group.minSelection;
    });
  };

  const handleNext = () => {
    if (currentGroupIndex < optionGroups.length - 1) {
      setCurrentGroupIndex(currentGroupIndex + 1);
    }
  };

  const handlePrevious = () => {
    if (currentGroupIndex > 0) {
      setCurrentGroupIndex(currentGroupIndex - 1);
    }
  };

  const handleComplete = () => {
    const allSelectedOptions: SelectedOption[] = [];
    
    optionGroups.forEach(group => {
      const selections = groupSelections[group.id] || {};
      Object.entries(selections).forEach(([itemId, count]) => {
        if (count > 0) {
          const item = group.optionItems.find(i => i.id === itemId);
          if (item) {
            allSelectedOptions.push({
              groupId: group.id,
              itemId: itemId,
              itemName: item.name,
              quantity: count,
              extraPrice: item.extraPrice,
              isCommentOnly: item.isCommentOnly
            });
          }
        }
      });
    });
    
    onComplete(allSelectedOptions);
  };

  const calculateTotalPrice = () => {
    let total = selectedPrice.price * quantity;
    
    optionGroups.forEach(group => {
      const selections = groupSelections[group.id] || {};
      Object.entries(selections).forEach(([itemId, count]) => {
        if (count > 0) {
          const item = group.optionItems.find(i => i.id === itemId);
          if (item) {
            total += item.extraPrice * count * quantity;
          }
        }
      });
    });
    
    return total;
  };

  const selections = groupSelections[currentGroup.id] || {};
  const totalSelected = Object.values(selections).reduce((sum, count) => sum + count, 0);

  return (
    <div className={styles.popupOverlay}>
      <div className={styles.popupContent}>
<div className={styles.popupHeader}>
  <div className={styles.popupTitleSection}>
    <h3 className={styles.popupTitle}>{product.nameArabic}</h3>
    <div className={styles.popupSubtitle}>
      {selectedPrice.nameArabic} - ÿßŸÑŸÉŸÖŸäÿ©: {quantity}
    </div>
  </div>
  <div style={{ display: 'flex', gap: '8px' }}>
    {currentGroupIndex > 0 && (
      <button 
        className={styles.popupClose} 
        onClick={handlePrevious}
        title="ÿßŸÑÿ±ÿ¨Ÿàÿπ ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©"
      >
        <ArrowBackIcon />
      </button>
    )}
    <button className={styles.popupClose} onClick={onClose}>
      <CloseIcon />
    </button>
  </div>
</div>
        
        <div className={styles.popupBody}>
          {/* ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ŸÇÿØŸÖ */}
          <div className={styles.progressIndicator}>
            <div className={styles.progressText}>
              ŸÖÿ¨ŸÖŸàÿπÿ© {currentGroupIndex + 1} ŸÖŸÜ {optionGroups.length}
            </div>
            <div className={styles.progressBar}>
              <div 
                className={styles.progressFill} 
                style={{ width: `${((currentGroupIndex + 1) / optionGroups.length) * 100}%` }}
              />
            </div>
          </div>

          <div className={styles.optionsContainer}>
            <div className={styles.optionGroup}>
              <div className={styles.groupHeader}>
                <div className={styles.groupTitle}>
                  <span className={styles.groupName}>{currentGroup.name}</span>
                  {currentGroup.isRequired && (
                    <span className={styles.requiredBadge}>ŸÖÿ∑ŸÑŸàÿ®</span>
                  )}
                </div>
                <div className={styles.groupInfo}>
                  <span className={styles.selectionCount}>
                    {totalSelected} ŸÖŸÜ {currentGroup.maxSelection}
                  </span>
                  {currentGroup.minSelection > 0 && (
                    <span className={styles.minSelection}>
                      (ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ: {currentGroup.minSelection})
                    </span>
                  )}
                </div>
              </div>
              
              <div className={styles.optionsGrid}>
                {currentGroup.optionItems
                  .sort((a, b) => a.sortOrder - b.sortOrder)
                  .map((item) => {
                    const itemCount = selections[item.id] || 0;
                    const canAdd = currentGroup.allowMultiple 
                      ? totalSelected < currentGroup.maxSelection
                      : itemCount === 0;
                    
                    return (
                      <div 
                        key={item.id} 
                        className={`${styles.optionCard} ${itemCount > 0 ? styles.selected : ''}`}
                        onClick={() => handleCardClick(currentGroup, item)}
                      >
                        <div className={styles.optionContent}>
                          <div className={styles.optionInfo}>
                            <div className={styles.optionName}>{item.name}</div>
                            {item.extraPrice > 0 && (
                              <div className={styles.optionPrice}>
                                +{item.extraPrice} EGP
                              </div>
                            )}
                          </div>
                          
                          <div className={styles.optionControls}>
                            {currentGroup.allowMultiple ? (
                              <div className={styles.quantitySection}>
                                {itemCount > 0 && (
                                  <button
                                    className={styles.removeBtn}
                                    onClick={(e) => {
                                      e.stopPropagation();
                                      handleItemSelection(currentGroup, item, -1);
                                    }}
                                  >
                                    <RemoveIcon />
                                  </button>
                                )}
                                
                                {itemCount > 0 ? (
                                  <div className={styles.quantityBadge}>
                                    {itemCount}
                                  </div>
                                ) : canAdd ? (
                                  <div className={styles.addIcon}>
                                    <AddIcon />
                                  </div>
                                ) : (
                                  <div className={styles.maxReached}>
                                    <span>ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ</span>
                                  </div>
                                )}
                              </div>
                            ) : (
                              <div className={styles.singleSelect}>
                                {itemCount > 0 ? (
                                  <div className={styles.selectedIcon}>
                                    <CheckIcon />
                                  </div>
                                ) : (
                                  <div className={styles.unselectedIcon}>
                                    <AddIcon />
                                  </div>
                                )}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    );
                  })}
              </div>
            </div>
          </div>
          
          <div className={styles.totalSection}>
            <div className={styles.totalRow}>
              <span className={styles.totalLabel}>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä:</span>
              <span className={styles.totalValue}>{calculateTotalPrice().toFixed(2)} EGP</span>
            </div>
          </div>
        </div>
        
        <div className={styles.popupFooter}>
          <button className={styles.btnCancel} onClick={onClose}>
            ÿ•ŸÑÿ∫ÿßÿ°
          </button>
          
          {currentGroupIndex < optionGroups.length - 1 ? (
            <button
              className={styles.btnConfirm}
              onClick={handleNext}
              disabled={currentGroup.isRequired && !isCurrentGroupValid()}
            >
              ÿßŸÑÿ™ÿßŸÑŸä
              <ArrowForwardIcon />
            </button>
          ) : (
            <button
              className={styles.btnConfirm}
              onClick={handleComplete}
              disabled={!isAllGroupsValid()}
            >
              ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ±
            </button>
          )}
        </div>
      </div>
    </div>
  );
};

export default ProductOptionsPopup;

===== src/Pages/pos/newSales/components/TableSelectionPopup.tsx =====
// src/Pages/pos/newSales/components/TableSelectionPopup.tsx
import React, { useState, useEffect } from 'react';
import { TableSection, Table, TableSelection } from '../types/TableSystem';
import { UnclosedTableInvoice } from '../../../../utils/api/pagesApi/unclosedTablesApi';
import * as unclosedTablesApi from '../../../../utils/api/pagesApi/unclosedTablesApi';
import CloseIcon from '@mui/icons-material/Close';
import VisibilityIcon from '@mui/icons-material/Visibility';
import AccessTimeIcon from '@mui/icons-material/AccessTime';
import styles from '../styles/TableSelectionPopup.module.css';

interface TableSelectionPopupProps {
  isOpen: boolean;
  onClose: () => void;
  onSelectTable: (selection: TableSelection) => void;
  tableSections: TableSection[];
  onViewOrder?: (invoiceData: any) => void; // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ© ŸÑŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ∑ŸÑÿ®
}

const TableSelectionPopup: React.FC<TableSelectionPopupProps> = ({
  isOpen,
  onClose,
  onSelectTable,
  tableSections,
  onViewOrder
}) => {
  const [selectedSection, setSelectedSection] = useState<TableSection | null>(null);
  const [unclosedTables, setUnclosedTables] = useState<UnclosedTableInvoice[]>([]);
  const [loading, setLoading] = useState(false);
  const [openDurations, setOpenDurations] = useState<{[key: string]: string}>({});

  // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ∑ÿßŸàŸÑÿßÿ™ ŸÉŸÑ ÿØŸÇŸäŸÇÿ©
  useEffect(() => {
    if (!isOpen) return;

    const loadUnclosedTables = async () => {
      try {
        setLoading(true);
        const response = await unclosedTablesApi.getBranchUnclosedTables();
        setUnclosedTables(response.data);
      } catch (error) {
        console.error('Error loading unclosed tables:', error);
      } finally {
        setLoading(false);
      }
    };

    loadUnclosedTables();
    
    // ÿ™ÿ≠ÿØŸäÿ´ ŸÉŸÑ ÿØŸÇŸäŸÇÿ©
    const interval = setInterval(loadUnclosedTables, 60000);
    
    return () => clearInterval(interval);
  }, [isOpen]);

  // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸàŸÇÿ™ ŸÉŸÑ ÿ´ÿßŸÜŸäÿ©
useEffect(() => {
  const updateDurations = () => {
    const newDurations: {[key: string]: string} = {};
    unclosedTables.forEach(invoice => {
      if (invoice.tableDTO?.id) {
        // ‚úÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ createdAt ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖŸàÿ¨ŸàÿØÿå Ÿàÿ•ŸÑÿß preparedAt
        const timeToUse = invoice.createdAt !== '0001-01-01T00:00:00' && invoice.createdAt 
          ? invoice.createdAt 
          : invoice.preparedAt || invoice.completedAt;
          
        newDurations[invoice.tableDTO.id] = unclosedTablesApi.calculateTableOpenDuration(timeToUse);
      }
    });
    setOpenDurations(newDurations);
  };

  updateDurations();
  const interval = setInterval(updateDurations, 1000); // ŸÉŸÑ ÿ´ÿßŸÜŸäÿ© ŸÑÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ®ÿßÿ¥ÿ±
  
  return () => clearInterval(interval);
}, [unclosedTables]);


  useEffect(() => {
    if (isOpen && tableSections.length > 0) {
      setSelectedSection(tableSections[0]);
    }
  }, [isOpen, tableSections]);

  if (!isOpen) return null;

  const handleSectionClick = (section: TableSection) => {
    setSelectedSection(section);
  };

  const getTableInvoice = (tableId: string) => {
    return unclosedTables.find(invoice => invoice.tableDTO?.id === tableId);
  };

  const isTableOccupied = (tableId: string) => {
    return !!getTableInvoice(tableId);
  };

const handleTableClick = (table: Table) => {
  if (!selectedSection) return;

  const invoice = getTableInvoice(table.id || '');
  
  if (invoice) {
    // ‚úÖ ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿ∑ÿßŸàŸÑÿ© ŸÖÿ¥ÿ∫ŸàŸÑÿ©: ÿßÿÆÿ™ÿßÿ±Ÿáÿß ÿ£ŸàŸÑÿßŸã ÿ´ŸÖ ÿßÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ®
    onSelectTable({
      section: selectedSection,
      table: table
    });
    
    // ÿ´ŸÖ ÿßÿπÿ±ÿ∂ ŸÖÿ≠ÿ™ŸàŸäÿßÿ™ ÿßŸÑÿ∑ŸÑÿ®
    if (onViewOrder) {
      onViewOrder(invoice);
    }
  } else {
    // ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿ∑ÿßŸàŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©ÿå ÿßÿÆÿ™Ÿäÿßÿ±Ÿáÿß ŸÅŸÇÿ∑
    onSelectTable({
      section: selectedSection,
      table: table
    });
  }
};
  const displayedTables = selectedSection?.tables || [];

  return (
    <div className={styles.popupOverlay}>
      <div className={styles.popupContainer}>
        <div className={styles.posSystem}>
          {/* ÿ≤ÿ± ÿßŸÑÿ•ÿ∫ŸÑÿßŸÇ */}
          <button className={styles.closeBtn} onClick={onClose}>
            <CloseIcon />
            <span>ÿ•ÿ∫ŸÑÿßŸÇ</span>
          </button>

          <main className={styles.mainContent}>
            {/* ŸÇÿ≥ŸÖ ÿßŸÑÿ∑ÿßŸàŸÑÿßÿ™ */}
            <section className={styles.productsSection}>
              {loading && (
                <div className={styles.loadingMessage}>
                  ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ∑ÿßŸàŸÑÿßÿ™...
                </div>
              )}
              
              <div className={styles.productGrid}>
                {displayedTables.map((table) => {
                  const occupied = isTableOccupied(table.id || '');
                  const invoice = getTableInvoice(table.id || '');
                  const duration = openDurations[table.id || ''] || '00:00';
                  
                  return (
                    <div
                      key={table.id}
                      className={`${styles.productItem} ${occupied ? styles.occupied : styles.available}`}
                      onClick={() => handleTableClick(table)}
                    >
                      <div className={styles.productImage}>
                        <img 
                          src="/images/default-table.png" 
                          alt={table.name}
                          onError={(e) => {
                            e.currentTarget.src = '/images/placeholder.png';
                          }}
                        />
                        
                        {/* ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑÿ≠ÿßŸÑÿ© */}
                        <div className={`${styles.statusIcon} ${occupied ? styles.occupiedIcon : styles.availableIcon}`}>
                          {occupied ? 'üî¥' : 'üü¢'}
                        </div>
                        
                        {/* ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑÿπÿ±ÿ∂ ŸÑŸÑÿ∑ÿßŸàŸÑÿßÿ™ ÿßŸÑŸÖÿ¥ÿ∫ŸàŸÑÿ© */}
                        {occupied && (
                          <div className={styles.viewIcon}>
                            <VisibilityIcon />
                          </div>
                        )}
                      </div>
                      
                      <div className={styles.productName}>
                        <span>{table.name}</span>
                        <small>{table.capacity} ÿ£ÿ¥ÿÆÿßÿµ</small>
                        
                        <div className={`${styles.status} ${occupied ? styles.occupied : styles.available}`}>
                          {occupied ? 'ŸÖÿ¥ÿ∫ŸàŸÑÿ©' : 'ŸÖÿ™ÿßÿ≠ÿ©'}
                        </div>
                        
                        {/* ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÑŸÑÿ∑ÿßŸàŸÑÿßÿ™ ÿßŸÑŸÖÿ¥ÿ∫ŸàŸÑÿ© */}
                        {occupied && invoice && (
                          <div className={styles.occupiedInfo}>
                            <div className={styles.orderTotal}>
                              {invoice.totalAfterTaxAndService.toFixed(2)} ÿ¨ŸÜŸäŸá
                            </div>
                            
                            <div className={styles.openDuration}>
                              <AccessTimeIcon style={{ fontSize: 14 }} />
                              <span>{duration}</span>
                            </div>
                            
                            <div className={styles.itemsCount}>
                              {invoice.items?.length || 0} ÿµŸÜŸÅ
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  );
                })}
              </div>
            </section>

            {/* ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä ŸÑŸÑÿ£ŸÇÿ≥ÿßŸÖ */}
            <aside className={styles.categoriesSidebar}>
              <div className={styles.categoriesList}>
                {tableSections.map((section) => {
                  // ÿ≠ÿ≥ÿßÿ® ÿπÿØÿØ ÿßŸÑÿ∑ÿßŸàŸÑÿßÿ™ ÿßŸÑŸÖÿ¥ÿ∫ŸàŸÑÿ© ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑŸÇÿ≥ŸÖ
                  const occupiedCount = section.tables.filter(table => 
                    isTableOccupied(table.id || '')
                  ).length;
                  
                  return (
                    <div
                      key={section.id}
                      className={`${styles.categoryItem} ${selectedSection?.id === section.id ? styles.active : ''}`}
                      onClick={() => handleSectionClick(section)}
                    >
                      <img 
                        src="/images/default-section.png" 
                        alt={section.name}
                        onError={(e) => {
                          e.currentTarget.src = '/images/placeholder.png';
                        }}
                      />
                      <div>
                        <span>{section.name}</span>
                        <br />
                        <small>{section.serviceCharge}% ÿÆÿØŸÖÿ©</small>
                        <br />
                        <small className={styles.occupiedStats}>
                          {occupiedCount}/{section.tables.length} ŸÖÿ¥ÿ∫ŸàŸÑ
                        </small>
                      </div>
                    </div>
                  );
                })}
              </div>
            </aside>
          </main>
        </div>
      </div>
    </div>
  );
};

export default TableSelectionPopup;

===== src/Pages/pos/newSales/components/TodayOrdersPopup.tsx =====
// src/Pages/pos/newSales/components/TodayOrdersPopup.tsx
import React, { useState, useEffect, useMemo } from 'react';
import {
  Dialog,
  DialogTitle,
  DialogContent,
  DialogActions,
  Button,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Paper,
  IconButton,
  TextField,
  Select,
  MenuItem,
  FormControl,
  InputLabel,
  Chip,
  Box,
  Typography,
  CircularProgress,
  Alert,
  Pagination
} from '@mui/material';
import {
  Visibility as VisibilityIcon,
  Close as CloseIcon,
  FilterList as FilterIcon,
  Clear as ClearIcon
} from '@mui/icons-material';
import {
  getAllInvoices,
  getInvoiceById, // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑŸÖŸÅŸÇŸàÿØ
  getInvoiceTypeText,
  getInvoiceStatusText,
  formatDate,
  Invoice,
  InvoicesResponse
} from '../../../../utils/api/pagesApi/invoicesApi';
import styles from '../styles/TodayOrdersPopup.module.css';

interface TodayOrdersPopupProps {
  isOpen: boolean;
  onClose: () => void;
  currentOrderType: string; // ŸÑŸÑŸÅŸÑÿ™ÿ±ÿ© ÿ≠ÿ≥ÿ® ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ≠ÿßŸÑŸä
  onViewOrder: (invoice: Invoice & { isEditMode: boolean }) => void; // ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ® ŸÅŸä ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
}

const TodayOrdersPopup: React.FC<TodayOrdersPopupProps> = ({
  isOpen,
  onClose,
  currentOrderType,
  onViewOrder
}) => {
  const [invoices, setInvoices] = useState<Invoice[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  const [totalCount, setTotalCount] = useState(0);
  const pageSize = 20;

  // States ŸÑŸÑŸÅŸÑÿßÿ™ÿ±
  const [statusFilter, setStatusFilter] = useState<number | ''>('');
  const [searchFilter, setSearchFilter] = useState('');
  const [typeFilter, setTypeFilter] = useState<number | ''>('');

  // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
  const loadInvoices = async (pageNumber: number = 1) => {
    try {
      setLoading(true);
      setError(null);
      
      const response: InvoicesResponse = await getAllInvoices(pageNumber, pageSize);
      
      setInvoices(response.data);
      setTotalPages(response.pageCount);
      setTotalCount(response.totalCount);
      setPage(pageNumber);
    } catch (err: any) {
      setError(err.message || 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
      console.error('Error loading invoices:', err);
    } finally {
      setLoading(false);
    }
  };

  // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿπŸÜÿØ ŸÅÿ™ÿ≠ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
  useEffect(() => {
    if (isOpen) {
      loadInvoices(1);
      
      // ÿ™ÿ∑ÿ®ŸäŸÇ ŸÅŸÑÿ™ÿ± ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑÿ≠ÿßŸÑŸä
      const orderTypeMap: { [key: string]: number } = {
        'Takeaway': 1,
        'Dine-in': 2,
        'Delivery': 3,
        'Pickup': 4
      };
      
      if (currentOrderType && orderTypeMap[currentOrderType]) {
        setTypeFilter(orderTypeMap[currentOrderType]);
      } else {
        setTypeFilter('');
      }
    }
  }, [isOpen, currentOrderType]);

  // ŸÅŸÑÿ™ÿ±ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
  const filteredInvoices = useMemo(() => {
    return invoices.filter(invoice => {
      // ŸÅŸÑÿ™ÿ± ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®
      if (typeFilter !== '' && invoice.invoiceType !== typeFilter) {
        return false;
      }
      
      // ŸÅŸÑÿ™ÿ± ÿßŸÑÿ≠ÿßŸÑÿ©
      if (statusFilter !== '' && invoice.invoiceStatus !== statusFilter) {
        return false;
      }
      
      // ŸÅŸÑÿ™ÿ± ÿßŸÑÿ®ÿ≠ÿ´ (ŸÅŸä ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ£Ÿà ID)
      if (searchFilter.trim() !== '') {
        const searchTerm = searchFilter.toLowerCase();
        const searchInNotes = invoice.notes?.toLowerCase().includes(searchTerm) || false;
        const searchInId = invoice.id.toLowerCase().includes(searchTerm);
        const searchInCustomer = invoice.customerName?.toLowerCase().includes(searchTerm) || false;
        
        if (!searchInNotes && !searchInId && !searchInCustomer) {
          return false;
        }
      }
      
      return true;
    });
  }, [invoices, typeFilter, statusFilter, searchFilter]);

  // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÅŸÑÿßÿ™ÿ±
  const clearFilters = () => {
    setStatusFilter('');
    setSearchFilter('');
    setTypeFilter('');
  };

  // ŸÖÿπÿßŸÑÿ¨ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿµŸÅÿ≠ÿ©
  const handlePageChange = (event: React.ChangeEvent<unknown>, value: number) => {
    loadInvoices(value);
  };

  // ŸÖÿπÿßŸÑÿ¨ ÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ® ŸÖÿπ ŸÖÿπÿßŸÑÿ¨ÿ© ÿ£ŸÅÿ∂ŸÑ ŸÑŸÑÿ£ÿÆÿ∑ÿßÿ°
  const handleViewOrder = async (invoice: Invoice) => {
    try {
      setLoading(true);
      setError(null); // ŸÖÿ≥ÿ≠ ÿßŸÑÿ£ÿÆÿ∑ÿßÿ° ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©
      
      // ÿ¨ŸÑÿ® ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÉÿßŸÖŸÑÿ©
      const fullInvoiceData = await getInvoiceById(invoice.id);
      
      // ÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸÖÿπ ÿ•ÿ¥ÿßÿ±ÿ© ÿ£ŸÜŸáÿß ŸÑŸÑÿ™ÿπÿØŸäŸÑ
      onViewOrder({
        ...fullInvoiceData,
        isEditMode: true // ÿ•ÿ∂ÿßŸÅÿ© ÿπŸÑÿßŸÖÿ© ÿßŸÑÿ™ÿπÿØŸäŸÑ
      });
      
      onClose();
    } catch (error: any) {
      const errorMessage = error.message || 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ®';
      setError(errorMessage);
      console.error('Error loading invoice details:', error);
      
      // ÿπÿØŸÖ ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ŸÅŸä ÿ≠ÿßŸÑÿ© ÿßŸÑÿÆÿ∑ÿ£ ŸÑŸÑÿ≥ŸÖÿßÿ≠ ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ®ÿ±ÿ§Ÿäÿ© ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿÆÿ∑ÿ£
    } finally {
      setLoading(false);
    }
  };

  // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ÿ≠ÿ≥ÿ® ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®
  const getAdditionalInfo = (invoice: Invoice) => {
    switch (invoice.invoiceType) {
      case 2: // Dine-in
        return {
          label: 'ÿßŸÑÿ∑ÿßŸàŸÑÿ©',
          value: invoice.tableId ? `ÿ∑ÿßŸàŸÑÿ© ${invoice.tableId.substring(0, 8)}...` : '--'
        };
      case 3: // Delivery
        return {
          label: 'ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿ™ŸàÿµŸäŸÑ',
          value: invoice.deliveryCompanyId ? `ÿ¥ÿ±ŸÉÿ© ${invoice.deliveryCompanyId.substring(0, 8)}...` : '--'
        };
      default:
        return null;
    }
  };

  // ÿØÿßŸÑÿ© ŸÑÿ™ÿ≠ÿØŸäÿØ ŸÖÿß ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ÿπÿØŸäŸÑ
  const canEditInvoice = (invoice: Invoice) => {
    // ŸäŸÖŸÉŸÜ ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ± ÿßŸÑŸÖŸÉÿ™ŸÖŸÑÿ© ŸàÿßŸÑŸÖÿπŸÑŸÇÿ© ŸÅŸÇÿ∑ÿå ŸÑŸäÿ≥ ÿßŸÑŸÖŸÑÿ∫ÿßÿ©
    return invoice.invoiceStatus === 1 || invoice.invoiceStatus === 2;
  };

  return (
    <Dialog
      open={isOpen}
      onClose={onClose}
      maxWidth="lg"
      fullWidth
      PaperProps={{
        className: styles.dialogPaper
      }}
    >
      <DialogTitle className={styles.dialogTitle}>
        <Box display="flex" justifyContent="space-between" alignItems="center">
          <Typography variant="h6" component="div">
            ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸäŸàŸÖ ({totalCount} ÿ∑ŸÑÿ®)
          </Typography>
          <IconButton onClick={onClose} size="small">
            <CloseIcon />
          </IconButton>
        </Box>
      </DialogTitle>

      <DialogContent className={styles.dialogContent}>
        {/* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑŸÅŸÑÿßÿ™ÿ± */}
        <Box className={styles.filtersBar}>
          <TextField
            label="ÿßŸÑÿ®ÿ≠ÿ´"
            variant="outlined"
            size="small"
            value={searchFilter}
            onChange={(e) => setSearchFilter(e.target.value)}
            placeholder="ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ£Ÿà ÿ±ŸÇŸÖ ÿßŸÑÿ∑ŸÑÿ®..."
            className={styles.searchField}
          />
          
          <FormControl size="small" className={styles.filterSelect}>
            <InputLabel>ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®</InputLabel>
            <Select
              value={typeFilter}
              onChange={(e) => setTypeFilter(e.target.value as number | '')}
              label="ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®"
            >
              <MenuItem value="">ÿßŸÑŸÉŸÑ</MenuItem>
              <MenuItem value={1}>Takeaway</MenuItem>
              <MenuItem value={2}>Dine-in</MenuItem>
              <MenuItem value={3}>Delivery</MenuItem>
              <MenuItem value={4}>Pickup</MenuItem>
            </Select>
          </FormControl>

          <FormControl size="small" className={styles.filterSelect}>
            <InputLabel>ÿßŸÑÿ≠ÿßŸÑÿ©</InputLabel>
            <Select
              value={statusFilter}
              onChange={(e) => setStatusFilter(e.target.value as number | '')}
              label="ÿßŸÑÿ≠ÿßŸÑÿ©"
            >
              <MenuItem value="">ÿßŸÑŸÉŸÑ</MenuItem>
              <MenuItem value={1}>ŸÖŸÉÿ™ŸÖŸÑÿ©</MenuItem>
              <MenuItem value={2}>ŸÖÿπŸÑŸÇÿ©</MenuItem>
              <MenuItem value={3}>ŸÖŸÑÿ∫Ÿäÿ©</MenuItem>
            </Select>
          </FormControl>

          <Button
            startIcon={<ClearIcon />}
            onClick={clearFilters}
            variant="outlined"
            size="small"
          >
            ŸÖÿ≥ÿ≠ ÿßŸÑŸÅŸÑÿßÿ™ÿ±
          </Button>
        </Box>

        {/* ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿÆÿ∑ÿ£ */}
        {error && (
          <Alert 
            severity="error" 
            className={styles.errorAlert}
            onClose={() => setError(null)}
          >
            {error}
          </Alert>
        )}

        {/* ÿßŸÑÿ¨ÿØŸàŸÑ */}
        <TableContainer component={Paper} className={styles.tableContainer}>
          <Table stickyHeader>
            <TableHead>
              <TableRow>
                <TableCell>ŸÉŸàÿØ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</TableCell>
                <TableCell>ÿßŸÑŸÜŸàÿπ</TableCell>
                <TableCell>ÿßŸÑÿ≠ÿßŸÑÿ©</TableCell>
                <TableCell>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°</TableCell>
                <TableCell>ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´</TableCell>
                <TableCell>ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</TableCell>
                <TableCell>ÿßŸÑÿπŸÖŸäŸÑ</TableCell>
                <TableCell>ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©</TableCell>
                <TableCell align="center">ÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {loading ? (
                <TableRow>
                  <TableCell colSpan={9} align="center" className={styles.loadingCell}>
                    <CircularProgress size={40} />
                    <Typography variant="body2" sx={{ mt: 1 }}>
                      ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...
                    </Typography>
                  </TableCell>
                </TableRow>
              ) : filteredInvoices.length === 0 ? (
                <TableRow>
                  <TableCell colSpan={9} align="center" className={styles.emptyCell}>
                    <Typography variant="body1" color="text.secondary">
                      ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ∑ŸÑÿ®ÿßÿ™ ŸÑŸÑÿπÿ±ÿ∂
                    </Typography>
                  </TableCell>
                </TableRow>
              ) : (
                filteredInvoices.map((invoice) => {
                  const additionalInfo = getAdditionalInfo(invoice);
                  const isEditable = canEditInvoice(invoice);
                  
                  return (
                    <TableRow key={invoice.id} className={styles.tableRow}>
                      <TableCell>
                        <Typography variant="body2" className={styles.invoiceId}>
                          {invoice.id.substring(0, 8)}...
                        </Typography>
                      </TableCell>
                      
                      <TableCell>
                        <Chip
                          label={getInvoiceTypeText(invoice.invoiceType)}
                          size="small"
                          color={invoice.invoiceType === 1 ? 'success' : 
                                 invoice.invoiceType === 2 ? 'primary' : 
                                 invoice.invoiceType === 3 ? 'warning' : 'info'}
                        />
                      </TableCell>
                      
                      <TableCell>
                        <Chip
                          label={getInvoiceStatusText(invoice.invoiceStatus)}
                          size="small"
                          color={invoice.invoiceStatus === 1 ? 'success' : 
                                 invoice.invoiceStatus === 2 ? 'warning' : 'error'}
                        />
                      </TableCell>
                      
                      <TableCell>
                        <Typography variant="body2">
                          {formatDate(invoice.createdAt)}
                        </Typography>
                      </TableCell>
                      
                      <TableCell>
                        <Typography variant="body2">
                          {formatDate(invoice.completedAt)}
                        </Typography>
                      </TableCell>
                      
                      <TableCell>
                        <Typography variant="body2" className={styles.totalAmount}>
                          {invoice.totalAfterTaxAndService.toFixed(2)} ÿ¨ŸÜŸäŸá
                        </Typography>
                      </TableCell>
                      
                      <TableCell>
                        <Typography variant="body2">
                          {invoice.customerName || '--'}
                        </Typography>
                      </TableCell>
                      
                      <TableCell>
                        {additionalInfo ? (
                          <Box>
                            <Typography variant="caption" color="text.secondary">
                              {additionalInfo.label}:
                            </Typography>
                            <Typography variant="body2">
                              {additionalInfo.value}
                            </Typography>
                          </Box>
                        ) : (
                          '--'
                        )}
                      </TableCell>
                      
                      <TableCell align="center">
                        <IconButton
                          size="small"
                          onClick={() => handleViewOrder(invoice)}
                          className={`${styles.viewButton} ${!isEditable ? styles.disabledViewButton : ''}`}
                          title={isEditable ? "ÿπÿ±ÿ∂ Ÿàÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ∑ŸÑÿ®" : "ÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ® (ÿ∫Ÿäÿ± ŸÇÿßÿ®ŸÑ ŸÑŸÑÿ™ÿπÿØŸäŸÑ)"}
                          disabled={loading}
                        >
                          <VisibilityIcon />
                        </IconButton>
                      </TableCell>
                    </TableRow>
                  );
                })
              )}
            </TableBody>
          </Table>
        </TableContainer>

        {/* ÿπÿ±ÿ∂ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ */}
        {totalPages > 1 && (
          <Box className={styles.paginationContainer}>
            <Pagination
              count={totalPages}
              page={page}
              onChange={handlePageChange}
              color="primary"
              showFirstButton
              showLastButton
              disabled={loading}
            />
          </Box>
        )}
      </DialogContent>

      <DialogActions className={styles.dialogActions}>
        <Button onClick={onClose} variant="outlined">
          ÿ•ÿ∫ŸÑÿßŸÇ
        </Button>
      </DialogActions>
    </Dialog>
  );
};

export default TodayOrdersPopup;

===== src/Pages/pos/newSales/components/ui/Button.tsx =====
import React from 'react';

interface ButtonProps {
  children: React.ReactNode;
  onClick?: () => void;
  variant?: 'primary' | 'secondary' | 'outline';
  size?: 'small' | 'medium' | 'large';
  disabled?: boolean;
  type?: 'button' | 'submit' | 'reset';
  fullWidth?: boolean;
  className?: string;
}

const Button: React.FC<ButtonProps> = ({ 
  children, 
  onClick, 
  variant = 'primary', 
  size = 'medium', 
  disabled = false, 
  type = 'button',
  fullWidth = false,
  className = '',
  ...props 
}) => {
  const baseClasses = 'font-nunito font-medium rounded transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2';
  
  const variants = {
    primary: 'bg-primary-blue text-white hover:bg-blue-700 disabled:bg-gray-400',
    secondary: 'bg-gray-200 text-gray-800 hover:bg-gray-300 disabled:bg-gray-100',
    outline: 'border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:border-gray-200 disabled:text-gray-400',
  };
  
  const sizes = {
    small: 'px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm',
    medium: 'px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base',
    large: 'px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg',
  };
  
  const buttonClasses = `
    ${baseClasses} 
    ${variants[variant]} 
    ${sizes[size]} 
    ${fullWidth ? 'w-full' : ''} 
    ${disabled ? 'cursor-not-allowed' : 'cursor-pointer'}
    ${className}
  `.trim().replace(/\s+/g, ' ');
  
  return (
    <button
      type={type}
      onClick={onClick}
      disabled={disabled}
      className={buttonClasses}
      {...props}
    >
      {children}
    </button>
  );
};

export default Button;
===== src/Pages/pos/newSales/components/ui/ChipView.tsx =====
import React, { useState } from 'react';

interface ChipItemProps {
  children: React.ReactNode;
  leftImage?: {
    src: string;
    width: number;
    height: number;
  };
  selected?: boolean;
  onClick?: () => void;
  variant?: 'extra' | 'without' | 'offer';
  className?: string;
}

interface ChipViewProps {
  children: React.ReactNode;
  className?: string;
}

const ChipItem: React.FC<ChipItemProps> = ({
  children,
  leftImage,
  selected = false,
  onClick,
  variant = 'extra',
  className = ''
}) => {
  const variants = {
    extra: 'bg-primary-green text-white',
    without: 'bg-primary-red text-white',
    offer: 'bg-primary-orange text-white'
  };

  return (
    <button
      type="button"
      onClick={onClick}
      className={`
        inline-flex items-center gap-2 px-4 py-2 sm:px-6 sm:py-3 rounded-lg font-nunito text-sm sm:text-base font-medium
        transition-all duration-200 hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-current
        ${variants[variant]}
        ${selected ? 'ring-2 ring-offset-2 ring-current' : ''}
        ${className}
      `.trim().replace(/\s+/g, ' ')}
    >
      {leftImage && (
        <img
          src={leftImage.src}
          alt=""
          className="w-4 h-4 sm:w-6 sm:h-6"
        />
      )}
      {children}
    </button>
  );
};

const ChipView: React.FC<ChipViewProps> = ({ children, className = '' }) => {
  return (
    <div className={`flex flex-wrap gap-2 sm:gap-4 ${className}`}>
      {children}
    </div>
  );
};

export { ChipView, ChipItem };
export default ChipView;
===== src/Pages/pos/newSales/components/ui/Dropdown.tsx =====
import React, { useState } from 'react';

interface DropdownProps {
  placeholder?: string;
  options?: string[];
  value?: string;
  onChange?: (value: string) => void;
  rightImage?: {
    src: string;
    width: number;
    height: number;
  };
  className?: string;
}

const Dropdown: React.FC<DropdownProps> = ({
  placeholder = 'Select option',
  options = ['Option 1', 'Option 2', 'Option 3'],
  value,
  onChange,
  rightImage,
  className = ''
}) => {
  const [isOpen, setIsOpen] = useState(false);
  const [selectedValue, setSelectedValue] = useState(value || placeholder);

  const handleSelect = (option: string) => {
    setSelectedValue(option);
    setIsOpen(false);
    if (onChange) {
      onChange(option);
    }
  };

  return (
    <div className={`relative ${className}`}>
      <button
        type="button"
        onClick={() => setIsOpen(!isOpen)}
        className="w-full flex items-center justify-between gap-2 px-3 py-1 text-left rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-blue focus:border-primary-blue transition-colors duration-200"
      >
        <span className="font-nunito text-sm sm:text-base text-primary truncate">
          {selectedValue}
        </span>
        {rightImage && (
          <img
            src={rightImage.src}
            alt="dropdown arrow"
            className={`w-4 h-4 sm:w-6 sm:h-6 transition-transform duration-200 ${
              isOpen ? 'rotate-180' : ''
            }`}
          />
        )}
      </button>

      {isOpen && (
        <div className="absolute top-full left-0 right-0 mt-1 bg-card border border-gray-300 rounded-md shadow-lg z-50 max-h-60 overflow-auto">
          {options.map((option, index) => (
            <button
              key={index}
              type="button"
              onClick={() => handleSelect(option)}
              className="w-full px-3 py-2 text-left font-nunito text-sm sm:text-base text-primary hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition-colors duration-200"
            >
              {option}
            </button>
          ))}
        </div>
      )}
    </div>
  );
};

export default Dropdown;
===== src/Pages/pos/newSales/components/ui/EditText.tsx =====
import React, { useState } from 'react';

interface EditTextProps {
  placeholder?: string;
  value?: string;
  onChange?: (value: string) => void;
  type?: 'text' | 'number' | 'email' | 'password';
  disabled?: boolean;
  required?: boolean;
  className?: string;
  variant?: 'primary' | 'secondary';
  style?: React.CSSProperties;
}

const EditText: React.FC<EditTextProps> = ({
  placeholder = '',
  value,
  onChange,
  type = 'text',
  disabled = false,
  required = false,
  className = '',
  variant = 'primary'
}) => {
  const [inputValue, setInputValue] = useState(value || '');

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const newValue = e.target.value;
    setInputValue(newValue);
    if (onChange) {
      onChange(newValue);
    }
  };

  const variants = {
    primary: 'bg-primary-blue text-white placeholder-white/70 border-primary-blue focus:ring-primary-blue',
    secondary: 'bg-card text-primary placeholder-secondary border-gray-300 focus:ring-primary-blue focus:border-primary-blue'
  };

  return (
    <input
      type={type}
      value={inputValue}
      onChange={handleChange}
      placeholder={placeholder}
      disabled={disabled}
      required={required}
      className={`
        w-full px-3 py-2 sm:px-4 sm:py-3 font-nunito text-sm sm:text-base font-bold
        border rounded-lg transition-colors duration-200
        focus:outline-none  focus:ring-offset-2
        disabled:opacity-50 disabled:cursor-not-allowed
        ${variants[variant]}
        ${className}
      `.trim().replace(/\s+/g, ' ')}
    />
  );
};

export default EditText;
===== src/Pages/pos/newSales/components/ui/SearchView.tsx =====
import React, { useState } from 'react';

interface SearchViewProps {
  placeholder?: string;
  value?: string;
  onChange?: (value: string) => void;
  onSearch?: (value: string) => void;
  leftImage?: {
    src: string;
    width: number;
    height: number;
  };
  className?: string;
}

const SearchView: React.FC<SearchViewProps> = ({
  placeholder = 'Search...',
  value,
  onChange,
  onSearch,
  leftImage,
  className = ''
}) => {
  const [searchValue, setSearchValue] = useState(value || '');

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const newValue = e.target.value;
    setSearchValue(newValue);
    if (onChange) {
      onChange(newValue);
    }
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (onSearch) {
      onSearch(searchValue);
    }
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && onSearch) {
      onSearch(searchValue);
    }
  };

  return (
    <form onSubmit={handleSubmit} className={`relative ${className}`}>
      <div className="relative">
        {leftImage && (
          <div className="absolute left-3 top-1/2 transform -translate-y-1/2">
            <img
              src={leftImage.src}
              alt="search"
              className="w-4 h-4 sm:w-5 sm:h-5 text-secondary"
            />
          </div>
        )}
        <input
          type="text"
          value={searchValue}
          onChange={handleChange}
          onKeyPress={handleKeyPress}
          placeholder={placeholder}
          className={`
            w-full px-3 py-2 sm:px-4 sm:py-3 font-nunito text-sm sm:text-base
            bg-card border border-gray-300 rounded-lg
            text-primary placeholder-secondary
            focus:outline-none focus:ring-2 focus:ring-primary-blue focus:border-primary-blue
            transition-colors duration-200
            ${leftImage ? 'pl-10 sm:pl-12' : ''}
          `.trim().replace(/\s+/g, ' ')}
        />
      </div>
    </form>
  );
};

export default SearchView;
===== src/Pages/pos/newSales/hooks/useDataManager.tsx =====
// src/Pages/pos/newSales/hooks/useDataManager.tsx
import { useState, useEffect, useCallback } from 'react';
import { PosProduct, CategoryItem } from '../types/PosSystem';
import * as posService from '../../../../services/posService';

interface DataState {
  mainProducts: PosProduct[];
  mainCategories: CategoryItem[];
  additionProducts: PosProduct[];
  additionCategories: CategoryItem[];
  normalModeProducts: PosProduct[];
  normalModeCategories: CategoryItem[];
  loading: boolean;
  error: string | null;
  defaultCategoryId: string | null;
}

export const useDataManager = () => {
  const [dataState, setDataState] = useState<DataState>({
    mainProducts: [],
    mainCategories: [],
    additionProducts: [],
    additionCategories: [],
    normalModeProducts: [],
    normalModeCategories: [],
    loading: true,
    error: null,
    defaultCategoryId: null
  });

  const loadAllData = useCallback(async () => {
    try {
      setDataState(prev => ({ ...prev, loading: true, error: null }));

      // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ posService (ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ productType)
      const [mainProducts, additionProducts] = await Promise.all([
        posService.getAllPosProducts(),
        posService.getAdditionProducts()
      ]);

      // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ•ŸÑŸâ ÿßŸÑŸÜŸàÿπ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®
      const convertedMainProducts: PosProduct[] = mainProducts.map(product => ({
        ...product,
        productType: product.productType || 1 // ÿ∂ŸÖÿßŸÜ Ÿàÿ¨ŸàÿØ productType
      }));

      const convertedAdditionProducts: PosProduct[] = additionProducts.map(product => ({
        ...product,
        productType: product.productType || 3 // ÿ∂ŸÖÿßŸÜ Ÿàÿ¨ŸàÿØ productType
      }));

      const [mainCategories, additionCategories] = await Promise.all([
        posService.getAllCategories(mainProducts),
        posService.getCategoriesByProductType(3)
      ]);

      // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÅÿ¶ÿßÿ™ ÿ•ŸÑŸâ ÿßŸÑŸÜŸàÿπ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®
      const convertedMainCategories: CategoryItem[] = mainCategories.map(category => ({
        ...category,
        products: category.products?.map(product => ({
          ...product,
          productType: product.productType || 1
        }))
      }));

      const convertedAdditionCategories: CategoryItem[] = additionCategories.map(category => ({
        ...category,
        products: category.products?.map(product => ({
          ...product,
          productType: product.productType || 3
        }))
      }));

      // ÿØŸÖÿ¨ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÑŸÑÿπÿ±ÿ∂ ÿßŸÑÿπÿßÿØŸä
      const normalModeProducts = [...convertedMainProducts, ...convertedAdditionProducts];
      const normalModeCategories = await posService.getAllCategories([...mainProducts, ...additionProducts]);
      
      const convertedNormalModeCategories: CategoryItem[] = normalModeCategories.map(category => ({
        ...category,
        products: category.products?.map(product => ({
          ...product,
          productType: product.productType || 1
        }))
      }));

      const rootMainCategories = convertedNormalModeCategories.filter(cat => !cat.parentId);
      const defaultCategoryId = rootMainCategories.length > 0 ? rootMainCategories[0].id : null;

      setDataState({
        mainProducts: convertedMainProducts,
        mainCategories: convertedMainCategories,
        additionProducts: convertedAdditionProducts,
        additionCategories: convertedAdditionCategories,
        normalModeProducts,
        normalModeCategories: convertedNormalModeCategories,
        loading: false,
        error: null,
        defaultCategoryId
      });

    } catch (error) {
      console.error('Error loading data:', error);
      setDataState(prev => ({
        ...prev,
        loading: false,
        error: 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™'
      }));
    }
  }, []);

  useEffect(() => {
    loadAllData();
  }, [loadAllData]);

  // ÿØÿßŸÑÿ© ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖŸÅŸÑÿ™ÿ±ÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸàÿ∂ÿπ
  const getProducts = useCallback((isAdditionMode: boolean): PosProduct[] => {
    if (isAdditionMode) {
      return dataState.additionProducts.filter(product => product.productType === 3);
    }
    return dataState.normalModeProducts;
  }, [dataState.additionProducts, dataState.normalModeProducts]);

  // ÿØÿßŸÑÿ© ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑŸÅÿ¶ÿßÿ™ ÿßŸÑŸÖŸÅŸÑÿ™ÿ±ÿ© ÿ≠ÿ≥ÿ® ÿßŸÑŸàÿ∂ÿπ
  const getCategories = useCallback((isAdditionMode: boolean): CategoryItem[] => {
    if (isAdditionMode) {
      return dataState.additionCategories.filter(category => 
        category.products && category.products.some(product => product.productType === 3)
      );
    }
    return dataState.normalModeCategories;
  }, [dataState.additionCategories, dataState.normalModeCategories]);

  // ÿ•ÿ∂ÿßŸÅÿ© ÿØŸàÿßŸÑ ŸÖÿ≥ÿßÿπÿØÿ© ŸÖÿ™ŸàÿßŸÅŸÇÿ© ŸÖÿπ posService

const searchProducts = useCallback((products: PosProduct[], query: string): PosProduct[] => {
  if (!query.trim()) return [];
  
  const searchTerm = query.toLowerCase();
  return products.filter(product => 
    product.nameArabic.toLowerCase().includes(searchTerm) ||
    product.name.toLowerCase().includes(searchTerm)
  );
}, []);

  const getProductsByScreenId = useCallback((products: PosProduct[], screenId: string): PosProduct[] => {
    return products.filter(product => product.categoryId === screenId);
  }, []);

  const hasProductOptions = useCallback((product: PosProduct): boolean => {
    return !!(product.productOptionGroups && product.productOptionGroups.length > 0);
  }, []);

  return {
    ...dataState,
    loadAllData,
    getProducts,
    getCategories,
    // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿØŸàÿßŸÑ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©
    searchProducts,
    getProductsByScreenId,
    hasProductOptions,
    // ŸÖÿ§ÿ¥ÿ±ÿßÿ™ ÿßŸÑÿ≠ÿßŸÑÿ©
    isLoading: dataState.loading,
    hasError: !!dataState.error,
    isDataReady: !dataState.loading && !dataState.error && dataState.normalModeProducts.length > 0
  };
};

===== src/Pages/pos/newSales/hooks/useInvoiceManager.tsx =====
// File: src/Pages/pos/newSales/hooks/useInvoiceManager.tsx
import { useState } from 'react';
import { OrderSummary, OrderItem } from '../types/PosSystem';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import { DeliveryCompany } from 'src/utils/api/pagesApi/deliveryCompaniesApi';
import { TableSelection } from '../types/TableSystem';
import * as invoicesApi from '../../../../utils/api/pagesApi/invoicesApi';
import { useError } from '../../../../contexts/ErrorContext';

interface PaymentMethodData {
  method: string;
  amount: number;
  isSelected: boolean;
}

// Interface ŸÖÿ≠ÿ≥ŸÜ ŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ©
interface ExistingInvoiceData {
  originalInvoice: invoicesApi.Invoice;
}

export const useInvoiceManager = () => {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [existingInvoiceData, setExistingInvoiceData] = useState<ExistingInvoiceData | null>(null);
  const { showSuccess, showError } = useError();

  const getInvoiceType = (orderType: string): number => {
    switch (orderType) {
      case 'Takeaway': return 1;
      case 'Dine-in': return 2;
      case 'Delivery': return 3;
      case 'Pickup': return 4;
      default: return 1;
    }
  };

  const getWareHouseId = (): string => {
    return localStorage.getItem('warehouse_id') || 'e81866c0-791d-449f-bc04-c5d65bb3820c';
  };

  const getRawBranchId = (): string => {
    return localStorage.getItem('branch_id') || 'branch_1';
  };

  // ÿØÿßŸÑÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ©
  const loadExistingInvoice = async (invoiceId: string) => {
    try {
      console.log('üîÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖŸàÿ¨ŸàÿØÿ©:', invoiceId);
      const invoiceData = await invoicesApi.getInvoiceById(invoiceId);
      
      setExistingInvoiceData({
        originalInvoice: invoiceData
      });

      console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖŸàÿ¨ŸàÿØÿ© ÿ®ŸÜÿ¨ÿßÿ≠');
      console.log(`üìä Items ŸÖŸàÿ¨ŸàÿØÿ©: ${invoiceData.items?.length || 0}`);
      console.log(`üí≥ Payments ŸÖŸàÿ¨ŸàÿØÿ©: ${invoiceData.payments?.length || 0}`);
      
      return invoiceData;
    } catch (error) {
      console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖŸàÿ¨ŸàÿØÿ©:', error);
      throw error;
    }
  };

  // ÿØÿßŸÑÿ© ÿ™ÿ≠ŸàŸäŸÑ ÿπŸÜÿµÿ± ÿßŸÑÿ∑ŸÑÿ® ÿ•ŸÑŸâ ÿπŸÜÿµÿ± ŸÅÿßÿ™Ÿàÿ±ÿ©
  const convertOrderItemToInvoiceItem = (
    item: OrderItem, 
    existingItem?: invoicesApi.InvoiceItem
  ): invoicesApi.CreateInvoiceItem => {
    const components: any[] = [];

    // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑŸÄ subItems
    if (item.subItems && item.subItems.length > 0) {
      item.subItems.forEach(subItem => {
        components.push({
          id: subItem.id,
          name: subItem.name,
          quantity: subItem.quantity,
          extraPrice: subItem.type === 'without' ? 0 : subItem.price,
          price: subItem.price,
          type: subItem.type,
          groupId: subItem.groupId,
          isRequired: subItem.isRequired || false,
          isCommentOnly: false,
          useOriginalPrice: false,
          sortOrder: 0,
          WareHouseId: getWareHouseId(),
          ComponentName: subItem.name,
          ProductComponentId: subItem.productId || item.product.id
        });
      });
    }

    // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑŸÄ selectedOptions
    if (item.selectedOptions && item.selectedOptions.length > 0) {
      item.selectedOptions.forEach(option => {
        components.push({
          id: option.itemId,
          name: option.itemName,
          quantity: option.quantity,
          extraPrice: option.extraPrice,
          price: option.extraPrice,
          type: 'option',
          groupId: option.groupId,
          isCommentOnly: option.isCommentOnly,
          isRequired: false,
          useOriginalPrice: false,
          sortOrder: 0,
          WareHouseId: getWareHouseId(),
          ComponentName: option.itemName,
          ProductComponentId: item.product.id
        });
      });
    }

    const invoiceItem: invoicesApi.CreateInvoiceItem = {
      ProductId: item.product.id,
      ProductPriceId: item.selectedPrice.id,
      Barcode: item.selectedPrice.barcode || '1234567890123',
      UnitId: null,
      PosPriceName: item.selectedPrice.nameArabic,
      UnitFactor: 1,
      Qty: item.quantity,
      UnitPrice: item.selectedPrice.price,
      UnitCost: 45,
      ItemDiscountPercentage: item.discountPercentage || 0,
      ItemTaxPercentage: 14,
      ServicePercentage: 10,
      WareHouseId: getWareHouseId(),
      Components: components
    };

    // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÄ id ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿπŸÜÿµÿ± ŸÖŸàÿ¨ŸàÿØ ŸÖÿ≥ÿ®ŸÇÿßŸã
    if (existingItem) {
      (invoiceItem as any).id = existingItem.id;
      console.log(`üîÑ ÿ™ÿ≠ÿØŸäÿ´ item ŸÖŸàÿ¨ŸàÿØ: ${item.product.id} -> ID: ${existingItem.id}`);
    } else {
      console.log(`‚ú® ÿ•ÿ∂ÿßŸÅÿ© item ÿ¨ÿØŸäÿØ: ${item.product.id}`);
    }

    return invoiceItem;
  };

  // ÿØÿßŸÑÿ© ÿ™ÿ≠ŸàŸäŸÑ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ
  const convertPaymentsToInvoicePayments = (
    payments: PaymentMethodData[],
    originalPayments?: invoicesApi.InvoicePayment[]
  ): invoicesApi.CreateInvoicePayment[] => {
    if (!payments || payments.length === 0) {
      return [];
    }
    
    return payments
      .filter(payment => payment.isSelected && payment.amount > 0)
      .map(payment => {
        const paymentMethodId = payment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                              payment.method.toLowerCase().includes('cash') ? 'cash' : 
                              payment.method.toLowerCase();

        // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ© ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ©
        const existingPayment = originalPayments?.find(p => p.paymentMethodId === paymentMethodId);

        const invoicePayment: invoicesApi.CreateInvoicePayment = {
          Amount: payment.amount,
          PaymentMethodId: paymentMethodId
        };

        if (existingPayment) {
          (invoicePayment as any).id = existingPayment.id;
          console.log(`üîÑ ÿ™ÿ≠ÿØŸäÿ´ payment ŸÖŸàÿ¨ŸàÿØ: ${paymentMethodId} -> ID: ${existingPayment.id}`);
        } else {
          console.log(`‚ú® ÿ•ÿ∂ÿßŸÅÿ© payment ÿ¨ÿØŸäÿØ: ${paymentMethodId}`);
        }

        return invoicePayment;
      });
  };

  // ÿØÿßŸÑÿ© ÿ•ŸÜÿ¥ÿßÿ° ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ¨ÿØŸäÿØÿ©
  const createInvoice = async (
    orderSummary: OrderSummary,
    orderType: string,
    payments: PaymentMethodData[],
    invoiceStatus: number,
    selectedCustomer?: Customer | null,
    selectedAddress?: CustomerAddress | null,
    selectedDeliveryCompany?: DeliveryCompany | null,
    selectedTable?: TableSelection | null,
    servicePercentage: number = 0,
    taxPercentage: number = 0,
    discountPercentage: number = 0,
    notes?: string
  ): Promise<invoicesApi.InvoiceResponse> => {
    setIsSubmitting(true);

    try {
      const invoiceData: invoicesApi.CreateInvoiceRequest = {
        InvoiceType: getInvoiceType(orderType),
        InvoiceStatus: invoiceStatus,
        WareHouseId: getWareHouseId(),
        RawBranchId: getRawBranchId(),
        CustomerId: selectedCustomer?.id || null,
        TableId: selectedTable?.table.id || null,
        HallCaptainId: null,
        DeliveryCompanyId: selectedDeliveryCompany?.id || null,
        DeliveryAgentId: null,
        TaxPercentage: taxPercentage,
        ServicePercentage: servicePercentage,
        HeaderDiscountPercentage: discountPercentage,
        PreparedAt: new Date().toISOString(),
        CompletedAt: new Date().toISOString(),
        Notes: notes || `ÿ∑ŸÑÿ® ${orderType}`,
        Items: orderSummary.items.map(item => convertOrderItemToInvoiceItem(item)),
        Payments: convertPaymentsToInvoicePayments(payments)
      };

      const result = await invoicesApi.addInvoice(invoiceData);
      showSuccess(`ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ±ŸÇŸÖ ${result.invoiceNumber} ÿ®ŸÜÿ¨ÿßÿ≠`);
      return result;
    } catch (error: any) {
      console.error('Error creating invoice:', error);
      let errorMessage = 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©';

      if (error.isApiValidationError && error.errors) {
        errorMessage = error.errors.map((err: any) => err.errorMessage).join(', ');
      } else if (error.message) {
        errorMessage = error.message;
      }

      showError(errorMessage);
      throw error;
    } finally {
      setIsSubmitting(false);
    }
  };

  // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿπŸÜÿµÿ± ŸÖÿ∑ÿßÿ®ŸÇ ŸÅŸä ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ©
  const findMatchingOriginalItem = (
    orderItem: OrderItem,
    originalItems: invoicesApi.InvoiceItem[]
  ): invoicesApi.InvoiceItem | undefined => {
    return originalItems.find(originalItem => 
      originalItem.productId === orderItem.product.id && 
      originalItem.productPriceId === orderItem.selectedPrice.id
    );
  };

  // ÿØÿßŸÑÿ© ÿ™ÿ≠ÿØŸäÿ´ ŸÅÿßÿ™Ÿàÿ±ÿ© ŸÖŸàÿ¨ŸàÿØÿ© - ÿßŸÑÿ≠ŸÑ ÿßŸÑÿ¨ÿ∞ÿ±Ÿä
  const updateInvoice = async (
    invoiceId: string,
    orderSummary: OrderSummary,
    orderType: string,
    payments: PaymentMethodData[],
    invoiceStatus: number,
    selectedCustomer?: Customer | null,
    selectedAddress?: CustomerAddress | null,
    selectedDeliveryCompany?: DeliveryCompany | null,
    selectedTable?: TableSelection | null,
    servicePercentage: number = 0,
    taxPercentage: number = 0,
    discountPercentage: number = 0,
    notes?: string
  ): Promise<invoicesApi.InvoiceResponse> => {
    setIsSubmitting(true);

    try {
      console.log('üîÑ ÿ®ÿØÿ° ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©:', invoiceId);
      
      // ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ© ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ŸÉŸÜ ŸÖÿ≠ŸÖŸÑÿ©
      let originalInvoice = existingInvoiceData?.originalInvoice;
      if (!originalInvoice || originalInvoice.id !== invoiceId) {
        originalInvoice = await loadExistingInvoice(invoiceId);
      }

      // ‚úÖ ÿ®ŸÜÿßÿ° ŸÇÿßÿ¶ŸÖÿ© Items ÿ¥ÿßŸÖŸÑÿ© - ÿßŸÑÿ≠ŸÑ ÿßŸÑÿµÿ≠Ÿäÿ≠
      const allItems: invoicesApi.CreateInvoiceItem[] = [];
      
      // ÿÆÿ±Ÿäÿ∑ÿ© ŸÑÿ™ÿ™ÿ®ÿπ ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ© ŸÖŸÜ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
      const processedItemsKeys = new Set<string>();

      // 1. ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿπŸÜÿßÿµÿ± ŸÖŸÜ ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
      orderSummary.items.forEach(currentItem => {
        const itemKey = `${currentItem.product.id}-${currentItem.selectedPrice.id}`;
        processedItemsKeys.add(itemKey);
        
        // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿπŸÜÿµÿ± ŸÅŸä ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ©
        const matchingOriginalItem = findMatchingOriginalItem(currentItem, originalInvoice.items || []);
        
        // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿπŸÜÿµÿ± ŸÖÿπ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿßŸÑŸÄ ID ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖŸàÿ¨ŸàÿØ
        const invoiceItem = convertOrderItemToInvoiceItem(currentItem, matchingOriginalItem);
        allItems.push(invoiceItem);
      });

      // 2. ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑÿ£ÿµŸÑŸäÿ© ÿßŸÑÿ™Ÿä ŸÑŸÖ ÿ™ÿπÿØ ŸÖŸàÿ¨ŸàÿØÿ© ŸÅŸä ÿßŸÑŸàÿßÿ¨Ÿáÿ©
      // Ÿáÿ∞ÿß ŸÖŸáŸÖ ŸÑŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑÿ™Ÿä ŸÑŸÖ Ÿäÿ™ŸÖ ÿ≠ÿ∞ŸÅŸáÿß ÿµÿ±ÿßÿ≠ÿ©
      originalInvoice.items?.forEach(originalItem => {
        const itemKey = `${originalItem.productId}-${originalItem.productPriceId}`;
        
        // ÿ•ÿ∞ÿß ŸÑŸÖ Ÿäÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© Ÿáÿ∞ÿß ÿßŸÑÿπŸÜÿµÿ± ŸÖŸÜ ÿßŸÑŸàÿßÿ¨Ÿáÿ©ÿå ÿßÿ≠ÿ™ŸÅÿ∏ ÿ®Ÿá
        if (!processedItemsKeys.has(itemKey)) {
          const preservedItem: invoicesApi.CreateInvoiceItem = {
            id: originalItem.id, // ‚úÖ ÿßŸÑŸÄ ID ÿßŸÑÿ£ÿµŸÑŸä ŸÖŸáŸÖ ÿ¨ÿØÿßŸã
            ProductId: originalItem.productId,
            ProductPriceId: originalItem.productPriceId,
            Barcode: originalItem.barcode,
            UnitId: originalItem.unitId,
            PosPriceName: originalItem.posPriceName,
            UnitFactor: originalItem.unitFactor,
            Qty: originalItem.qty,
            UnitPrice: originalItem.unitPrice,
            UnitCost: originalItem.unitCost,
            ItemDiscountPercentage: originalItem.itemDiscountPercentage,
            ItemTaxPercentage: originalItem.itemTaxPercentage,
            ServicePercentage: originalItem.servicePercentage,
            WareHouseId: originalItem.wareHouseId,
            Components: originalItem.components || []
          };
          allItems.push(preservedItem);
          console.log(`üîí ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿπŸÜÿµÿ± ÿ£ÿµŸÑŸä: ${originalItem.id} (${originalItem.posPriceName})`);
        }
      });

      // ‚úÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ÿ®ŸÜŸÅÿ≥ ÿßŸÑÿ∑ÿ±ŸäŸÇÿ©
      const allPayments = convertPaymentsToInvoicePayments(payments, originalInvoice.payments || []);

      // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ÿßŸÑÿ£ÿµŸÑŸäÿ© ÿßŸÑÿ™Ÿä ŸÑŸÖ ÿ™ÿπÿØ ŸÖŸàÿ¨ŸàÿØÿ© ŸÅŸä ÿßŸÑŸàÿßÿ¨Ÿáÿ©
      originalInvoice.payments?.forEach(originalPayment => {
        const existsInCurrentPayments = payments?.some(currentPayment => {
          const currentMethodId = currentPayment.method.toLowerCase().includes('ŸÉÿßÿ¥') || 
                                 currentPayment.method.toLowerCase().includes('cash') ? 'cash' : 
                                 currentPayment.method.toLowerCase();
          return currentMethodId === originalPayment.paymentMethodId && 
                 currentPayment.isSelected && 
                 currentPayment.amount > 0;
        });

        if (!existsInCurrentPayments) {
          const preservedPayment: invoicesApi.CreateInvoicePayment = {
            id: originalPayment.id,
            Amount: originalPayment.amount,
            PaymentMethodId: originalPayment.paymentMethodId
          };
          allPayments.push(preservedPayment);
          console.log(`üîí ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿØŸÅÿπÿ© ÿ£ÿµŸÑŸäÿ©: ${originalPayment.id} (${originalPayment.paymentMethodId})`);
        }
      });

      // ‚úÖ ÿ®ŸÜÿßÿ° ÿ∑ŸÑÿ® ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¥ÿßŸÖŸÑ
      const updateData: invoicesApi.UpdateInvoiceRequest = {
        id: invoiceId,
        backInvoiceCode: originalInvoice.backInvoiceCode,
        androidInvoiceCode: originalInvoice.androidInvoiceCode,
        InvoiceType: getInvoiceType(orderType),
        InvoiceStatus: invoiceStatus,
        WareHouseId: originalInvoice.wareHouseId,
        RawBranchId: originalInvoice.rawBranchId,
        CustomerId: selectedCustomer?.id || originalInvoice.customerId,
        TableId: selectedTable?.table.id || originalInvoice.tableId,
        HallCaptainId: originalInvoice.hallCaptainId,
        DeliveryCompanyId: selectedDeliveryCompany?.id || originalInvoice.deliveryCompanyId,
        DeliveryAgentId: originalInvoice.deliveryAgentId,
        CustomerName: selectedCustomer?.name || originalInvoice.customerName,
        CustomerAddress: selectedAddress?.addressLine || originalInvoice.customerAddress,
        TableGuestsCount: originalInvoice.tableGuestsCount,
        ShiftCode: originalInvoice.shiftCode,
        DayCode: originalInvoice.dayCode,
        ReturnShiftCode: originalInvoice.returnShiftCode,
        TaxPercentage: taxPercentage,
        ServicePercentage: servicePercentage,
        HeaderDiscountPercentage: discountPercentage,
        ItemDiscountTotal: originalInvoice.itemDiscountTotal,
        HeaderDiscountValue: originalInvoice.headerDiscountValue,
        TaxAmount: originalInvoice.taxAmount,
        ServiceAmount: originalInvoice.serviceAmount,
        TotalBeforeDiscount: orderSummary.subtotal,
        TotalAfterDiscount: orderSummary.total,
        TotalAfterTaxAndService: orderSummary.total,
        TotalCost: originalInvoice.totalCost,
        GrossProfit: originalInvoice.grossProfit,
        CreatedAt: originalInvoice.createdAt,
        PrintedAt: originalInvoice.printedAt,
        PreparedAt: originalInvoice.preparedAt,
        CompletedAt: invoiceStatus === 3 ? new Date().toISOString() : originalInvoice.completedAt,
        CreatedByUserId: originalInvoice.createdByUserId,
        CancelledByUserId: originalInvoice.cancelledByUserId,
        CancelReason: originalInvoice.cancelReason,
        RefundedAmount: originalInvoice.refundedAmount,
        Notes: notes || originalInvoice.notes,
        Items: allItems,  // ‚úÖ ŸÉŸÑ ÿßŸÑÿπŸÜÿßÿµÿ± (ÿßŸÑÿ£ÿµŸÑŸäÿ© + ÿßŸÑÿ¨ÿØŸäÿØÿ© + ÿßŸÑŸÖÿ≠ÿØÿ´ÿ©)
        Payments: allPayments,  // ‚úÖ ŸÉŸÑ ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ (ÿßŸÑÿ£ÿµŸÑŸäÿ© + ÿßŸÑÿ¨ÿØŸäÿØÿ© + ÿßŸÑŸÖÿ≠ÿØÿ´ÿ©)
        BranchId: originalInvoice.branchId,
        CompanyID: originalInvoice.companyID,
        IsActive: originalInvoice.isActive
      };

      console.log('üì§ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¥ÿßŸÖŸÑÿ©:');
      console.log(`üìä ÿ•ÿ¨ŸÖÿßŸÑŸä Items: ${allItems.length}`);
      console.log(`   - ŸÖÿ≠ÿØÿ´ÿ©/ŸÖŸàÿ¨ŸàÿØÿ©: ${allItems.filter(i => (i as any).id).length}`);
      console.log(`   - ÿ¨ÿØŸäÿØÿ©: ${allItems.filter(i => !(i as any).id).length}`);
      console.log(`üí≥ ÿ•ÿ¨ŸÖÿßŸÑŸä Payments: ${allPayments.length}`);
      console.log(`   - ŸÖÿ≠ÿØÿ´ÿ©/ŸÖŸàÿ¨ŸàÿØÿ©: ${allPayments.filter(p => (p as any).id).length}`);
      console.log(`   - ÿ¨ÿØŸäÿØÿ©: ${allPayments.filter(p => !(p as any).id).length}`);
      
      const result = await invoicesApi.updateInvoice(updateData);
      console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠:', result);

      showSuccess(`ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ±ŸÇŸÖ ${result.invoiceNumber} ÿ®ŸÜÿ¨ÿßÿ≠`);
      return result;

    } catch (error: any) {
      console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©:', error);
      let errorMessage = 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©';

      if (error.isApiValidationError && error.errors) {
        errorMessage = error.errors.map((err: any) => err.errorMessage).join(', ');
      } else if (error.message) {
        errorMessage = error.message;
      }

      showError(errorMessage);
      throw error;
    } finally {
      setIsSubmitting(false);
    }
  };

  // ÿØÿßŸÑÿ© ŸÖŸàÿ≠ÿØÿ© ŸÑŸÑÿ•ŸÜÿ¥ÿßÿ° ŸàÿßŸÑÿ™ÿ≠ÿØŸäÿ´
  const saveInvoice = async (
    orderSummary: OrderSummary,
    orderType: string,
    payments: PaymentMethodData[],
    invoiceStatus: number,
    options: {
      isEditMode?: boolean;
      invoiceId?: string | null;
      selectedCustomer?: Customer | null;
      selectedAddress?: CustomerAddress | null;
      selectedDeliveryCompany?: DeliveryCompany | null;
      selectedTable?: TableSelection | null;
      servicePercentage?: number;
      taxPercentage?: number;
      discountPercentage?: number;
      notes?: string;
    } = {}
  ): Promise<invoicesApi.InvoiceResponse> => {
    const {
      isEditMode = false,
      invoiceId = null,
      selectedCustomer = null,
      selectedAddress = null,
      selectedDeliveryCompany = null,
      selectedTable = null,
      servicePercentage = 0,
      taxPercentage = 0,
      discountPercentage = 0,
      notes
    } = options;

    if (isEditMode && invoiceId) {
      return await updateInvoice(
        invoiceId,
        orderSummary,
        orderType,
        payments,
        invoiceStatus,
        selectedCustomer,
        selectedAddress,
        selectedDeliveryCompany,
        selectedTable,
        servicePercentage,
        taxPercentage,
        discountPercentage,
        notes
      );
    } else {
      return await createInvoice(
        orderSummary,
        orderType,
        payments,
        invoiceStatus,
        selectedCustomer,
        selectedAddress,
        selectedDeliveryCompany,
        selectedTable,
        servicePercentage,
        taxPercentage,
        discountPercentage,
        notes
      );
    }
  };

  // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿπŸÜÿØ ÿßŸÑÿßŸÜÿ™Ÿáÿßÿ°
  const clearExistingInvoiceData = () => {
    setExistingInvoiceData(null);
    console.log('üßπ ÿ™ŸÖ ÿ™ŸÜÿ∏ŸäŸÅ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖŸàÿ¨ŸàÿØÿ©');
  };

  return {
    createInvoice,
    updateInvoice,
    saveInvoice,
    loadExistingInvoice,
    clearExistingInvoiceData,
    isSubmitting
  };
};

===== src/Pages/pos/newSales/hooks/usePosPaymentMethods.tsx =====
// src/Pages/pos/newSales/hooks/usePosPaymentMethods.ts
import { useState, useEffect } from "react";
import * as posPaymentMethodsApi from 'src/utils/api/pagesApi/posPaymentMethodsApi';

export interface PaymentMethod {
  id: string;
  name: string;
  safeOrAccountID?: string | null;
  safeOrAccount?: any;
}

function isUUID(id: string) {
  // detect uuid-like
  return !!id && id.length > 20 && id.includes("-");
}

function isManualMethod(method: PaymentMethod) {
  // methods added by restaurant (id is uuid)
  return isUUID(method.id);
}
function isDefaultCash(method: PaymentMethod) {
  return method.id.toLowerCase() === 'cash' || method.name.toLowerCase() === 'ŸÉÿßÿ¥';
}
function isDefaultVisa(method: PaymentMethod) {
  return method.id.toLowerCase() === 'visa' || method.name.toLowerCase() === 'ŸÅŸäÿ≤ÿß';
}
function isDefaultBuiltIn(method: PaymentMethod) {
  // ids like visa/cash/instapay/wallet/isntapay/etc (not pure uuid)
  return !isManualMethod(method) && !isDefaultCash(method) && !isDefaultVisa(method);
}

function sortPaymentMethods(methods: PaymentMethod[]): PaymentMethod[] {
  const cash = methods.find(isDefaultCash);
  const visa = methods.find(isDefaultVisa);

  // Exclude cash/visa for building the rest
  const rest = methods.filter(
    m => !isDefaultCash(m) && !isDefaultVisa(m)
  );
  const builtIn = rest.filter(isDefaultBuiltIn);
  const manual = rest.filter(isManualMethod);

  const result: PaymentMethod[] = [];
  if (cash) result.push(cash);
  if (visa) result.push(visa);
  result.push(...builtIn);
  result.push(...manual);
  return result;
}

export function usePosPaymentMethods() {
  const [methods, setMethods] = useState<PaymentMethod[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    let mounted = true;
    async function fetch() {
      try {
        setLoading(true);
        const res = await posPaymentMethodsApi.getAll();
        const usable = Array.isArray(res)
          ? res.filter((m) =>
              !['CL', 'ÿ∂ŸäÿßŸÅÿ©', 'ŸÜŸÇÿßÿ∑'].includes(m.id)
            )
          : [];
        const sorted = sortPaymentMethods(usable);
        if (mounted) {
          setMethods(sorted);
          setLoading(false);
        }
      } catch (err: any) {
        setError('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿ≠ŸÖŸäŸÑ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ');
        setLoading(false);
        setMethods([]);
      }
    }
    fetch();
    return () => {
      mounted = false;
    };
  }, []);

  return { paymentMethods: methods, loading, error };
}

===== src/Pages/pos/newSales/hooks/useTableManager.tsx =====
// src/Pages/pos/newSales/hooks/useTableManager.tsx
import { useState, useCallback, useEffect } from 'react';
import { TableSection, Table, TableSelection } from '../types/TableSystem';
import * as tableSectionsApi from '../../../../utils/api/pagesApi/tableSectionsApi';
import { useError } from '../../../../contexts/ErrorContext';

export const useTableManager = () => {
  const [tableSections, setTableSections] = useState<TableSection[]>([]);
  const [selectedTable, setSelectedTable] = useState<TableSelection | null>(null);
  const [isChooseTable] = useState<boolean>(true); // ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿá ŸÖŸÜ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÑÿßÿ≠ŸÇÿßŸã
  const [loading, setLoading] = useState(false);
  const { showSuccess, showWarning } = useError();

  // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ ŸàÿßŸÑÿ∑ÿßŸàŸÑÿßÿ™
const loadTableSections = useCallback(async () => {
  try {
    setLoading(true);
    const sections = await tableSectionsApi.getAll();
    
    // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑŸÜŸàÿπ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®
    const convertedSections: TableSection[] = sections.map(section => ({
      ...section,
      image: '/images/default-section.png', // ÿµŸàÿ±ÿ© ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ŸÑŸÑŸÇÿ≥ŸÖ
      tables: section.tables.map(table => ({
        ...table,
        isOccupied: false, // ŸáŸÜÿß ŸäŸÖŸÉŸÜ ÿ¨ŸÑÿ® ÿßŸÑÿ≠ÿßŸÑÿ© ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ© ŸÖŸÜ API ÿ¢ÿÆÿ±
        image: '/images/default-table.png' // ÿµŸàÿ±ÿ© ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ŸÑŸÑÿ∑ÿßŸàŸÑÿ©
      }))
    }));
    
    setTableSections(convertedSections);
  } catch (error) {
    console.error('Error loading table sections:', error);
    setTableSections([]);
  } finally {
    setLoading(false);
  }
}, []);

  useEffect(() => {
    loadTableSections();
  }, [loadTableSections]);

  const selectTable = useCallback((selection: TableSelection) => {
    setSelectedTable(selection);
        showSuccess(`ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿ∑ÿßŸàŸÑÿ© ${selection.table.name} - ${selection.section.name}`);

  }, []);

  const clearSelectedTable = useCallback(() => {
    setSelectedTable(null);
  }, []);

  const getTableDisplayName = useCallback((): string => {
    if (!selectedTable) return 'Table';
    return `${selectedTable.section.name} / ${selectedTable.table.name}`;
  }, [selectedTable]);

  const getServiceCharge = useCallback((): number => {
    if (!selectedTable) return 0;
    return selectedTable.section.serviceCharge;
  }, [selectedTable]);

  const isTableRequired = useCallback((orderType: string): boolean => {
    return isChooseTable && orderType === 'Dine-in';
  }, [isChooseTable]);

  const canAddProduct = useCallback((orderType: string): boolean => {
    if (!isTableRequired(orderType)) return true;
    return selectedTable !== null;
  }, [selectedTable, isTableRequired]);


  // ÿ•ÿ∂ÿßŸÅÿ© ÿØÿßŸÑÿ© ŸÑŸÑÿ™ÿ≠ŸÇŸÇ ŸÖÿπ ÿπÿ±ÿ∂ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
  const checkTableSelection = useCallback((orderType: string): boolean => {
    if (!canAddProduct(orderType)) {
      showWarning('Ÿäÿ¨ÿ® ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ∑ÿßŸàŸÑÿ© ÿ£ŸàŸÑÿßŸã');
      return false;
    }
    return true;
  }, [canAddProduct, showWarning]);

  return {
    tableSections,
    selectedTable,
    isChooseTable,
    loading,
    selectTable,
    clearSelectedTable,
    getTableDisplayName,
    getServiceCharge,
    isTableRequired,
    canAddProduct,
    checkTableSelection, // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿØÿßŸÑÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©
    loadTableSections
  };
};






===== src/Pages/pos/newSales/hooks/useTodayOrders.ts =====
// src/Pages/pos/newSales/hooks/useTodayOrders.ts
import { useState, useEffect, useCallback } from 'react';
import {
  getAllInvoices,
  Invoice,
  InvoicesResponse
} from '../../../../utils/api/pagesApi/invoicesApi';

export const useTodayOrders = () => {
  const [invoices, setInvoices] = useState<Invoice[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [totalCount, setTotalCount] = useState(0);
  const [totalPages, setTotalPages] = useState(1);

  const loadInvoices = useCallback(async (page: number = 1, pageSize: number = 50) => {
    try {
      setLoading(true);
      setError(null);
      
      const response: InvoicesResponse = await getAllInvoices(page, pageSize);
      
      setInvoices(response.data);
      setTotalCount(response.totalCount);
      setTotalPages(response.pageCount);
      
      return response;
    } catch (err: any) {
      const errorMessage = err.message || 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™';
      setError(errorMessage);
      throw new Error(errorMessage);
    } finally {
      setLoading(false);
    }
  }, []);

  const refreshInvoices = useCallback(() => {
    return loadInvoices(1);
  }, [loadInvoices]);

  return {
    invoices,
    loading,
    error,
    totalCount,
    totalPages,
    loadInvoices,
    refreshInvoices
  };
};

===== src/Pages/pos/newSales/index.tsx =====
// src/Pages/pos/newSales/index.tsx
import React, { useState, useCallback, useMemo, useEffect } from 'react';
import { PosProduct, CategoryItem, OrderSummary as OrderSummaryType, OrderItem, PosPrice, SelectedOption } from './types/PosSystem';
import * as posService from '../../../services/posService';
import PriceSelectionPopup from './components/PriceSelectionPopup';
import ProductOptionsPopup from './components/ProductOptionsPopup';
import ProductCard from './components/ProductCard';
import Header from './components/common/Header';
import ActionButtons from './components/ActionButtons';
import OrderSummary from './components/OrderSummary';
import { useOrderManager } from './components/OrderManager';
import { useDataManager } from './hooks/useDataManager';
import './styles/responsive.css';
import './styles/popup.css';
import ArrowBackIcon from '@mui/icons-material/ArrowBack';
import OrderItemDetailsPopup from './components/OrderItemDetailsPopup';
import TableSelectionPopup from './components/TableSelectionPopup';
import { useTableManager } from './hooks/useTableManager';
import { TableSelection } from './types/TableSystem';
import { useError } from '../../../contexts/ErrorContext';
import * as deliveryCompaniesApi from '../../../utils/api/pagesApi/deliveryCompaniesApi';
import { DeliveryCompany } from '../../../utils/api/pagesApi/deliveryCompaniesApi';
import { Customer, CustomerAddress } from 'src/utils/api/pagesApi/customersApi';
import InvoiceDataConverter from '../../../utils/invoiceDataConverter';

const PosSystem: React.FC = () => {
  const [keypadValue, setKeypadValue] = useState('0');
  const [selectedCategory, setSelectedCategory] = useState('');
  const [searchQuery, setSearchQuery] = useState('');
  const [customerName, setCustomerName] = useState('');
  const [selectedChips, setSelectedChips] = useState<string[]>([]);
  const [selectedOrderType, setSelectedOrderType] = useState('Takeaway');
  const [showTablePopup, setShowTablePopup] = useState(false);
const { showWarning, showError } = useError();
  const [deliveryCompanies, setDeliveryCompanies] = useState<DeliveryCompany[]>([]);
  const [selectedDeliveryCompany, setSelectedDeliveryCompany] = useState<DeliveryCompany | null>(null);
  const [selectedCustomer, setSelectedCustomer] = useState<Customer | null>(null);
  const [selectedAddress, setSelectedAddress] = useState<CustomerAddress | null>(null);
  const [taxRate, setTaxRate] = useState(0);
  const [deliveryCharge, setDeliveryCharge] = useState(0);

  // ÿ•ÿ∂ÿßŸÅÿ© Table Manager Hook
  const {
    tableSections,
    selectedTable,
    isChooseTable,
    selectTable,
    clearSelectedTable,
    getTableDisplayName,
    getServiceCharge,
    isTableRequired,
    canAddProduct
  } = useTableManager();

  // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ Data Manager ÿßŸÑÿ¨ÿØŸäÿØ
  const {
    loading,
    error,
    getProducts,
    getCategories,
    defaultCategoryId,
    searchProducts,
    getProductsByScreenId,
    hasProductOptions
  } = useDataManager();

  // ÿØÿßŸÑÿ© ŸÑÿ¨ŸÑÿ® ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ™ŸàÿµŸäŸÑ ŸÖŸÜ ÿßŸÑŸÄ zone
  const getDeliveryCharge = useCallback((): number => {
    if (selectedOrderType === 'Delivery' && selectedAddress && selectedAddress.zoneId) {
      return 15; // ŸäŸÖŸÉŸÜ ÿ™ÿ≠ÿØŸäÿ´Ÿáÿß ŸÖŸÜ API
    }
    return 0;
  }, [selectedOrderType, selectedAddress]);


  const handleDeliveryChargeChange = useCallback((charge: number) => {
    setDeliveryCharge(charge);
  }, []);

  // Extra/Without States
  const [isExtraMode, setIsExtraMode] = useState(false);
  const [isWithoutMode, setIsWithoutMode] = useState(false);
  const [selectedOrderItemId, setSelectedOrderItemId] = useState<string | null>(null);
  
  // Categories States
  const [showingChildren, setShowingChildren] = useState<string | null>(null);
  const [, setParentCategory] = useState<CategoryItem | null>(null);
  
  // Popup States
  const [showPricePopup, setShowPricePopup] = useState(false);
  const [showOptionsPopup, setShowOptionsPopup] = useState(false);
  const [selectedProduct, setSelectedProduct] = useState<PosProduct | null>(null);
  const [selectedProductForOptions, setSelectedProductForOptions] = useState<PosProduct | null>(null);
  const [selectedPriceForOptions, setSelectedPriceForOptions] = useState<PosPrice | null>(null);
  
  // Order Details Popup States
  const [showOrderDetailsPopup, setShowOrderDetailsPopup] = useState(false);
  const [selectedOrderItemForDetails, setSelectedOrderItemForDetails] = useState<OrderItem | null>(null);
  
  // Order States
  const [orderItems, setOrderItems] = useState<OrderItem[]>([]);

  // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©
  const isAdditionMode = isExtraMode || isWithoutMode;
  const currentProducts = getProducts(isAdditionMode);
  const currentCategories = getCategories(isAdditionMode);
  const rootCategories = currentCategories.filter(cat => !cat.parentId);
  const categories = showingChildren 
    ? currentCategories.find(cat => cat.id === showingChildren)?.children || []
    : rootCategories;

  const [isEditMode, setIsEditMode] = useState(false);
  const [currentInvoiceId, setCurrentInvoiceId] = useState<string | null>(null);
const [isLoadingOrder, setIsLoadingOrder] = useState(false);

  // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ±ÿ© Ÿàÿßÿ≠ÿØÿ©
  useEffect(() => {
    const loadDeliveryCompanies = async () => {
      try {
        const companies = await deliveryCompaniesApi.getAll();
        setDeliveryCompanies(companies);
      } catch (error) {
        console.error('Error loading delivery companies:', error);
      }
    };
    loadDeliveryCompanies();
  }, []);

  // ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿπÿ±Ÿàÿ∂ÿ©
  const displayedProducts = useMemo(() => {
    if (searchQuery.trim()) {
      return searchProducts(currentProducts, searchQuery);
    }
    
    if (selectedCategory) {
      return getProductsByScreenId(currentProducts, selectedCategory);
    }
    
    return [];
  }, [currentProducts, selectedCategory, searchQuery, searchProducts, getProductsByScreenId]);

  // ÿ™ÿ≠ÿØŸäÿ´ ÿØÿßŸÑÿ© updateOrderItem
  const updateOrderItem = useCallback((itemId: string, updateType: 'addSubItem' | 'removeSubItem', data: any) => {
    setOrderItems(prev => prev.map(item => {
      if (item.id === itemId) {
        if (updateType === 'addSubItem') {
          const newSubItems = [...(item.subItems || []), data];
          
          const priceImpact = data.type === 'without' ? 0 : data.price;
          const newTotalPrice = item.totalPrice + priceImpact;
          
          return {
            ...item,
            subItems: newSubItems,
            totalPrice: newTotalPrice
          };
        } else if (updateType === 'removeSubItem') {
          const removedSubItem = item.subItems?.find(sub => sub.id === data);
          const newSubItems = item.subItems?.filter(sub => sub.id !== data) || [];
          
          const priceImpact = removedSubItem?.type === 'without' ? 0 : (removedSubItem?.price || 0);
          const newTotalPrice = item.totalPrice - priceImpact;
          
          return {
            ...item,
            subItems: newSubItems.length > 0 ? newSubItems : undefined,
            totalPrice: newTotalPrice
          };
        }
      }
      return item;
    }));
  }, []);

  // Order Manager Hook
  const { addToOrder, removeSubItem } = useOrderManager({
    keypadValue,
    isExtraMode,
    isWithoutMode,
    selectedOrderItemId,
    onOrderAdd: (orderItem) => setOrderItems(prev => [...prev, orderItem]),
    onOrderUpdate: updateOrderItem,
    onModeReset: () => {
      setIsExtraMode(false);
      setIsWithoutMode(false);
      setSelectedOrderItemId(null);
      setKeypadValue('0');
    },
    onLoadNormalProducts: () => {
      // ŸÑÿß ŸÜÿ≠ÿ™ÿßÿ¨ ŸÑÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑÿ£ŸÜŸáÿß ŸÖÿ≠ŸÖŸÑÿ© ŸÖÿ≥ÿ®ŸÇÿßŸã
    }
  });

  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ double click
  const handleOrderItemDoubleClick = useCallback((item: OrderItem) => {
    setSelectedOrderItemForDetails(item);
    setShowOrderDetailsPopup(true);
  }, []);

  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÑŸÑŸÄ OrderItemDetailsPopup
  const handleUpdateOrderItem = useCallback((itemId: string, updates: {
    quantity?: number;
    notes?: string;
    discountPercentage?: number;
    discountAmount?: number;
  }) => {
    setOrderItems(prev => prev.map(item => {
      if (item.id === itemId) {
        const updatedItem = { ...item };
        
        if (updates.quantity !== undefined) {
          updatedItem.quantity = updates.quantity;
        }
        
        if (updates.notes !== undefined) {
          updatedItem.notes = updates.notes;
        }
        
        if (updates.discountPercentage !== undefined) {
          updatedItem.discountPercentage = updates.discountPercentage;
        }
        
        if (updates.discountAmount !== undefined) {
          updatedItem.discountAmount = updates.discountAmount;
        }
        
        const basePrice = item.selectedPrice.price * (updates.quantity || item.quantity);
        const subItemsTotal = item.subItems?.reduce((sum, subItem) => {
          return sum + (subItem.type === 'without' ? 0 : subItem.price);
        }, 0) || 0;
        
        const totalBeforeDiscount = basePrice + subItemsTotal;
        const discountAmount = updates.discountAmount || item.discountAmount || 0;
        updatedItem.totalPrice = totalBeforeDiscount - discountAmount;
        
        return updatedItem;
      }
      return item;
    }));
  }, []);

  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ÿ≠ÿ∞ŸÅ sub-item
  const handleRemoveSubItem = useCallback((orderItemId: string, subItemId: string) => {
    setOrderItems(prev => prev.map(item => {
      if (item.id === orderItemId && item.subItems) {
        const removedSubItem = item.subItems.find(sub => sub.id === subItemId);
        const newSubItems = item.subItems.filter(sub => sub.id !== subItemId);
        
        const priceImpact = removedSubItem?.type === 'without' ? 0 : (removedSubItem?.price || 0);
        const newTotalPrice = item.totalPrice - priceImpact;
        
        return {
          ...item,
          subItems: newSubItems.length > 0 ? newSubItems : undefined,
          totalPrice: newTotalPrice
        };
      }
      return item;
    }));
  }, []);

  // ÿ•ÿ∂ÿßŸÅÿ© useEffect ŸÑÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÅÿ¶ÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
  useEffect(() => {
    if (defaultCategoryId && !selectedCategory && !isAdditionMode) {
      setSelectedCategory(defaultCategoryId);
    }
  }, [defaultCategoryId, selectedCategory, isAdditionMode]);

  // ŸÖÿπÿßŸÑÿ¨ ÿ≤ÿ± Extra - ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¨ÿØŸäÿØ
  const handleExtraClick = useCallback(() => {
    let targetItemId = selectedOrderItemId;
    
    if (!targetItemId && orderItems.length > 0) {
      targetItemId = orderItems[orderItems.length - 1].id;
      setSelectedOrderItemId(targetItemId);
    }
    
    if (!targetItemId) {
      return;
    }
    
    setIsExtraMode(true);
    setIsWithoutMode(false);
    setSelectedChips(prev => prev.includes('extra') ? prev : [...prev.filter(chip => chip !== 'without'), 'extra']);
    
    const additionCategories = getCategories(true).filter(cat => !cat.parentId);
    if (additionCategories.length > 0) {
      setSelectedCategory(additionCategories[0].id);
    }
  }, [selectedOrderItemId, orderItems, getCategories]);

  // ŸÖÿπÿßŸÑÿ¨ ÿ≤ÿ± Without - ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¨ÿØŸäÿØ
  const handleWithoutClick = useCallback(() => {
    let targetItemId = selectedOrderItemId;
    
    if (!targetItemId && orderItems.length > 0) {
      targetItemId = orderItems[orderItems.length - 1].id;
      setSelectedOrderItemId(targetItemId);
    }
    
    if (!targetItemId) {
      return;
    }
    
    setIsWithoutMode(true);
    setIsExtraMode(false);
    setSelectedChips(prev => prev.includes('without') ? prev : [...prev.filter(chip => chip !== 'extra'), 'without']);
    
    const additionCategories = getCategories(true).filter(cat => !cat.parentId);
    if (additionCategories.length > 0) {
      setSelectedCategory(additionCategories[0].id);
    }
  }, [selectedOrderItemId, orderItems, getCategories]);

  // ŸÖÿπÿßŸÑÿ¨ ÿßŸÑÿ±ÿ¨Ÿàÿπ ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
  const handleBackToMainProducts = useCallback(() => {
    setIsExtraMode(false);
    setIsWithoutMode(false);
    setSelectedOrderItemId(null);
    setSelectedChips(prev => prev.filter(chip => chip !== 'extra' && chip !== 'without'));
    
    if (defaultCategoryId) {
      setSelectedCategory(defaultCategoryId);
    }
    
    setShowingChildren(null);
    setParentCategory(null);
  }, [defaultCategoryId]);

  // ŸÖÿπÿßŸÑÿ¨ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÜÿ™ÿ¨ ŸÅŸä ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
  const handleOrderItemSelect = useCallback((itemId: string) => {
    if (selectedOrderItemId === itemId) {
      setSelectedOrderItemId(null);
    } else {
      setSelectedOrderItemId(itemId);
    }
  }, [selectedOrderItemId]);

  // ŸÖÿπÿßŸÑÿ¨ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÅÿ¶ÿ©
  const handleCategorySelect = useCallback((categoryId: string) => {
    const category = categories.find(cat => cat.id === categoryId);
    
    if (category?.hasChildren && category.children) {
      setShowingChildren(categoryId);
      setParentCategory(category);
      if (category.children.length > 0) {
        setSelectedCategory(category.children[0].id);
      }
    } else {
      setSelectedCategory(categoryId);
    }
    setSearchQuery('');
  }, [categories]);

  const handleChildCategorySelect = useCallback((childId: string) => {
    setSelectedCategory(childId);
    setSearchQuery('');
  }, []);

  // ÿØÿßŸÑÿ© ÿßŸÑÿ±ÿ¨Ÿàÿπ ŸÑŸÑŸÅÿ¶ÿ© ÿßŸÑÿ£ÿ®
  const handleBackToParent = useCallback(() => {
    setShowingChildren(null);
    setParentCategory(null);
    
    if (rootCategories.length > 0) {
      setSelectedCategory(rootCategories[0].id);
    }
  }, [rootCategories]);

  // ŸÖÿπÿßŸÑÿ¨ ÿ∂ÿ∫ÿ∑ ÿßŸÑŸÖŸÜÿ™ÿ¨
  const handleProductClick = useCallback((product: PosProduct) => {
    if (!canAddProduct(selectedOrderType)) {
      showWarning('Ÿäÿ¨ÿ® ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ∑ÿßŸàŸÑÿ© ÿ£ŸàŸÑÿßŸã');
      return;
    }

    if (product.hasMultiplePrices) {
      setSelectedProduct(product);
      setShowPricePopup(true);
    } else if (product.productPrices.length > 0) {
      const price = product.productPrices[0];
      
      if (hasProductOptions(product)) {
        setSelectedProductForOptions(product);
        setSelectedPriceForOptions(price);
        setShowOptionsPopup(true);
      } else {
        addToOrder(product, price, []);
      }
    }
  }, [addToOrder, showWarning, hasProductOptions, selectedOrderType, canAddProduct]);

  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ∑ÿßŸàŸÑÿ©
const handleTableSelect = useCallback((selection: TableSelection) => {
  selectTable(selection);
  setShowTablePopup(false);
}, [selectTable]);




  // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπÿßŸÑÿ¨ ŸÅÿ™ÿ≠ popup ÿßŸÑÿ∑ÿßŸàŸÑÿ©
  const handleTableClick = useCallback(() => {
    setShowTablePopup(true);
  }, []);

  // ÿ™ÿπÿØŸäŸÑ ŸÖÿπÿßŸÑÿ¨ ÿ™ÿ∫ŸäŸäÿ± ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®
  const handleOrderTypeChange = useCallback((type: string) => {
    setSelectedOrderType(type);
    
    if (type === 'Dine-in' && isTableRequired(type)) {
      setShowTablePopup(true);
    }
    
    if (type !== 'Dine-in') {
      clearSelectedTable();
    }
  }, [isTableRequired, clearSelectedTable]);

  // ŸÖÿπÿßŸÑÿ¨ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ≥ÿπÿ±
  const handlePriceSelect = useCallback((price: PosPrice) => {
    if (selectedProduct) {
      if (hasProductOptions(selectedProduct)) {
        setSelectedProductForOptions(selectedProduct);
        setSelectedPriceForOptions(price);
        setShowPricePopup(false);
        setShowOptionsPopup(true);
      } else {
        addToOrder(selectedProduct, price, []);
      }
    }
    setSelectedProduct(null);
  }, [selectedProduct, addToOrder, hasProductOptions]);

  // ŸÖÿπÿßŸÑÿ¨ ÿ•ŸÉŸÖÿßŸÑ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™
  const handleOptionsComplete = useCallback((selectedOptions: SelectedOption[]) => {
    if (selectedProductForOptions && selectedPriceForOptions) {
      addToOrder(selectedProductForOptions, selectedPriceForOptions, selectedOptions);
    }
    setShowOptionsPopup(false);
    setSelectedProductForOptions(null);
    setSelectedPriceForOptions(null);
  }, [selectedProductForOptions, selectedPriceForOptions, addToOrder]);

  // ÿ™ÿπÿØŸäŸÑ ÿ≠ÿ≥ÿßÿ® ŸÖŸÑÿÆÿµ ÿßŸÑÿ∑ŸÑÿ® ŸÑŸäÿ¥ŸÖŸÑ ÿßŸÑÿÆÿØŸÖÿ©
const calculateOrderSummary = useCallback((): OrderSummaryType => {
  console.log('üîÑ ÿ≠ÿ≥ÿßÿ® orderSummary ŸÖÿπ:', orderItems.length, 'ÿπŸÜÿµÿ±');
  
  orderItems.forEach((item, index) => {
    console.log(`   ${index + 1}: ${item.product.nameArabic} (ÿßŸÑŸÉŸÖŸäÿ©: ${item.quantity}) - ID: ${item.id}`);
  });
  
  const subtotal = orderItems.reduce((sum, item) => sum + item.totalPrice, 0);
  const serviceCharge = getServiceCharge();
  const service = (subtotal * serviceCharge) / 100;
  const discountPercentage = 0;
  const discount = (subtotal * discountPercentage) / 100;
  const tax = 0;
  
  // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ¨ÿßŸÖŸäÿπ ÿ®ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿµÿ≠Ÿäÿ≠
  const totalAfterDiscount = subtotal - discount;
  const totalAfterTaxAndService = totalAfterDiscount + tax + service + deliveryCharge;
  
  const summary = {
    items: orderItems,
    subtotal,
    discount,
    tax,
    service,
    total: totalAfterTaxAndService,
    totalAfterDiscount,
    totalAfterTaxAndService
  };
  
  console.log('üìä orderSummary ŸÖÿ≠ÿ≥Ÿàÿ®:', {
    itemsCount: summary.items.length,
    subtotal: summary.subtotal,
    total: summary.total
  });
  
  return summary;
}, [orderItems, getServiceCharge, deliveryCharge]);

// Ÿàÿßÿ≥ÿ™ÿÆÿØŸÖŸá ŸÅŸä ŸÉŸÑ ŸÖÿ±ÿ©:
const orderSummary = calculateOrderSummary();

// ŸÖÿπÿßŸÑÿ¨ ÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ® ŸÖŸÜ popup
const handleViewOrderFromPopup = useCallback(async (invoiceData: any) => {
  console.log('üîÑ ÿ®ÿØÿ° ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ∑ŸÑÿ® ŸÑŸÑÿπÿ±ÿ∂:', invoiceData);
  
  try {
    setIsLoadingOrder(true); // ‚úÖ ÿßÿ≥ÿ™ÿ®ÿØŸÑ setLoading ÿ®ŸÄ setIsLoadingOrder
    
    // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÖÿ≠ŸàŸÑ ÿßŸÑÿ¨ÿØŸäÿØ
    const convertedData = await InvoiceDataConverter.convertInvoiceForEdit(invoiceData);
    
    // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿπŸÑŸâ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
    setOrderItems(convertedData.orderItems);
    setDeliveryCharge(convertedData.deliveryCharge);
    
    // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ
    if (convertedData.selectedCustomer) {
      setSelectedCustomer(convertedData.selectedCustomer);
      setCustomerName(`${convertedData.selectedCustomer.name} - ${convertedData.selectedCustomer.phone1}`);
      
      // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ£ŸàŸÑ ÿπŸÜŸàÿßŸÜ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖÿ™ŸàŸÅÿ±
      if (convertedData.selectedCustomer.addresses.length > 0) {
        setSelectedAddress(convertedData.selectedCustomer.addresses[0]);
      }
    }
    
    // ÿ™ÿ∑ÿ®ŸäŸÇ ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®
    const orderTypeMap: { [key: number]: string } = {
      1: 'Takeaway',
      2: 'Dine-in', 
      3: 'Delivery',
      4: 'Pickup'
    };
    
    const newOrderType = orderTypeMap[invoiceData.invoiceType] || 'Takeaway';
    setSelectedOrderType(newOrderType);
    
    // ÿ™ŸÅÿπŸäŸÑ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
    setIsEditMode(true);
    setCurrentInvoiceId(invoiceData.id);
    
    console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠');
    
  } catch (error) {
    console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸàŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ®:', error);
    showError('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ® ŸÑŸÑÿ™ÿπÿØŸäŸÑ');
  } finally {
    setIsLoadingOrder(false); // ‚úÖ ÿßÿ≥ÿ™ÿ®ÿØŸÑ setLoading ÿ®ŸÄ setIsLoadingOrder
  }
}, [setOrderItems, setSelectedCustomer, setCustomerName, setSelectedAddress, 
    setSelectedOrderType, setIsEditMode, setCurrentInvoiceId, showError]);


    const handleViewTableOrder = useCallback((invoiceData: any) => {
  setShowTablePopup(false);
  // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ŸÜŸÅÿ≥ ŸÖÿπÿßŸÑÿ¨ ÿπÿ±ÿ∂ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑŸÖŸàÿ¨ŸàÿØ
  handleViewOrderFromPopup(invoiceData);
}, [handleViewOrderFromPopup]);

    useEffect(() => {
  // ÿ≠ŸÅÿ∏ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿ≠ŸÖŸÑÿ© ŸÅŸä ŸÉÿßÿ¥ ÿßŸÑŸÖÿ≠ŸàŸÑ
  const allProducts = getProducts(false); // ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿπÿßÿØŸäÿ©
  allProducts.forEach(product => {
    InvoiceDataConverter.cacheProduct(product);
  });
}, [getProducts]);

// ÿ£ÿ∂ŸÅ ŸÅŸä ŸÖÿπÿßŸÑÿ¨ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿπŸÖŸäŸÑ
const handleCustomerSelect = useCallback((customer: Customer, address: CustomerAddress) => {
  // ÿ≠ŸÅÿ∏ ÿßŸÑÿπŸÖŸäŸÑ ŸÅŸä ÿßŸÑŸÉÿßÿ¥
  InvoiceDataConverter.cacheCustomer(customer);
  
  setSelectedCustomer(customer);
  setSelectedAddress(address);
  setCustomerName(`${customer.name} - ${customer.phone1}`);
}, []);

  // ÿ≠ÿ∞ŸÅ ŸÖŸÜÿ™ÿ¨ ŸÖŸÜ ÿßŸÑÿ∑ŸÑÿ®
  const removeOrderItem = useCallback((itemId: string) => {
    setOrderItems(prev => prev.filter(item => item.id !== itemId));
  }, []);

  // ÿØÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑÿ•ÿØÿÆÿßŸÑ
  const validateKeypadInput = useCallback((value: string): boolean => {
    if (!value || value.trim() === '') return false;
    if (value === '.') return true;
    
    const numValue = parseFloat(value);
    if (isNaN(numValue)) return false;
    if (numValue < 0) return false;
    
    const decimalPlaces = value.split('.')[1]?.length || 0;
    if (decimalPlaces > 3) return false;
    if (numValue > 999999) return false;
    
    return true;
  }, []);

  // ŸÖÿπÿßŸÑÿ¨ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ
  const handleNumberClick = useCallback((number: string) => {
    let newValue = keypadValue;
    
    if (number === '.') {
      if (!keypadValue.includes('.')) {
        newValue = keypadValue + '.';
      } else {
        return;
      }
    } else {
      if (keypadValue === '0' && number !== '0') {
        newValue = number;
      } else {
        newValue = keypadValue + number;
      }
    }
    
    if (validateKeypadInput(newValue)) {
      setKeypadValue(newValue);
    }
  }, [keypadValue, validateKeypadInput]);

  // ÿØÿßŸÑÿ© ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ©
  const getNumericValue = useCallback((): number => {
    const value = parseFloat(keypadValue);
    return isNaN(value) || value <= 0 ? 1 : value;
  }, [keypadValue]);

  // ÿØÿßŸÑÿ© ÿßŸÑŸÖÿ≥ÿ≠
  const handleClearClick = useCallback(() => {
    setKeypadValue('0');
  }, []);

  // ‚úÖ ÿ•ÿµŸÑÿßÿ≠ ÿØÿπŸÖ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖŸÅÿßÿ™Ÿäÿ≠ ÿßŸÑÿπÿßÿØŸäÿ© ŸÖÿπ ÿ≠ŸÑ ÿÆÿ∑ÿ£ contentEditable
  useEffect(() => {
    const handleKeyPress = (event: KeyboardEvent) => {
      // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿπÿØŸÖ Ÿàÿ¨ŸàÿØ popup ŸÖŸÅÿ™Ÿàÿ≠
      const isAnyPopupOpen = showPricePopup || showOptionsPopup || showOrderDetailsPopup || showTablePopup;
      
      // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿπÿØŸÖ Ÿàÿ¨ŸàÿØ input ŸÖÿ±ŸÉÿ≤ ÿπŸÑŸäŸá - ŸÖÿπ ÿ•ÿµŸÑÿßÿ≠ ÿÆÿ∑ÿ£ contentEditable
      const activeElement = document.activeElement;
      const isInputFocused = activeElement?.tagName === 'INPUT' || 
                            activeElement?.tagName === 'TEXTAREA' || 
                            (activeElement as HTMLElement)?.contentEditable === 'true';
      
      // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ popup ŸÖŸÅÿ™Ÿàÿ≠ ÿ£Ÿà input ŸÖÿ±ŸÉÿ≤ ÿπŸÑŸäŸáÿå ŸÑÿß ŸÜÿ™ÿØÿÆŸÑ
      if (isAnyPopupOpen || isInputFocused) {
        return;
      }
      
      const key = event.key;
      
      // ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ ŸàÿßŸÑŸÜŸÇÿ∑ÿ© ÿßŸÑÿπÿ¥ÿ±Ÿäÿ©
      if (/^[0-9]$/.test(key)) {
        event.preventDefault();
        handleNumberClick(key);
      } else if (key === '.') {
        event.preventDefault();
        handleNumberClick('.');
      } else if (key === 'Backspace') {
        event.preventDefault();
        // ÿ≠ÿ∞ŸÅ ÿ¢ÿÆÿ± ÿ±ŸÇŸÖ
        if (keypadValue.length > 1) {
          const newValue = keypadValue.slice(0, -1);
          if (validateKeypadInput(newValue)) {
            setKeypadValue(newValue);
          }
        } else {
          setKeypadValue('0');
        }
      } else if (key === 'Delete' || key === 'Escape') {
        event.preventDefault();
        handleClearClick();
      } else if (key === 'Enter') {
        event.preventDefault();
        // ŸäŸÖŸÉŸÜ ÿ•ÿ∂ÿßŸÅÿ© Ÿàÿ∏ŸäŸÅÿ© ŸÖÿπŸäŸÜÿ© ÿπŸÜÿØ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ Enter
      }
    };

    document.addEventListener('keydown', handleKeyPress);
    return () => document.removeEventListener('keydown', handleKeyPress);
  }, [
    keypadValue, 
    handleNumberClick, 
    handleClearClick, 
    validateKeypadInput,
    showPricePopup,
    showOptionsPopup,
    showOrderDetailsPopup,
    showTablePopup
  ]);

  const handleChipClick = useCallback((chipType: string) => {
    setSelectedChips(prev => 
      prev.includes(chipType) 
        ? prev.filter(chip => chip !== chipType)
        : [...prev, chipType]
    );
  }, []);





const handleResetOrder = useCallback(() => {
  setOrderItems([]);
  setSelectedOrderItemId(null);
  setCustomerName('');
  setKeypadValue('0');
  
  setSelectedCustomer(null);
  setSelectedAddress(null);
  setDeliveryCharge(0);
  
  // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ
  setIsEditMode(false);
  setCurrentInvoiceId(null);
  
  clearSelectedTable();

  setIsExtraMode(false);
  setIsWithoutMode(false);
  setSelectedChips([]);
  
  handleBackToMainProducts();
  setSearchQuery('');
  
  // ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÉÿßÿ¥ ÿπŸÜÿØ ÿßŸÑÿ≠ÿßÿ¨ÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)
  // InvoiceDataConverter.clearCache();
  
  console.log('Order reset successfully');
}, [handleBackToMainProducts, clearSelectedTable]);

    const handleOrderCompleted = useCallback((result: any) => {
  console.log('ÿ™ŸÖ ÿ•ŸÜŸáÿßÿ° ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠:', result);
  
  // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ŸÉŸÖÿß ŸÑŸà ÿ™ŸÖ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ Reset
  handleResetOrder();
  
  // ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ÿ£Ÿä ŸÖŸÜÿ∑ŸÇ ÿ•ÿ∂ÿßŸÅŸä ŸáŸÜÿß ŸÖÿ´ŸÑ ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿ¨ÿßÿ≠
  console.log('ÿ™ŸÖ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿ®ŸÜÿ¨ÿßÿ≠');
}, [handleResetOrder]);

  // ÿπÿ±ÿ∂ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ
  if (loading) {
    return (
      <div className="pos-system loading">
        <div className="loading-spinner">ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...</div>
      </div>
    );
  }

  // ÿπÿ±ÿ∂ ÿ≠ÿßŸÑÿ© ÿßŸÑÿÆÿ∑ÿ£
  if (error) {
    return (
      <div className="pos-system error">
        <div className="error-message">{error}</div>
        <button onClick={() => window.location.reload()}>ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ©</button>
      </div>
    );
  }


  return (
    <div className="pos-system">
      <Header
        selectedOrderType={selectedOrderType}
        onOrderTypeChange={handleOrderTypeChange}
        onResetOrder={handleResetOrder}
        onTableClick={handleTableClick}
        tableDisplayName={getTableDisplayName()}
        deliveryCompanies={deliveryCompanies}
        selectedDeliveryCompany={selectedDeliveryCompany}
        onDeliveryCompanySelect={setSelectedDeliveryCompany}
        selectedCustomer={selectedCustomer}
        selectedAddress={selectedAddress}
        onViewOrder={handleViewOrderFromPopup} // ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß

      />

      <main className="main-content">
        <section className="products-section">
          <div className="number-pad-bar">
            <div className="keypad-grid">
              {['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '.', 'C'].map((key) => (
                <button 
                  key={key}
                  className="keypad-key"
                  onClick={() => key === 'C' ? handleClearClick() : handleNumberClick(key)}
                >
                  {key}
                </button>
              ))}
            </div>
            <div className="keypad-display">
              {keypadValue}
            </div>
          </div>

          <ActionButtons
            selectedChips={selectedChips}
            onChipClick={handleChipClick}
            isExtraMode={isExtraMode}
            isWithoutMode={isWithoutMode}
            onExtraClick={handleExtraClick}
            onWithoutClick={handleWithoutClick}
            searchQuery={searchQuery}
            onSearchChange={setSearchQuery}
            hasSelectedOrderItem={true}
          />

          <div className="product-grid">
            {displayedProducts.map((product) => (
              <ProductCard
                key={product.id}
                product={product}
                onClick={handleProductClick}
              />
            ))}
          </div>
        </section>

        <aside className="categories-sidebar">
          <div className="categories-list">
            {isAdditionMode && (
              <button
                onClick={handleBackToMainProducts}
                className="category-item back-button main-back"
              >
                <ArrowBackIcon />
                <span>ÿ±ÿ¨Ÿàÿπ ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©</span>
              </button>
            )}
            
            {showingChildren && (
              <button
                onClick={handleBackToParent}
                className="category-item back-button"
              >
                <ArrowBackIcon />
                <span>ÿ±ÿ¨Ÿàÿπ</span>
              </button>
            )}
            
            {categories.map((category) => (
              <button
                key={category.id}
                onClick={() => showingChildren ? handleChildCategorySelect(category.id) : handleCategorySelect(category.id)}
                className={`category-item ${category.id === selectedCategory ? 'active' : ''}`}
              >
                <img src={category.image} alt={category.name} />
                <span>{category.nameArabic}</span>
              </button>
            ))}
          </div>
        </aside>

        <OrderSummary
          orderSummary={orderSummary}
          customerName={customerName}
          onCustomerNameChange={setCustomerName}
          onRemoveOrderItem={removeOrderItem}
          onRemoveSubItem={handleRemoveSubItem}
          selectedOrderItemId={selectedOrderItemId}
          onOrderItemSelect={handleOrderItemSelect}
          onOrderItemDoubleClick={handleOrderItemDoubleClick}
          selectedCustomer={selectedCustomer}
          selectedAddress={selectedAddress}
          onCustomerSelect={handleCustomerSelect}
          orderType={selectedOrderType}
          onDeliveryChargeChange={handleDeliveryChargeChange} readOnly={false}   onOrderCompleted={handleOrderCompleted} 
          selectedTable={selectedTable} // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß
          selectedDeliveryCompany={selectedDeliveryCompany} // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß// ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿπÿßŸÑÿ¨ ÿßŸÑÿ¨ÿØŸäÿØ
          isEditMode={isEditMode}
  currentInvoiceId={currentInvoiceId}
       />
      </main>

      <PriceSelectionPopup
        product={selectedProduct}
        quantity={getNumericValue()}
        isOpen={showPricePopup}
        onClose={() => {
          setShowPricePopup(false);
          setSelectedProduct(null);
        }}
        onSelectPrice={handlePriceSelect}
      />

      <ProductOptionsPopup
        product={selectedProductForOptions}
        selectedPrice={selectedPriceForOptions}
        quantity={getNumericValue()}
        isOpen={showOptionsPopup}
        onClose={() => {
          setShowOptionsPopup(false);
          setSelectedProductForOptions(null);
          setSelectedPriceForOptions(null);
        }}
        onComplete={handleOptionsComplete}
      />

      <OrderItemDetailsPopup
        orderItem={selectedOrderItemForDetails}
        isOpen={showOrderDetailsPopup}
        onClose={() => {
          setShowOrderDetailsPopup(false);
          setSelectedOrderItemForDetails(null);
        }}
        onUpdateItem={handleUpdateOrderItem}
        onRemoveItem={removeOrderItem}
      />

<TableSelectionPopup
  isOpen={showTablePopup}
  onClose={() => setShowTablePopup(false)}
  onSelectTable={handleTableSelect}
  onViewOrder={handleViewTableOrder} // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
  tableSections={tableSections}
/>

      
    </div>
  );
};

export default PosSystem;


===== src/Pages/pos/newSales/srcdhiwise/component-tagger.tsx =====
import React, { useMemo } from 'react';

export interface TaggedComponentProps {
  tag?: string;
  id?: string;
  className?: string;
  'data-testid'?: string;
  children?: React.ReactNode;
}

export interface TaggerOptions {
  tag?: string;
  id?: string;
  className?: string;
  testId?: string;
  debug?: boolean;
}

/**
 * Component tagger utility for adding metadata and testing attributes to React components
 * @param Component - The React component to wrap
 * @param options - Tagging options including tag, id, className, testId, and debug
 * @returns Tagged React component with additional props
 */
export function tagger<T extends React.ComponentType<any>>(
  Component: T,
  options: TaggerOptions = {}
): React.ComponentType<React.ComponentProps<T> & TaggedComponentProps> {
  const { tag, id, className, testId, debug = false } = options;

  const TaggedComponent = React.forwardRef<any, React.ComponentProps<T> & TaggedComponentProps>(
    (props, ref) => {
      const enhancedProps = {
        ...props,
        ...(tag && { 'data-tag': tag }),
        ...(id && { id }),
        ...(className && { className: `${props.className || ''} ${className}`.trim() }),
        ...(testId && { 'data-testid': testId }),
        ref,
      };

      if (debug) {
        console.log('Tagged component props:', enhancedProps);
      }

      return React.createElement(Component, enhancedProps);
    }
  );

  TaggedComponent.displayName = `Tagged(${Component.displayName || Component.name || 'Component'})`;

  return TaggedComponent as React.ComponentType<React.ComponentProps<T> & TaggedComponentProps>;
}

/**
 * Higher-order component for tagging components with metadata
 * @param options - Tagging options
 * @returns HOC function that wraps components with tagging functionality
 */
export const withTagger = (options: TaggerOptions = {}) => {
  return <T extends React.ComponentType<any>>(Component: T) => {
    return tagger(Component, options);
  };
};

/**
 * Hook for creating tagged element props
 * @param options - Tagging options
 * @returns Object with tagged props
 */
export const useTaggedProps = (options: TaggerOptions = {}) => {
  const { tag, id, className, testId } = options;
  
  return React.useMemo(() => ({
    ...(tag && { 'data-tag': tag }),
    ...(id && { id }),
    ...(className && { className }),
    ...(testId && { 'data-testid': testId }),
  }), [tag, id, className, testId]);
};

export default tagger;
===== src/Pages/pos/newSales/srcvitejs/plugin-react.tsx =====
import React, { useCallback } from 'react';

export interface ReactPluginOptions {
  enableHMR?: boolean;
  enableDevTools?: boolean;
  strictMode?: boolean;
  debug?: boolean;
}

export interface ReactComponentOptions {
  displayName?: string;
  propTypes?: any;
  defaultProps?: any;
}

/**
 * React plugin utility for enhancing React components with additional functionality
 * @param Component - The React component to enhance
 * @param options - Plugin options for React-specific enhancements
 * @returns Enhanced React component with plugin functionality
 */
export function react<T extends React.ComponentType<any>>(
  Component: T,
  options: ReactPluginOptions & ReactComponentOptions = {}
): React.ComponentType<React.ComponentProps<T>> {
  const {
    enableHMR = true,
    enableDevTools = process.env.NODE_ENV === 'development',
    strictMode = false,
    debug = false,
    displayName,
    propTypes,
    defaultProps,
  } = options;

  const EnhancedComponent = React.forwardRef<any, React.ComponentProps<T>>(
    (props, ref) => {
      // Debug logging in development
      if (debug && enableDevTools) {
        console.log(`[React Plugin] Rendering ${displayName || Component.name}:`, props);
      }

      // Error boundary for development
      if (enableDevTools) {
        try {
          const element = React.createElement(Component, { ...props, ref });
          return strictMode ? React.createElement(React.StrictMode, {}, element) : element;
        } catch (error) {
          console.error(`[React Plugin] Error in ${displayName || Component.name}:`, error);
          return React.createElement(
            'div',
            { style: { color: 'red', padding: '10px', border: '1px solid red' } },
            `Error: ${error instanceof Error ? error.message : 'Unknown error'}`
          );
        }
      }

      const element = React.createElement(Component, { ...props, ref });
      return strictMode ? React.createElement(React.StrictMode, {}, element) : element;
    }
  );

  // Set component metadata
  EnhancedComponent.displayName = displayName || `ReactPlugin(${Component.displayName || Component.name || 'Component'})`;
  
  if (propTypes) {
    (EnhancedComponent as any).propTypes = propTypes;
  }
  
  if (defaultProps) {
    (EnhancedComponent as any).defaultProps = defaultProps;
  }

  // Hot module replacement support
  if (enableHMR && enableDevTools && (module as any).hot) {
    (module as any).hot.accept();
  }

  return EnhancedComponent;
}

/**
 * Higher-order component for React plugin enhancements
 * @param options - Plugin options
 * @returns HOC function that wraps components with React plugin functionality
 */
export const withReactPlugin = (options: ReactPluginOptions & ReactComponentOptions = {}) => {
  return <T extends React.ComponentType<any>>(Component: T) => {
    return react(Component, options);
  };
};

/**
 * Hook for React plugin utilities
 * @param options - Plugin options
 * @returns Object with React plugin utilities
 */
export const useReactPlugin = (options: ReactPluginOptions = {}) => {
  const { enableDevTools = process.env.NODE_ENV === 'development', debug = false } = options;
  
  const logRender = React.useCallback((componentName: string, props?: any) => {
    if (debug && enableDevTools) {
      console.log(`[React Plugin] ${componentName} rendered:`, props);
    }
  }, [debug, enableDevTools]);

  const measurePerformance = React.useCallback((name: string, fn: () => void) => {
    if (enableDevTools) {
      const start = performance.now();
      fn();
      const end = performance.now();
      console.log(`[React Plugin] ${name} took ${end - start} milliseconds`);
    } else {
      fn();
    }
  }, [enableDevTools]);

  return {
    logRender,
    measurePerformance,
    isDevMode: enableDevTools,
  };
};

export default react;
===== src/Pages/pos/newSales/styles/ActionButtons.css =====
/* src/Pages/pos/newSales/components/ActionButtons.css */

.action-buttons-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  background: #ffffff;
  border-bottom: 1px solid #e9ecef;
}

.action-chips {
  display: flex;
  gap: 12px;
}

.action-chip {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border: 1px solid #e9ecef;
  border-radius: 8px;
  background: #ffffff;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  font-weight: 500;
}

.action-chip:hover {
  border-color: #0373ed;
  background: rgba(3, 115, 237, 0.05);
}

.action-chip.active {
  background: #0373ed;
  color: white;
  border-color: #0373ed;
}

.action-chip img {
  width: 16px;
  height: 16px;
}

.search-container {
  display: flex;
  align-items: center;
  position: relative;
  gap: 8px;
}

.search-icon {
  position: absolute;
  left: 12px;
  width: 16px;
  height: 16px;
  z-index: 1;
}

.search-input {
  padding: 8px 12px 8px 36px;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  font-size: 14px;
  width: 200px;
}

.search-input:focus {
  outline: none;
  border-color: #0373ed;
}

.filter-button {
  padding: 8px;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  background: white;
  cursor: pointer;
}

.filter-button:hover {
  border-color: #0373ed;
}

.filter-button img {
  width: 16px;
  height: 16px;
}

===== src/Pages/pos/newSales/styles/Header.css =====
/* src/Pages/pos/newSales/components/Header.css */

.pos-header {
  height: clamp(60px, 8vh, 100px);
  background: #ffffff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  flex-shrink: 0;
  z-index: 100;
  position: relative;
}

.header-content {
  height: 100%;
  padding: 0 clamp(16px, 3vw, 32px);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.header-logo {
  height: 70%;
  width: auto;
  object-fit: contain;
}

.header-nav {
  display: flex;
  align-items: center;
  gap: clamp(12px, 2vw, 24px);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: clamp(4px, 0.8vw, 8px);
  padding: clamp(6px, 1.2vw, 12px) clamp(8px, 1.6vw, 16px);
  border-radius: 6px;
  text-decoration: none;
  color: #333333;
  font-size: clamp(11px, 1.4vw, 16px);
  font-weight: 500;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.nav-item:hover {
  background: rgba(3, 115, 237, 0.1);
}

.nav-item.active {
  color: #0373ed;
  background: rgba(3, 115, 237, 0.1);
}

.nav-item img {
  width: clamp(14px, 1.8vw, 20px);
  height: clamp(14px, 1.8vw, 20px);
}

.order-type-display {
  padding: clamp(6px, 1.2vw, 12px) clamp(12px, 2.4vw, 20px);
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  font-size: clamp(11px, 1.4vw, 16px);
  font-weight: 600;
  color: #333333;
  min-width: clamp(80px, 12vw, 120px);
  text-align: center;
}

.menu-dropdown-container {
  position: relative;
}

.menu-button {
  padding: clamp(6px, 1.2vw, 12px);
  background: transparent;
  border: none;
  cursor: pointer;
  border-radius: 6px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.menu-button:hover {
  background: rgba(0, 0, 0, 0.05);
}

.menu-button img {
  width: clamp(18px, 2.4vw, 28px);
  height: clamp(18px, 2.4vw, 28px);
}

/* Figma Dropdown - ŸÖÿπ scroll ŸÖÿÆŸÅŸä */
.figma-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  background: transparent;
  z-index: 1000;
  animation: slideInFromRight 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  gap: clamp(16px, 2.5vw, 20px);
  max-height: calc(100vh - 120px);
  overflow-y: auto;
  overflow-x: hidden;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  /* ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÄ scrollbar */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
}

/* ÿ•ÿÆŸÅÿßÿ° ÿßŸÑŸÄ scrollbar ŸÅŸä WebKit browsers */
.figma-dropdown::-webkit-scrollbar {
  width: 0;
  height: 0;
  background: transparent;
  display: none;
}

/* Order Types Section */
.order-types-section {
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1vw, 8px);
  flex-shrink: 0;
}

/* Delivery Partners Section */
.delivery-partners-section {
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1vw, 8px);
  margin-top: clamp(12px, 2vw, 16px);
  flex-shrink: 0;
}

/* Section Separator */
.section-separator {
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.1), transparent);
  margin: clamp(8px, 1.5vw, 12px) 0;
  flex-shrink: 0;
}

/* Figma Cards - ŸÖŸèÿ≠ÿ≥ŸÜÿ© ÿ®ÿØŸàŸÜ ÿ™ÿ£ÿ´Ÿäÿ± ÿπŸÑŸâ ÿßŸÑŸÉÿ±Ÿàÿ™ ÿßŸÑŸÖÿ¨ÿßŸàÿ±ÿ© */
.figma-card {
  width: clamp(90px, 14vw, 110px);
  height: clamp(85px, 13vw, 105px);
  background: white;
  border-radius: 12px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  padding: clamp(6px, 1.2vw, 8px);
  backdrop-filter: blur(8px);
  scroll-snap-align: start;
  contain: layout style paint;
  /* ÿ•ÿ∂ÿßŸÅÿ© margin ŸÑŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© */
  margin: 2px;
}

.figma-card:hover {
  border-color: #0373ed;
  /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ≠ÿ±ŸÉÿ© ŸÑÿ™ÿ¨ŸÜÿ® ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ± ÿπŸÑŸâ ÿßŸÑŸÉÿ±Ÿàÿ™ ÿßŸÑŸÖÿ¨ÿßŸàÿ±ÿ© */
  transform: translateX(-2px);
  box-shadow: 0 6px 16px rgba(3, 115, 237, 0.2);
  /* ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ brightness ŸÉÿ®ÿØŸäŸÑ ŸÑŸÑŸÄ scale */
  filter: brightness(1.05);
}

.figma-card.selected {
  border-color: #0373ed;
  box-shadow: 0 5px 12px rgba(3, 115, 237, 0.25);
  background: rgba(3, 115, 237, 0.02);
}

.delivery-card {
  border: 1px solid #e9ecef;
}

.delivery-card:hover {
  border-color: #0373ed;
  transform: translateX(-2px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  filter: brightness(1.05);
}

/* Card Icon Section */
.card-icon-section {
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 1;
  width: 100%;
}

/* Card Icons - ŸÖŸèÿµÿ∫ÿ±ÿ© */
.card-icon {
  width: clamp(24px, 3.5vw, 32px);
  height: clamp(24px, 3.5vw, 32px);
  object-fit: contain;
}

.delivery-icon {
  max-width: clamp(45px, 7vw, 60px);
  max-height: clamp(15px, 2.5vw, 20px);
  object-fit: contain;
}

/* Card Labels - ÿØÿßÿÆŸÑ ÿßŸÑŸÉÿßÿ±ÿ™ */
.card-label {
  color: black;
  font-size: clamp(10px, 1.5vw, 14px);
  font-family: 'Nunito', sans-serif;
  font-weight: 400;
  word-wrap: break-word;
  text-align: center;
  line-height: 1.1;
  margin-top: clamp(2px, 0.5vw, 4px);
  width: 100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

.figma-card.selected .card-label {
  color: #0373ed;
  font-weight: 500;
}

/* Animations */
@keyframes slideInFromRight {
  from {
    opacity: 0;
    transform: translateX(15px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÑŸÑŸÉÿ±Ÿàÿ™ */
.figma-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3));
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
  border-radius: 10px;
}

.figma-card:hover::before {
  opacity: 1;
}

/* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ fade ŸÑŸÑŸÄ scroll */
.figma-dropdown::before {
  content: '';
  position: sticky;
  top: 0;
  height: 6px;
  background: linear-gradient(to bottom, rgba(255, 255, 255, 0.9), transparent);
  z-index: 1;
  pointer-events: none;
  flex-shrink: 0;
}

.figma-dropdown::after {
  content: '';
  position: sticky;
  bottom: 0;
  height: 6px;
  background: linear-gradient(to top, rgba(255, 255, 255, 0.9), transparent);
  z-index: 1;
  pointer-events: none;
  flex-shrink: 0;
}

/* Responsive Design */
@media (max-width: 1200px) {
  .nav-item span {
    display: none;
  }
  
  .nav-item {
    padding: clamp(8px, 1.5vw, 12px);
  }
  
  .figma-dropdown {
    right: -5px;
  }
}

@media (max-width: 768px) {
  .header-nav {
    gap: clamp(8px, 1.5vw, 16px);
  }
  
  .order-type-display {
    min-width: clamp(60px, 10vw, 80px);
    font-size: clamp(10px, 1.2vw, 14px);
  }
  
  .figma-dropdown {
    right: -10px;
    gap: clamp(12px, 2vw, 16px);
    max-height: calc(100vh - 100px);
  }
  
  .figma-card {
    width: clamp(75px, 16vw, 95px);
    height: clamp(70px, 15vw, 90px);
    padding: clamp(4px, 1vw, 6px);
    margin: 1px;
  }
  
  .figma-card:hover {
    transform: translateX(-1px);
  }
  
  .delivery-card:hover {
    transform: translateX(-1px);
  }
  
  .card-icon {
    width: clamp(18px, 3vw, 24px);
    height: clamp(18px, 3vw, 24px);
  }
  
  .delivery-icon {
    max-width: clamp(35px, 6vw, 45px);
    max-height: clamp(12px, 2vw, 16px);
  }
  
  .card-label {
    font-size: clamp(8px, 1.3vw, 12px);
  }
}

@media (max-width: 480px) {
  .header-content {
    padding: 0 clamp(8px, 2vw, 16px);
  }
  
  .header-nav {
    gap: clamp(4px, 1vw, 8px);
  }
  
  .figma-dropdown {
    right: -15px;
    max-height: calc(100vh - 80px);
  }
  
  .figma-card {
    width: clamp(65px, 18vw, 85px);
    height: clamp(60px, 17vw, 80px);
    padding: clamp(3px, 0.8vw, 5px);
    margin: 1px;
  }
  
  /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ≠ÿ±ŸÉÿ© ŸÜŸáÿßÿ¶ŸäÿßŸã ŸÅŸä ÿßŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
  .figma-card:hover {
    transform: none;
    filter: brightness(1.1);
  }
  
  .delivery-card:hover {
    transform: none;
    filter: brightness(1.1);
  }
  
  .card-icon {
    width: clamp(16px, 2.5vw, 20px);
    height: clamp(16px, 2.5vw, 20px);
  }
  
  .delivery-icon {
    max-width: clamp(30px, 5vw, 40px);
    max-height: clamp(10px, 1.8vw, 14px);
  }
  
  .card-label {
    font-size: clamp(7px, 1.1vw, 10px);
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÑŸÖÿ≥Ÿäÿ© */
@media (hover: none) and (pointer: coarse) {
  .figma-dropdown {
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: y proximity;
  }
  
  .figma-card {
    scroll-snap-align: start;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ° */
.figma-dropdown {
  will-change: scroll-position;
  contain: layout style paint;
}

.figma-card {
  will-change: transform, box-shadow;
  backface-visibility: hidden;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿπÿßŸÑŸäÿ© ÿßŸÑÿØŸÇÿ© */
@media (min-resolution: 150dpi) {
  .figma-card {
    border-width: 1.5px;
  }
}

@media (min-resolution: 200dpi) {
  .figma-card {
    border-width: 1px;
  }
}



/* ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ŸÅŸä Header.css */

.order-type-display.clickable {
  cursor: pointer;
  transition: all 0.2s ease;
  border-radius: 4px;
  padding: 8px 12px;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid transparent;
  position: relative;
  overflow: hidden;
}

.order-type-display.clickable:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.3);
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.order-type-display.clickable:active {
  transform: translateY(0);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

/* ÿ™ÿ£ÿ´Ÿäÿ± ripple ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± */
.order-type-display.clickable::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: width 0.3s ease, height 0.3s ease;
}

.order-type-display.clickable:active::before {
  width: 100px;
  height: 100px;
}

/* ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸäŸÇŸàŸÜÿ© ÿµÿ∫Ÿäÿ±ÿ© ŸÑŸÑÿ•ÿ¥ÿßÿ±ÿ© ŸÑŸÑŸÄ reset */
.order-type-display.clickable::after {
  content: '‚Üª';
  position: absolute;
  top: 2px;
  right: 2px;
  font-size: 10px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.order-type-display.clickable:hover::after {
  opacity: 0.7;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÄ tooltip */
.order-type-display.clickable[title] {
  position: relative;
}

.order-type-display.clickable[title]:hover::after {
  content: attr(title);
  position: absolute;
  bottom: -30px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  z-index: 1000;
  opacity: 0.9;
}

/* Responsive */
@media (max-width: 768px) {
  .order-type-display.clickable {
    padding: 6px 8px;
    font-size: 12px;
  }
  
  .order-type-display.clickable::after {
    font-size: 8px;
  }
}



/* ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ŸÅŸä Header.css */

/* Professional Dropdown Styles */
.professional-dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  width: 420px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 12px 48px rgba(0, 0, 0, 0.15);
  border: 1px solid #e9ecef;
  z-index: 1000;
  transform: translateY(8px);
  opacity: 0;
  animation: dropdownSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  max-height: 80vh;
  overflow-y: auto;
}

@keyframes dropdownSlideIn {
  from {
    opacity: 0;
    transform: translateY(0);
  }
  to {
    opacity: 1;
    transform: translateY(8px);
  }
}

.dropdown-section {
  padding: 20px;
}

.dropdown-section:not(:last-child) {
  border-bottom: 1px solid #f1f3f4;
}

.section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.section-title {
  font-size: 16px;
  font-weight: 600;
  color: #333;
  margin: 0;
  font-family: 'Cairo', sans-serif;
}

.section-divider {
  flex: 1;
  height: 1px;
  background: linear-gradient(to right, #e9ecef, transparent);
}

/* Order Types Cards */
.order-types-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.order-type-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: white;
  border: 2px solid #f1f3f4;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.order-type-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, var(--accent-color), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.order-type-card:hover {
  border-color: var(--accent-color);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
}

.order-type-card:hover::before {
  opacity: 0.05;
}

.order-type-card.selected {
  border-color: var(--accent-color);
  background: rgba(var(--accent-color), 0.05);
  box-shadow: 0 4px 16px rgba(var(--accent-color), 0.2);
}

.order-type-card.selected::before {
  opacity: 0.08;
}

.card-icon-container {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  background: rgba(var(--accent-color), 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.card-icon {
  width: 24px;
  height: 24px;
  object-fit: contain;
}

.card-content {
  flex: 1;
  text-align: left;
}

.card-title {
  font-size: 14px;
  font-weight: 600;
  color: #333;
  margin-bottom: 2px;
  font-family: 'Cairo', sans-serif;
}

.card-description {
  font-size: 12px;
  color: #666;
  font-family: 'Cairo', sans-serif;
}

.card-check {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--accent-color);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transform: scale(0);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.order-type-card.selected .card-check {
  opacity: 1;
  transform: scale(1);
}

/* Delivery Partners Cards */
.delivery-partners-grid {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.delivery-partner-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 16px;
  background: white;
  border: 1px solid #e9ecef;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.delivery-partner-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.delivery-partner-card:hover {
  border-color: var(--partner-color);
  transform: translateX(4px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

.delivery-partner-card:hover::before {
  opacity: 1;
}

.delivery-partner-card.selected {
  border-color: var(--partner-color);
  background: var(--partner-bg);
  box-shadow: 0 4px 16px rgba(var(--partner-color), 0.15);
}

.partner-icon-container {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  background: var(--partner-bg);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.partner-icon {
  width: 24px;
  height: 24px;
  object-fit: contain;
}

.partner-content {
  flex: 1;
  text-align: left;
}

.partner-name {
  font-size: 14px;
  font-weight: 600;
  color: #333;
  margin-bottom: 2px;
  font-family: 'Cairo', sans-serif;
}

.partner-status {
  font-size: 11px;
  color: #28a745;
  font-weight: 500;
  font-family: 'Cairo', sans-serif;
}

.partner-badge {
  width: 16px;
  height: 16px;
  color: var(--partner-color);
  opacity: 0;
  transform: scale(0);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.delivery-partner-card.selected .partner-badge {
  opacity: 1;
  transform: scale(1);
}

/* Order Type Display Button Enhancement */
.order-type-display.clickable {
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border-radius: 8px;
  padding: 8px 16px;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(10px);
}

.order-type-display.clickable::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.order-type-display.clickable:hover {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.3);
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

.order-type-display.clickable:hover::before {
  opacity: 1;
}

.order-type-display.clickable:active {
  transform: translateY(0);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Responsive Design */
@media (max-width: 768px) {
  .professional-dropdown {
    width: 360px;
    right: -20px;
  }
  
  .order-types-grid {
    grid-template-columns: 1fr;
  }
  
  .dropdown-section {
    padding: 16px;
  }
  
  .order-type-card {
    padding: 12px;
  }
  
  .delivery-partner-card {
    padding: 10px 12px;
  }
}

@media (max-width: 480px) {
  .professional-dropdown {
    width: 320px;
    right: -40px;
  }
  
  .section-title {
    font-size: 14px;
  }
  
  .card-title,
  .partner-name {
    font-size: 13px;
  }
  
  .card-description {
    font-size: 11px;
  }
}

/* Scroll Styling */
.professional-dropdown::-webkit-scrollbar {
  width: 6px;
}

.professional-dropdown::-webkit-scrollbar-track {
  background: #f1f3f4;
  border-radius: 3px;
}

.professional-dropdown::-webkit-scrollbar-thumb {
  background: #c1c8cd;
  border-radius: 3px;
}

.professional-dropdown::-webkit-scrollbar-thumb:hover {
  background: #a8b2ba;
}







/* ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ŸÑŸÄ Header.css */

.customer-info-section {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 0 20px;
}

.customer-info-card {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border: 1px solid #dee2e6;
  border-radius: 8px;
  padding: 10px 16px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  max-width: 400px;
  width: 100%;
}

.customer-basic-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 4px;
}

.customer-name {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 600;
  color: #2c3e50;
  font-size: 14px;
}

.customer-phone {
  display: flex;
  align-items: center;
  gap: 4px;
  color: #6c757d;
  font-size: 12px;
}

.customer-address {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #495057;
  font-size: 12px;
  border-top: 1px solid #dee2e6;
  padding-top: 4px;
  margin-top: 4px;
}

.address-text {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.customer-icon,
.phone-icon,
.address-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.vip-badge {
  background: linear-gradient(135deg, #ffd700 0%, #ffed4a 100%);
  color: #8b4513;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Responsive ŸÑŸÑŸÄ customer info */
@media (max-width: 1200px) {
  .customer-info-section {
    margin: 0 10px;
  }
  
  .customer-info-card {
    padding: 8px 12px;
    max-width: 300px;
  }
  
  .customer-name {
    font-size: 13px;
  }
  
  .customer-phone,
  .customer-address {
    font-size: 11px;
  }
}

@media (max-width: 768px) {
  .customer-info-section {
    margin: 0 5px;
  }
  
  .customer-info-card {
    padding: 6px 10px;
    max-width: 250px;
  }
  
  .customer-name {
    font-size: 12px;
  }
  
  .customer-phone,
  .customer-address {
    font-size: 10px;
  }
  
  .address-text {
    max-width: 150px;
  }
}










===== src/Pages/pos/newSales/styles/OrderItemDetailsPopup.module.css =====
/* src/Pages/pos/newSales/components/OrderItemDetailsPopup.module.css */

.popupOverlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.orderItemDetails {
  background: white;
  border-radius: 12px;
  padding: 24px;
  width: 90%;
  max-width: 600px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* ÿßŸÑÿ≥ÿ∑ÿ± ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä ÿßŸÑŸàÿ≠ŸäÿØ */
.mainRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 0;
  border-bottom: 1px solid #eee;
}

/* ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸàÿßŸÑÿ≥ÿπÿ± ÿπŸÑŸâ ÿßŸÑŸäŸÖŸäŸÜ */
.productInfo {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  flex: 1;
}

.productName {
  font-size: 16px;
  font-weight: 600;
  color: #333;
}

.productSize {
  font-size: 12px;
  color: #666;
}

.unitPrice {
  font-size: 14px;
  font-weight: 600;
  color: #e74c3c;
}

/* ÿßŸÑŸÉŸÖŸäÿ© ŸÅŸä ÿßŸÑŸÜÿµ */
.quantityControls {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 0 0 auto;
}

.quantityBtn {
  width: 36px;
  height: 36px;
  border: 2px solid #ddd;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.quantityBtn:hover:not(:disabled) {
  border-color: #0373ed;
  background: #f8f9ff;
}

.quantityBtn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.quantityDisplay {
  font-size: 18px;
  font-weight: 600;
  color: #333;
  min-width: 30px;
  text-align: center;
}

/* ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿπŸÑŸâ ÿßŸÑÿ¥ŸÖÿßŸÑ */
.totalDisplay {
  flex: 0 0 auto;
}

.totalAmount {
  font-size: 18px;
  font-weight: 700;
  color: #e74c3c;
}

/* ÿ≠ŸÇŸÑ ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ */
.notesSection {
  width: 100%;
}

.notesInput {
  width: 100%;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
  resize: vertical;
  font-family: inherit;
  transition: border-color 0.2s ease;
}

.notesInput:focus {
  outline: none;
  border-color: #0373ed;
}

.notesInput::placeholder {
  color: #999;
}

/* ŸÇÿ≥ŸÖ ÿßŸÑÿÆÿµŸÖ */
.discountSection {
  width: 100%;
}

.discountInputs {
  display: flex;
  gap: 16px;
}

.discountField {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.discountField label {
  font-size: 14px;
  font-weight: 600;
  color: #333;
}

.discountInput {
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
  transition: border-color 0.2s ease;
  /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÖŸÜ number input */
  -moz-appearance: textfield;
}

.discountInput::-webkit-outer-spin-button,
.discountInput::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.discountInput:focus {
  outline: none;
  border-color: #0373ed;
}

/* ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ£ŸÉŸäÿØ ŸàÿßŸÑÿ•ŸÑÿ∫ÿßÿ° */
.actionButtons {
  display: flex;
  gap: 0;
  width: 100%;
  margin-top: 8px;
}

.confirmBtn,
.cancelBtn {
  flex: 1;
  padding: 16px;
  font-size: 16px;
  font-weight: 600;
  border: none;
  cursor: pointer;
  transition: all 0.2s ease;
}

.confirmBtn {
  background: #28a745;
  color: white;
  border-radius: 8px 0 0 8px;
}

.confirmBtn:hover {
  background: #218838;
}

.cancelBtn {
  background: #f8f9fa;
  color: #333;
  border-radius: 0 8px 8px 0;
  border-left: 1px solid #ddd;
}

.cancelBtn:hover {
  background: #e9ecef;
}

/* Responsive */
@media (max-width: 768px) {
  .mainRow {
    flex-direction: column;
    gap: 16px;
    align-items: stretch;
  }
  
  .productInfo {
    align-items: center;
    text-align: center;
  }
  
  .quantityControls {
    justify-content: center;
  }
  
  .totalDisplay {
    text-align: center;
  }
  
  .discountInputs {
    flex-direction: column;
  }
  
  .actionButtons {
    flex-direction: column;
  }
  
  .confirmBtn,
  .cancelBtn {
    border-radius: 8px;
  }
  
  .cancelBtn {
    border-left: none;
    border-top: 1px solid #ddd;
  }
}

===== src/Pages/pos/newSales/styles/OrderSummary.module.css =====
/* OrderSummary Module CSS */
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap');

:root {
  /* Colors */
  --primary-blue: #0373ed;
  --primary-green: #23a929;
  --primary-red: #e53935;
  --primary-orange: #ffb74d;
  --bg-main: #f5f5f5;
  --bg-white: #ffffff;
  --text-primary: #000000;
  --text-secondary: rgba(0, 0, 0, 0.7);
  --border-color: rgba(0, 0, 0, 0.2);
  
  /* Responsive spacing */
  --scale-factor: clamp(0.8, 1vw, 1.2);
  --spacing-xs: calc(0.25rem * var(--scale-factor));
  --spacing-sm: calc(0.5rem * var(--scale-factor));
  --spacing-md: calc(1rem * var(--scale-factor));
  --spacing-lg: calc(1.5rem * var(--scale-factor));
  --spacing-xl: calc(2rem * var(--scale-factor));
}

/* Main Container */
.orderSummary {
  width: clamp(280px, 35vw, 400px);
  background: var(--bg-white);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 2px 16px rgba(0, 0, 0, 0.1);
  flex-shrink: 0;
}

/* Header Section */
.orderHeader {
  height: clamp(50px, 7vh, 80px);
  display: flex;
  flex-shrink: 0;
}

.orderNumber {
  flex: 1;
  background: var(--primary-blue);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(16px, 2vw, 24px);
  font-weight: 700;
  border-radius: 8px 0 0 0;
}

.orderTotal {
  width: clamp(100px, 12vw, 150px);
  border: 2px solid var(--primary-blue);
  color: var(--primary-blue);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  border-radius: 0 8px 0 0;
}

.orderTotal .amount {
  font-size: clamp(16px, 2vw, 24px);
  font-weight: 700;
}

.orderTotal .currency {
  font-size: clamp(10px, 1.2vw, 16px);
  font-weight: 600;
}

/* Content Section */
.orderContent {
  flex: 1;
  padding: var(--spacing-lg);
  overflow-y: auto;
  scrollbar-width: none;
  scrollbar-color: var(--border-color) transparent;
}

.orderContent::-webkit-scrollbar {
  width: 6px;
}

.orderContent::-webkit-scrollbar-track {
  background: transparent;
}

.orderContent::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

/* Customer Input */
.customerInput {
  display: flex;
  margin-bottom: var(--spacing-lg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  overflow: hidden;
}

.customerField {
  flex: 1;
  padding: var(--spacing-sm) var(--spacing-md);
  border: none;
  font-size: clamp(10px, 1.2vw, 14px);
  font-family: 'Cairo', sans-serif;
  background: transparent;
}

.customerField:focus {
  outline: none;
}

.customerButton {
  width: clamp(30px, 4vw, 45px);
  background: var(--primary-blue);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s ease;
}

.customerButton:hover {
  background: #025bb5;
}

.customerButton img {
  width: clamp(12px, 1.4vw, 18px);
  height: clamp(12px, 1.4vw, 18px);
}

/* Order Items */
.orderItems {
  max-height: 50vh;
  margin-bottom: var(--spacing-md);
  scrollbar-width: thin;
  scrollbar-color: var(--border-color) transparent;
}

.orderItems::-webkit-scrollbar {
  width: 4px;
}

.orderItems::-webkit-scrollbar-track {
  background: transparent;
}

.orderItems::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

/* Order Item Container - ÿßŸÑÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä ŸÑŸÑŸÅÿßÿµŸÑ */
.orderItemContainer {
  margin-bottom: clamp(12px, 1.5vw, 16px); /* ŸÖÿ≥ÿßŸÅÿ© ÿ®ŸäŸÜ ŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÅŸÇÿ∑ */
  border-bottom: 1px solid rgba(0, 0, 0, 0.1); /* ÿÆÿ∑ ŸÅÿßÿµŸÑ ÿ®ŸäŸÜ ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ */
  padding-bottom: clamp(8px, 1vw, 12px);
}

.orderItemContainer:last-child {
  border-bottom: none; /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿÆÿ∑ ŸÖŸÜ ÿ¢ÿÆÿ± ÿπŸÜÿµÿ± */
}

/* Main Order Item */
.orderItem {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  cursor: pointer;
  transition: all 0.3s ease;
  border-radius: 6px;
  margin-bottom: 0; /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿßŸÑÿ≥ŸÅŸÑŸäÿ© */
}

.orderItem:hover {
  background: rgba(0, 0, 0, 0.05);
}

.orderItem.selected {
  background: rgba(3, 115, 237, 0.1);
  border-left: 20px solid #0373ed;
  padding-left: 8px;
  position: relative;
}

/* ÿ≠ÿ±ŸÅ X ŸÑŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
.orderItem.selected::before {
  content: '‚úï';
  position: absolute;
  left: -20px; /* ÿØÿßÿÆŸÑ ÿßŸÑŸÄ border ÿ®ÿßŸÑÿ≥ÿßŸÑÿ® */
  top: 0;
  bottom: 0;
  width: 20px;
  color: white;
  font-size: 16px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 1;
  background: transparent;
  transition: all 0.2s ease;
}

/* ÿ™ÿ£ÿ´Ÿäÿ± hover ŸÑŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
.orderItem.selected:hover::before {
  background: rgba(255, 255, 255, 0.1);
  font-size: 18px;
  transform: scale(1.1);
}

.orderItem.extraItem {
  border-left: 3px solid #28a745;
}

.orderItem.withoutItem {
  border-left: 3px solid #dc3545;
}

/* Item Details */
.itemDetails {
  display: flex;
  gap: var(--spacing-sm);
  align-items: flex-start;
  flex: 1;
  min-width: 0;
}

.deleteButton {
    order: -1; /* ÿ£ŸàŸÑ ÿπŸÜÿµÿ± */

  background: none;
  border: none;
  cursor: pointer;
  padding: var(--spacing-xs);
  border-radius: 4px;
  transition: background 0.2s ease;
}

.deleteButton:hover {
  background: rgba(229, 57, 53, 0.1);
}

.deleteButton img {
  width: clamp(12px, 1.4vw, 16px);
  height: clamp(12px, 1.4vw, 16px);
}

.itemInfo {
  flex: 1;
  min-width: 0;
}

.itemName {
  font-size: clamp(11px, 1.3vw, 16px);
  font-weight: 600;
  margin-bottom: var(--spacing-xs);
  color: var(--text-primary);
  line-height: 1.2;
  font-family: 'Cairo', sans-serif;
}

.itemSizeInline {
  color: var(--primary-blue);
  font-weight: 500;
  font-size: 0.9em;
}

/* Item Prices - ÿßŸÑÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä ŸÑŸÑÿ£ÿ≥ÿπÿßÿ± */
.itemPrices {
  display: flex;
  align-items: center;
  gap: clamp(6px, 1vw, 10px);
  flex-shrink: 0;
  min-width: fit-content;
}

.itemPrice {
  font-size: clamp(10px, 1.2vw, 14px);
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  padding-right: clamp(6px, 1vw, 10px);
  border-right: 1px solid #ccc; /* ÿßŸÑÿÆÿ∑ ÿßŸÑÿπŸÖŸàÿØŸä ÿßŸÑŸÅÿßÿµŸÑ */
}

.itemTotal {
  font-size: clamp(11px, 1.3vw, 16px);
  font-weight: 700;
  color: var(--primary-blue);
  white-space: nowrap;
  padding-left: clamp(6px, 1vw, 10px);
}

.itemTotal.negative {
  color: #dc3545;
  font-weight: 600;
}

/* Badges */
.extraBadge, .withoutBadge {
  color: white;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 10px;
  margin-right: 4px;
  font-weight: 600;
}

.extraBadge {
  background: #28a745;
}

.withoutBadge {
  background: #dc3545;
}

/* Sub-items Container - ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÅÿßÿµŸÑ ŸÖÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
.subItemsContainer {
  margin-top: 0; /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿßŸÑÿπŸÑŸàŸäÿ© */
  padding-left: 16px;
  border-left: 2px solid #f0f0f0;
}

/* Sub-item */
.subItem {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1px 0;
  margin-bottom: 0px;
  min-height: 18px;
  cursor: pointer;
  transition: all 0.3s ease;
  border-radius: 4px;
  position: relative;
}


.subItem {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1px 0;
  margin-bottom: 0px;
  min-height: 18px;
  cursor: pointer;
  transition: all 0.3s ease;
  border-radius: 4px;
  position: relative;
}

/* Sub-item ÿßŸÑŸÖÿ≠ÿØÿØ - ŸÖÿπ border ÿ£ŸÉÿ®ÿ± */
.selectedSubItem {
  background: rgba(3, 115, 237, 0.1);
  border-left: 20px solid #0373ed;
  padding-left: 8px;
  position: relative;
}
.selectedSubItem::before {
  content: '‚úï';
  position: absolute;
  left: -20px; /* ÿØÿßÿÆŸÑ ÿßŸÑŸÄ border ÿ®ÿßŸÑÿ≥ÿßŸÑÿ® */
  top: 0;
  bottom: 0;
  width: 20px;
  color: white;
  font-size: 14px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 1;
  background: transparent;
  transition: all 0.2s ease;
}

/* ÿ™ÿ£ÿ´Ÿäÿ± hover ŸÑŸÑŸÄ sub-item */
.selectedSubItem:hover::before {
  background: rgba(255, 255, 255, 0.1);
  font-size: 16px;
  transform: scale(1.1);
}

/* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ∂ÿ∫ÿ∑ ŸÑŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÖÿ≠ÿØÿØÿ© */
.orderItem.selected:active::before,
.selectedSubItem:active::before {
  transform: scale(0.9);
  background: rgba(0, 0, 0, 0.2);
}

/* ÿßŸÑŸÄ options ŸÑÿß ÿ™ÿ£ÿÆÿ∞ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÄ hover */
.subItem[data-type="option"] {
  cursor: default;
}

.subItem[data-type="option"]:hover {
  background: initial;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑÿ™ÿßÿ®ŸÑÿ™ */
@media (max-width: 1024px) {
  .orderItem.selected,
  .selectedSubItem {
    border-left: 35px solid #0373ed;
  }
  
  .orderItem.selected::before,
  .selectedSubItem::before {
    width: 35px;
    font-size: 15px;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ */
@media (max-width: 768px) {
  .orderItem.selected,
  .selectedSubItem {
    border-left: 38px solid #0373ed;
  }
  
  .orderItem.selected::before,
  .selectedSubItem::before {
    width: 38px;
    font-size: 16px;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿßŸã */
@media (max-width: 480px) {
  .orderItem.selected,
  .selectedSubItem {
    border-left: 40px solid #0373ed;
  }
  
  .orderItem.selected::before,
  .selectedSubItem::before {
    width: 40px;
    font-size: 17px;
  }
}

.subItemDetails {
  display: flex;
  align-items: center;
  gap: 6px;
  flex: 1;
}

.subItemInfo {
  display: flex;
  align-items: center;
  gap: 4px;
  flex: 1;
}

.subItemBadge {
  width: 12px; /* ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ≠ÿ¨ŸÖ ŸÇŸÑŸäŸÑÿßŸã */
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 7px;
  font-weight: 600;
  color: white;
  flex-shrink: 0;
  transition: all 0.2s ease;
}

.subItemBadge.extra {
  background: #28a745;
}

.subItemBadge.without {
  background: #dc3545;
}

.subItemBadge.option {
  background: #6c757d;
}

.subItemName {
  font-size: 10px;
  color: #666;
  line-height: 1.2;
  font-family: 'Cairo', sans-serif;
}

/* Sub-item Prices - ŸÜŸÅÿ≥ ÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
.subItemPrices {
  display: flex;
  align-items: center;
  gap: clamp(4px, 0.8vw, 8px);
  min-width: fit-content;
}

.subItemPrice {
  font-size: 8px;
  color: #999;
  font-weight: 500;
  white-space: nowrap;
  padding-right: clamp(4px, 0.8vw, 8px);
  border-right: 1px solid #ddd; /* ÿßŸÑÿÆÿ∑ ÿßŸÑÿπŸÖŸàÿØŸä ÿßŸÑŸÅÿßÿµŸÑ */
}

.subItemTotal {
  font-size: 9px;
  color: #333;
  font-weight: 600;
  white-space: nowrap;
  padding-left: clamp(4px, 0.8vw, 8px);
}

.subItemTotal.negative {
  color: #dc3545;
}

.subItemDelete {
  width: 14px;
  height: 14px;
  border: none;
  background: transparent;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.6;
  transition: opacity 0.2s ease;
  margin-left: 4px;
}

.subItemDelete:hover {
  opacity: 1;
}

.subItemDelete img {
  width: 8px;
  height: 8px;
}

/* Item Options - ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÅÿßÿµŸÑ ŸÖÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
.itemOptions {
  margin-top: 0; /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿßŸÑÿπŸÑŸàŸäÿ© */
  padding-left: 16px;
}

.optionDetail {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1px;
  padding: 2px 0;
  min-height: 18px;
}

.optionText {
  font-size: 10px;
  color: #666;
  font-weight: 400;
  line-height: 1.2;
  font-family: 'Cairo', sans-serif;
  flex: 1;
}

/* Option Prices - ŸÜŸÅÿ≥ ÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
.optionPrices {
  display: flex;
  align-items: center;
  gap: clamp(4px, 0.8vw, 8px);
  min-width: fit-content;
}

.optionPrice {
  font-size: 8px;
  color: #999;
  font-weight: 500;
  white-space: nowrap;
  padding-right: clamp(4px, 0.8vw, 8px);
  border-right: 1px solid #ddd; /* ÿßŸÑÿÆÿ∑ ÿßŸÑÿπŸÖŸàÿØŸä ÿßŸÑŸÅÿßÿµŸÑ */
}

.optionTotal {
  font-size: 9px;
  color: #333;
  font-weight: 600;
  white-space: nowrap;
  padding-left: clamp(4px, 0.8vw, 8px);
}

/* Order Footer */
.orderFooter {
  padding: var(--spacing-md);
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
}

.summaryRows {
  display: flex;
  flex-direction: column;
  gap: calc(var(--spacing-sm) * 0.8);
  margin-bottom: var(--spacing-md);
}

.summaryRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(10px, 1.2vw, 15px);
  font-weight: 500;
  line-height: 1.3;
}

.summaryRow span:last-child {
  font-weight: 700;
  color: var(--text-primary);
}

.totalRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(13px, 1.5vw, 19px);
  font-weight: 700;
  padding-top: var(--spacing-md);
  border-top: 2px solid var(--border-color);
  margin-bottom: var(--spacing-md);
}

.actionButtons {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--spacing-md);
}

.actionButton {
  height: clamp(40px, 7vh, 60px);
  border-radius: 6px;
  border: none;
  color: white;
  font-size: clamp(10px, 1.2vw, 16px);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.actionButton img {
  width: clamp(12px, 1.4vw, 18px);
  height: clamp(12px, 1.4vw, 18px);
}

.actionButton:hover {
  opacity: 0.9;
  transform: translateY(-1px);
}

.actionButton.send {
  background: var(--primary-red);
}

.actionButton.print {
  background: var(--primary-blue);
}

.actionButton.pay {
  background: var(--primary-green);
}

/* Responsive Design */
@media (max-width: 1366px) {
  .summaryRows {
    gap: calc(var(--spacing-sm) * 0.6);
  }
  
  .orderItems {
    max-height: 45vh;
  }
}

@media (max-width: 1024px) {
  .summaryRows {
    gap: calc(var(--spacing-sm) * 0.4);
  }
  
  .orderItems {
    max-height: 42vh;
  }
  
  .itemPrices, .subItemPrices, .optionPrices {
    gap: 4px;
  }
}

@media (max-width: 768px) {
  .subItemName {
    font-size: 9px;
  }
  
  .subItemPrice {
    font-size: 7px;
  }
  
  .subItemTotal {
    font-size: 8px;
  }
  
  .subItemDelete {
    width: 12px;
    height: 12px;
  }
  
  .subItemDelete img {
    width: 6px;
    height: 6px;
  }
  
  .optionText {
    font-size: 9px;
  }
  
  .optionPrice {
    font-size: 7px;
  }
  
  .optionTotal {
    font-size: 8px;
  }
}

@media (max-width: 480px) {
  .orderItemContainer {
    margin-bottom: 8px;
  }
  
  .subItem {
    padding: 1px 0;
    margin-bottom: 0px;
    min-height: 16px;
  }
  
  .optionDetail {
    padding: 1px 0;
    margin-bottom: 0px;
    min-height: 14px;
  }
  
  .itemPrices, .subItemPrices, .optionPrices {
    gap: 3px;
  }
}


/* Comments Container */
.commentsContainer {
  margin-top: 0;
  padding-left: 16px;
  border-left: 2px solid #e3f2fd;
}

.commentItem {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  padding: 3px 0;
  margin-bottom: 2px;
  min-height: 20px;
}

.commentIcon {
  font-size: 10px;
  color: #2196f3;
  margin-top: 1px;
  flex-shrink: 0;
}

.commentText {
  font-size: 10px;
  color: #2196f3;
  line-height: 1.3;
  font-family: 'Cairo', sans-serif;
  font-style: italic;
  word-wrap: break-word;
  flex: 1;
}

/* Responsive ŸÑŸÑÿ™ÿπŸÑŸäŸÇÿßÿ™ */
@media (max-width: 768px) {
  .commentText {
    font-size: 9px;
  }
  
  .commentIcon {
    font-size: 9px;
  }
}

@media (max-width: 480px) {
  .commentItem {
    padding: 2px 0;
    margin-bottom: 1px;
    min-height: 16px;
  }
  
  .commentText {
    font-size: 8px;
  }
  
  .commentIcon {
    font-size: 8px;
  }
}










/* ÿ≤ÿ± ÿßŸÑÿ≠ÿ∞ŸÅ ÿßŸÑŸÖÿØŸÖÿ¨ */
.deleteButtonInline {
  background: #dc3545;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 2px 6px;
  font-size: 10px;
  font-weight: 600;
  cursor: pointer;
  margin-left: 8px;
  transition: all 0.2s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 18px;
  height: 16px;
}

.deleteButtonInline:hover {
  background: #c82333;
  transform: scale(1.1);
}

/* ÿ™ÿ≠ÿØŸäÿ´ SubItem ŸÑÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿßÿ™ */
.subItem {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1px 0; /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© */
  margin-bottom: 0px; /* ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿßŸÑÿ≥ŸÅŸÑŸäÿ© */
  min-height: 18px; /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿßÿ±ÿ™ŸÅÿßÿπ */
  cursor: pointer;
}

.subItem:hover {
  background: rgba(0, 0, 0, 0.02);
}

.subItemName {
  font-size: 10px;
  color: #666;
  line-height: 1.1; /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿ®ŸäŸÜ ÿßŸÑÿ£ÿ≥ÿ∑ÿ± */
  font-family: 'Cairo', sans-serif;
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

/* ÿ™ÿ≠ÿØŸäÿ´ OrderItemContainer ŸÑÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© */
.orderItemContainer {
  margin-bottom: clamp(6px, 1vw, 10px); /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© */
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: clamp(4px, 0.8vw, 8px); /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© */
}

/* ÿ™ÿ≠ÿØŸäÿ´ SubItemsContainer */
.subItemsContainer {
  margin-top: -2px; /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÅÿ¨Ÿàÿ© ŸÖÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä */
  padding-left: 12px; /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿßŸÑŸäÿ≥ÿ±Ÿâ */
  border-left: 2px solid #f0f0f0;
}

/* ÿ™ÿ≠ÿØŸäÿ´ SubItemDetails */
.subItemDetails {
  display: flex;
  align-items: center;
  gap: 4px; /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© */
  flex: 1;
}

.subItemInfo {
  display: flex;
  align-items: center;
  gap: 3px; /* ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© */
  flex: 1;
}

.subItemBadge {
  width: 12px; /* ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ≠ÿ¨ŸÖ ŸÇŸÑŸäŸÑÿßŸã */
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 7px;
  font-weight: 600;
  color: white;
  flex-shrink: 0;
  transition: all 0.2s ease;
}

/* ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÄ responsive */
@media (max-width: 768px) {
  .deleteButtonInline {
    font-size: 8px;
    padding: 1px 4px;
    min-width: 16px;
    height: 14px;
  }
  
  .subItem {
    min-height: 16px;
  }
  
  .subItemName {
    font-size: 9px;
  }
}

@media (max-width: 480px) {
  .deleteButtonInline {
    font-size: 7px;
    padding: 1px 3px;
    min-width: 14px;
    height: 12px;
  }
  
  .subItem {
    min-height: 14px;
  }
  
  .subItemName {
    font-size: 8px;
  }
  
  .orderItemContainer {
    margin-bottom: 4px;
    padding-bottom: 4px;
  }
  
  .subItemsContainer {
    padding-left: 8px;
  }
}









/* ÿ™ÿ≠ÿØŸäÿ´ SubItemBadge */
.subItemBadge {
  width: 12px; /* ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ≠ÿ¨ŸÖ ŸÇŸÑŸäŸÑÿßŸã */
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 7px;
  font-weight: 600;
  color: white;
  flex-shrink: 0;
  transition: all 0.2s ease;
}

/* ÿ≠ÿßŸÑÿ© ÿßŸÑÿ≠ÿ∞ŸÅ - ŸäŸÉÿ®ÿ± ŸàŸäÿµÿ®ÿ≠ ŸÇÿßÿ®ŸÑ ŸÑŸÑŸÜŸÇÿ± */
.subItemBadge.deletable {
  width: 18px;
  height: 18px;
  font-size: 10px;
  cursor: pointer;
  transform: scale(1.1);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.subItemBadge.deletable:hover {
  transform: scale(1.2);
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
}

.subItemBadge.deletable:active {
  transform: scale(1.0);
}
/* ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÄ badges */
.subItemBadge.extra {
  background: #28a745;
}

.subItemBadge.extra.deletable {
  background: #dc3545; /* ÿ£ÿ≠ŸÖÿ± ŸÑŸÑÿ≠ÿ∞ŸÅ */
}

.subItemBadge.without {
  background: #dc3545;
}

.subItemBadge.without.deletable {
  background: #dc3545; /* Ÿäÿ®ŸÇŸâ ÿ£ÿ≠ŸÖÿ± */
}

.subItemBadge.option {
  background: #6c757d;
}

.subItemBadge.option.deletable {
  background: #dc3545; /* ÿ£ÿ≠ŸÖÿ± ŸÑŸÑÿ≠ÿ∞ŸÅ */
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑÿ™ÿßÿ®ŸÑÿ™ */
@media (max-width: 1024px) {
  .subItemBadge.deletable {
    width: 22px; /* ÿ£ŸÉÿ®ÿ± ŸÑŸÑÿ™ÿßÿ®ŸÑÿ™ */
    height: 22px;
    font-size: 12px;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ */
@media (max-width: 768px) {
  .subItemBadge.deletable {
    width: 20px;
    height: 20px;
    font-size: 11px;
  }
}

@media (max-width: 480px) {
  .subItemBadge.deletable {
    width: 24px; /* ÿ£ŸÉÿ®ÿ± ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
    height: 24px;
    font-size: 12px;
  }
}















/* ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞Ÿá ÿßŸÑÿ£ŸÜŸÖÿßÿ∑ ŸÑŸÄ OrderSummary.module.css */

.customerInputContainer {
  position: relative;
  margin-bottom: var(--spacing-lg);
}

.customerInput {
  display: flex;
  border: 1px solid var(--border-color);
  border-radius: 6px;
  overflow: hidden;
}

.customerField {
  flex: 1;
  padding: var(--spacing-sm) var(--spacing-md);
  border: none;
  font-size: clamp(10px, 1.2vw, 14px);
  font-family: 'Cairo', sans-serif;
  background: transparent;
}

.customerField:focus {
  outline: none;
}

.customerButton {
  width: clamp(30px, 4vw, 45px);
  background: var(--primary-blue);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s ease;
}

.customerButton:hover {
  background: #025bb5;
}

.customerButton img {
  width: clamp(12px, 1.4vw, 18px);
  height: clamp(12px, 1.4vw, 18px);
}

/* Customer Dropdown Styles */
.customerDropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid var(--border-color);
  border-top: none;
  border-radius: 0 0 6px 6px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 1000;
  max-height: 300px;
  overflow-y: auto;
}

.dropdownHeader {
  padding: 8px 12px;
  background: #f8f9fa;
  border-bottom: 1px solid #e9ecef;
  font-size: 12px;
  font-weight: 600;
  color: #495057;
}

.customerOption {
  padding: 12px;
  cursor: pointer;
  border-bottom: 1px solid #f1f3f4;
  transition: background 0.2s ease;
}

.customerOption:hover {
  background: #f8f9fa;
}

.customerOption:last-child {
  border-bottom: none;
}

.customerInfo {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.customerName {
  font-weight: 600;
  font-size: 14px;
  color: #333;
}

.customerPhone {
  font-size: 12px;
  color: #666;
}

.customerDetails {
  font-size: 11px;
  color: #999;
}

.searchingMessage {
  padding: 16px;
  text-align: center;
  color: #666;
  font-size: 12px;
}

.noResults {
  padding: 16px;
  text-align: center;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.noResults span {
  color: #666;
  font-size: 12px;
}

.addNewCustomerBtn {
  background: var(--primary-blue);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  transition: background 0.2s ease;
}

.addNewCustomerBtn:hover {
  background: #025bb5;
}

/* Address Selection Dropdown */
.addressSelectionContainer {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid var(--border-color);
  border-top: none;
  border-radius: 0 0 6px 6px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 1001;
  max-height: 250px;
  overflow-y: auto;
}

.addressHeader {
  padding: 8px 12px;
  background: #e3f2fd;
  border-bottom: 1px solid #bbdefb;
  font-size: 12px;
  font-weight: 600;
  color: #1976d2;
}

.addressOption {
  padding: 12px;
  cursor: pointer;
  border-bottom: 1px solid #f1f3f4;
  transition: background 0.2s ease;
}

.addressOption:hover {
  background: #f8f9fa;
}

.addressOption:last-child {
  border-bottom: none;
}

.addressInfo {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.addressLine {
  font-weight: 600;
  font-size: 13px;
  color: #333;
}

.addressDetails {
  font-size: 11px;
  color: #666;
}

.addressLandmark {
  font-size: 10px;
  color: #999;
  font-style: italic;
}

/* Selected Customer Display */
.selectedCustomerInfo {
  background: #e3f2fd;
  border: 1px solid #bbdefb;
  border-radius: 4px;
  padding: 8px 12px;
  margin-bottom: var(--spacing-md);
}

.customerDisplayName {
  font-weight: 600;
  font-size: 13px;
  color: #1976d2;
  margin-bottom: 4px;
}

.selectedAddressInfo {
  font-size: 11px;
  color: #1976d2;
  opacity: 0.8;
}

/* Responsive */
@media (max-width: 768px) {
  .customerDropdown,
  .addressSelectionContainer {
    max-height: 200px;
  }
  
  .customerOption,
  .addressOption {
    padding: 8px;
  }
  
  .customerName,
  .addressLine {
    font-size: 12px;
  }
  
  .customerPhone,
  .addressDetails {
    font-size: 10px;
  }
}






.selectedOption {
  background-color: #007bff !important;
  color: white !important;
}

.selectedOption .customerName,
.selectedOption .customerPhone,
.selectedOption .customerDetails {
  color: white !important;
}

.customerDropdown {
  max-height: 300px;
  overflow-y: auto;
  border: 1px solid #ccc;
  border-radius: 4px;
  background: white;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.customerOption {
  padding: 12px;
  cursor: pointer;
  border-bottom: 1px solid #eee;
  transition: background-color 0.2s;
}

.customerOption:hover {
  background-color: #f5f5f5;
}

.customerOption:last-child {
  border-bottom: none;
}



/* ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ */
.customerField:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

.customerButton:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.selectedOption {
  background-color: #007bff !important;
  color: white;
}

.selectedOption .customerName,
.selectedOption .customerPhone,
.selectedOption .customerDetails {
  color: white;
}

.addNewCustomerBtn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.searchingMessage {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  color: #666;
  font-size: 14px;
  justify-content: center;
}

.loadingSpinner {
  width: 16px;
  height: 16px;
  border: 2px solid #f3f3f3;
  border-top: 2px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}





/* ÿ•ÿ∂ÿßŸÅÿ© styles ŸÑŸÑÿ≠ÿßŸÑÿ© ÿßŸÑÿÆÿßÿµÿ© ÿ®ŸÄ Takeaway */
.takeawayButtons {
  display: flex;
  justify-content: center;
}

.takeawayButtons .actionButton.pay.fullWidth {
  flex: 1;
  min-width: 100%;
  max-width: 100%;
}

/* ŸÑŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ ÿßŸÑÿ≤ÿ± Ÿäÿ£ÿÆÿ∞ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑŸÉÿßŸÖŸÑ */
.actionButton.fullWidth {
  width: 100% !important;
  flex-grow: 1;
}

===== src/Pages/pos/newSales/styles/PaymentPopup.module.css =====
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.popup {
  background: #f5f5f5;
  width: clamp(90vw, 95vw, 1800px);
  height: clamp(85vh, 90vh, 1200px);
  border-radius: clamp(8px, 1.5vw, 16px);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

/* Header */
.header {
  background: white;
  height: clamp(60px, 10vh, 80px);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 clamp(20px, 4vw, 40px);
  border-bottom: 2px solid #e9ecef;
  position: relative;
}

.logo {
  display: flex;
  align-items: center;
}

.logo img {
  height: clamp(40px, 8vh, 60px);
  width: auto;
}

.title {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  font-family: "Cairo-Bold", Helvetica;
  font-weight: 700;
  color: #333;
  font-size: clamp(18px, 3vw, 24px);
  margin: 0;
  direction: rtl;
}

.closeBtn {
  background: #ff6b6b;
  color: white;
  border: none;
  width: clamp(30px, 5vw, 40px);
  height: clamp(30px, 5vw, 40px);
  border-radius: 50%;
  font-size: clamp(18px, 3vw, 24px);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.closeBtn:hover {
  background: #ff5252;
  transform: scale(1.1);
}

/* ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
.content {
  flex: 1;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: clamp(10px, 2vw, 20px);
  padding: clamp(10px, 2vw, 20px);
  overflow: hidden;
  min-height: 0;
}

/* ÿßŸÑÿ£ÿ¨ÿ≤ÿßÿ° ÿßŸÑÿ´ŸÑÿßÿ´ÿ© */
.leftSection,
.centerSection,
.rightSection {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
  border-radius: clamp(8px, 1.5vw, 12px);
  overflow: hidden;
}




/* Responsive Design ŸÑÿ¨ŸÖŸäÿπ ÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸÉŸÖÿ®ŸäŸàÿ™ÿ±/ÿßŸÑŸÑÿßÿ®ÿ™Ÿàÿ® */

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© ÿ¨ÿØÿßŸã 2560px+ */
@media (min-width: 2560px) {
  .popup {
    width: 85vw;
    height: 85vh;
  }
  
  .content {
    gap: clamp(20px, 2.5vw, 30px);
    padding: clamp(20px, 2.5vw, 30px);
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© 1920px - 2559px */
@media (max-width: 2559px) and (min-width: 1920px) {
  .popup {
    width: 90vw;
    height: 88vh;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÇŸäÿßÿ≥Ÿäÿ© 1680px - 1919px */
@media (max-width: 1919px) and (min-width: 1680px) {
  .popup {
    width: 92vw;
    height: 90vh;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÖÿ™Ÿàÿ≥ÿ∑ÿ© 1440px - 1679px */
@media (max-width: 1679px) and (min-width: 1440px) {
  .popup {
    width: 95vw;
    height: 92vh;
  }
  
  .content {
    gap: clamp(12px, 1.8vw, 18px);
    padding: clamp(12px, 1.8vw, 18px);
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ÿµÿ∫Ÿäÿ±ÿ© 1366px - 1439px */
@media (max-width: 1439px) and (min-width: 1366px) {
  .popup {
    width: 98vw;
    height: 95vh;
  }
  
  .header {
    height: clamp(50px, 8vh, 70px);
    padding: 0 clamp(15px, 3vw, 30px);
  }
  
  .content {
    gap: clamp(10px, 1.5vw, 15px);
    padding: clamp(10px, 1.5vw, 15px);
  }
}

/* ŸÑÿßÿ®ÿ™Ÿàÿ® ŸÉÿ®Ÿäÿ± 1280px - 1365px */
@media (max-width: 1365px) and (min-width: 1280px) {
  .popup {
    width: 99vw;
    height: 98vh;
    border-radius: clamp(6px, 1vw, 12px);
  }
  
  .header {
    height: clamp(50px, 7vh, 65px);
  }
  
  .content {
    gap: clamp(8px, 1.2vw, 12px);
    padding: clamp(8px, 1.2vw, 12px);
  }
}

/* ŸÑÿßÿ®ÿ™Ÿàÿ® ŸÖÿ™Ÿàÿ≥ÿ∑ 1024px - 1279px */
@media (max-width: 1279px) and (min-width: 1024px) {
  .popup {
    width: 100vw;
    height: 100vh;
    border-radius: 0;
  }
  
  .header {
    height: clamp(45px, 6vh, 60px);
    padding: 0 clamp(12px, 2vw, 20px);
  }
  
  .logo img {
    height: clamp(35px, 6vh, 50px);
  }
  
  .title {
    font-size: clamp(16px, 2.5vw, 20px);
  }
  
  .closeBtn {
    width: clamp(28px, 4vw, 35px);
    height: clamp(28px, 4vw, 35px);
    font-size: clamp(16px, 2.5vw, 20px);
  }
  
  .content {
    gap: clamp(6px, 1vw, 10px);
    padding: clamp(6px, 1vw, 10px);
  }
}

/* ŸÑÿßÿ®ÿ™Ÿàÿ® ÿµÿ∫Ÿäÿ±/ÿ™ÿßÿ®ŸÑÿ™ ŸÉÿ®Ÿäÿ± 768px - 1023px */
@media (max-width: 1023px) {
  .popup {
    width: 100vw;
    height: 100vh;
    border-radius: 0;
  }
  
  .header {
    height: clamp(40px, 5vh, 50px);
    padding: 0 clamp(10px, 1.5vw, 15px);
  }
  
  .logo img {
    height: clamp(30px, 4vh, 40px);
  }
  
  .title {
    font-size: clamp(14px, 2vw, 18px);
  }
  
  .closeBtn {
    width: clamp(25px, 3.5vw, 30px);
    height: clamp(25px, 3.5vw, 30px);
    font-size: clamp(14px, 2vw, 18px);
  }
  
  .content {
    grid-template-columns: 1fr;
    grid-template-rows: minmax(0, 0.4fr) minmax(0, 1fr) minmax(0, 0.6fr);
    gap: clamp(5px, 0.8vw, 8px);
    padding: clamp(5px, 0.8vw, 8px);
  }
  
  .leftSection {
    order: 1;
    overflow-y: auto;
  }
  
  .centerSection {
    order: 2;
  }
  
  .rightSection {
    order: 3;
    overflow-y: auto;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿßŸã */
@media (max-width: 768px) {
  .content {
    grid-template-rows: minmax(200px, 30vh) 1fr minmax(150px, 25vh);
  }
}

@media (max-width: 480px) {
  .header {
    flex-direction: row;
    justify-content: space-between;
  }
  
  .title {
    position: static;
    transform: none;
    font-size: clamp(12px, 3vw, 16px);
  }
  
  .content {
    grid-template-rows: minmax(150px, 25vh) 1fr minmax(120px, 20vh);
  }
}


.loadingOverlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  border-radius: inherit;
}

.loadingContent {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  text-align: center;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.loadingContent p {
  margin-top: 1rem;
  font-family: 'Cairo', sans-serif;
  font-size: 1.1rem;
  color: #333;
}

===== src/Pages/pos/newSales/styles/popup.css =====
/* src/Pages/pos/newSales/styles/popup.css */
.popup-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  border-radius: 12px;
  width: 90%;
  max-width: 500px;
  max-height: 80vh;
  overflow: hidden;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

.popup-header {
  padding: 20px;
  border-bottom: 1px solid #eee;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.popup-title {
  font-size: 20px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
}

.popup-close {
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  border-radius: 6px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
}


.popup-close:hover {
  background: #f0f0f0;
  transform: scale(1.1);
}

.popup-close img {
  width: 20px;
  height: 20px;
}

.popup-close .MuiSvgIcon-root {
  font-size: 20px !important;
  color: var(--text-secondary) !important;
  transition: color 0.2s ease;
}

.popup-close:hover .MuiSvgIcon-root {
  color: var(--text-primary) !important;
}

.popup-body {
  padding: 20px;
}

.quantity-display {
  text-align: center;
  font-size: 18px;
  font-weight: 600;
  color: var(--primary-blue);
  margin-bottom: 20px;
  padding: 10px;
  background: #f8f9fa;
  border-radius: 8px;
}

.prices-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
}

.price-card {
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  padding: 20px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.price-card:hover {
  border-color: var(--primary-blue);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(3, 115, 237, 0.2);
}

.price-name {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  text-align: center;
}

.price-value {
  display: flex;
  align-items: baseline;
  gap: 5px;
}

.price-value .price {
  font-size: 20px;
  font-weight: 700;
  color: var(--primary-blue);
}

.price-value .currency {
  font-size: 14px;
  color: var(--text-secondary);
}

/* Responsive */
@media (max-width: 768px) {
  .popup-content {
    width: 95%;
    margin: 20px;
  }
  
  .prices-grid {
    grid-template-columns: 1fr;
  }
  
  .popup-header {
    padding: 15px;
  }
  
  .popup-body {
    padding: 15px;
  }
}



@media (max-width: 768px) {
  .popup-close {
    width: 32px;
    height: 32px;
    padding: 6px;
  }
  
  .popup-close .MuiSvgIcon-root {
    font-size: 18px !important;
  }
}


.options-popup {
  max-width: 600px;
  max-height: 85vh;
}

.popup-title-section {
  flex: 1;
}

.popup-subtitle {
  font-size: 14px;
  color: var(--text-secondary);
  margin-top: 4px;
}

.group-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
}

.group-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
}

.group-progress {
  font-size: 12px;
  color: var(--text-secondary);
  background: #f0f0f0;
  padding: 4px 8px;
  border-radius: 4px;
}

.group-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding: 10px;
  background: #f8f9fa;
  border-radius: 6px;
}

.selection-info {
  display: flex;
  align-items: center;
  gap: 10px;
}

.required-badge {
  background: var(--primary-red);
  color: white;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 500;
}

.selection-count {
  font-size: 14px;
  color: var(--text-primary);
  font-weight: 500;
}

.min-selection {
  font-size: 12px;
  color: var(--text-secondary);
}

.options-list {
  max-height: 300px;
  overflow-y: auto;
  margin-bottom: 20px;
}

.option-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  border: 1px solid #eee;
  border-radius: 8px;
  margin-bottom: 10px;
  transition: all 0.2s ease;
}

.option-item:hover {
  border-color: var(--primary-blue);
  background: #f8f9ff;
}

.option-info {
  flex: 1;
}

.option-name {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.option-price {
  font-size: 14px;
  color: var(--primary-green);
  font-weight: 500;
}

.comment-only {
  font-size: 12px;
  color: var(--text-secondary);
  font-style: italic;
}

.option-controls {
  display: flex;
  align-items: center;
}

.quantity-controls {
  display: flex;
  align-items: center;
  gap: 10px;
}

.quantity-btn {
  width: 32px;
  height: 32px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.quantity-btn:hover:not(:disabled) {
  border-color: var(--primary-blue);
  background: #f8f9ff;
}

.quantity-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.quantity-btn.plus {
  border-color: var(--primary-green);
  color: var(--primary-green);
}

.quantity-btn.minus {
  border-color: var(--primary-red);
  color: var(--primary-red);
}

.quantity-display {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
  min-width: 20px;
  text-align: center;
}

.select-btn {
  padding: 8px 16px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.select-btn:hover {
  border-color: var(--primary-blue);
  background: #f8f9ff;
}

.select-btn.selected {
  background: var(--primary-blue);
  color: white;
  border-color: var(--primary-blue);
}

.popup-footer {
  border-top: 1px solid #eee;
  padding: 15px 20px;
}

.footer-buttons {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

.footer-buttons button {
  padding: 10px 20px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-cancel {
  background: #f5f5f5;
  border: 1px solid #ddd;
  color: var(--text-primary);
}

.btn-cancel:hover {
  background: #e0e0e0;
}

.btn-back {
  background: #f8f9fa;
  border: 1px solid #ddd;
  color: var(--text-primary);
}

.btn-back:hover {
  background: #e9ecef;
}

.btn-skip {
  background: var(--primary-orange);
  border: 1px solid var(--primary-orange);
  color: white;
}

.btn-skip:hover {
  opacity: 0.9;
}

.btn-skip:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-next {
  background: var(--primary-blue);
  border: 1px solid var(--primary-blue);
  color: white;
}

.btn-next:hover:not(:disabled) {
  opacity: 0.9;
}

.btn-next:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ÿπÿ±ÿ∂ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ ŸÅŸä ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© */
.item-options {
  margin-top: 4px;
  padding-left: 10px;
}

.option-detail {
  margin-bottom: 2px;
}

.option-text {
  font-size: 11px;
  color: var(--text-secondary);
  font-weight: 400;
  line-height: 1.3;
}

/* Responsive */
@media (max-width: 768px) {
  .options-popup {
    width: 98%;
    max-height: 90vh;
  }
  
  .option-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 10px;
  }
  
  .option-controls {
    align-self: flex-end;
  }
  
  .footer-buttons {
    flex-wrap: wrap;
    gap: 8px;
  }
  
  .footer-buttons button {
    flex: 1;
    min-width: 80px;
  }
}
===== src/Pages/pos/newSales/styles/PriceSelectionPopup.module.css =====
/* src/Pages/pos/newSales/components/PriceSelectionPopup.module.css */

.popupOverlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: fadeIn 0.3s ease-out;
}

.popupContent {
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  width: 50%;
  max-height: 80vh;
  overflow-y: auto;
  animation: slideIn 0.3s ease-out;
}

.popupHeader {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #eee;
}

.popupTitle {
  font-size: 20px;
  font-weight: 600;
  color: #333;
  margin: 0;
}

.popupClose {
  width: 36px;
  height: 36px;
  border: none;
  background: #f5f5f5;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.popupClose:hover {
  background: #e9ecef;
  transform: scale(1.1);
}

.popupBody {
  padding: 20px;
}

.quantityDisplay {
  text-align: center;
  font-size: 16px;
  font-weight: 500;
  color: #666;
  margin-bottom: 20px;
  padding: 10px;
  background: #f8f9fa;
  border-radius: 6px;
}

.pricesGrid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 15px;
}

.priceCard {
  border: 2px solid #e9ecef;
  border-radius: 8px;
  padding: 20px;
  background: white;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.priceCard:hover {
  border-color: #0373ed;
  background: #f8f9ff;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(3, 115, 237, 0.2);
}

.priceName {
  font-size: 16px;
  font-weight: 600;
  color: #333;
  margin-bottom: 10px;
}

.priceValue {
  display: flex;
  align-items: center;
  gap: 8px;
  justify-content: center;
}

.price {
  font-size: 24px;
  font-weight: 700;
  color: #0373ed;
}

.currency {
  font-size: 14px;
  color: #666;
  font-weight: 500;
}

/* Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-50px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* Responsive */
@media (max-width: 768px) {
  .popupContent {
    width: 95%;
    margin: 10px;
  }
  
  .pricesGrid {
    grid-template-columns: 1fr;
  }
  
  .popupHeader {
    padding: 15px;
  }
  
  .popupBody {
    padding: 15px;
  }
  
  .popupTitle {
    font-size: 18px;
  }
}

===== src/Pages/pos/newSales/styles/ProductCard.module.css =====
/* src/Pages/pos/newSales/styles/ProductCard.module.css */

.productCard {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  height: auto; /* ÿ™ÿ∫ŸäŸäÿ± ŸÖŸÜ fixed height ÿ•ŸÑŸâ auto */
  min-height: 180px; /* ÿ≠ÿØ ÿ£ÿØŸÜŸâ ŸÑŸÑÿßÿ±ÿ™ŸÅÿßÿπ */
}

.productCard:hover {
  transform: translateY(-4px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.productCard:active {
  transform: translateY(-2px);
}

.productImageContainer {
  position: relative;
  width: 100%;
  height: 120px; /* ÿßÿ±ÿ™ŸÅÿßÿπ ÿ´ÿßÿ®ÿ™ ŸÑŸÑÿµŸàÿ±ÿ© */
  overflow: hidden;
}

.productImage {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.productCard:hover .productImage {
  transform: scale(1.05);
}

/* ÿßŸÑŸÜÿµ ÿßŸÑŸÖÿπÿ±Ÿàÿ∂ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ±ÿ© (ÿßŸÑÿ≥ÿπÿ±) */
.priceOverlay {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(3, 115, 237, 0.9);
  color: white;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  backdrop-filter: blur(4px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.productInfo {
  padding: 12px;
  flex: 1; /* Ÿäÿ£ÿÆÿ∞ ÿ®ÿßŸÇŸä ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑŸÖÿ™ÿßÿ≠ÿ© */
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
}

.productName {
  font-size: 14px;
  font-weight: 600;
  color: #333;
  margin: 0;
  line-height: 1.4;
  text-align: center;
  word-wrap: break-word;
  overflow-wrap: break-word;
  /* ÿ•ÿ≤ÿßŸÑÿ© height constraints ŸÑÿ™ÿ≥ŸÖÿ≠ ÿ®ÿßŸÑÿ™Ÿàÿ≥ÿπ */
}

/* Responsive Design */
@media (max-width: 1366px) {
  .productCard {
    min-height: 160px;
  }
  
  .productImageContainer {
    height: 100px;
  }
  
  .productName {
    font-size: 13px;
  }
  
  .priceOverlay {
    font-size: 11px;
    padding: 3px 6px;
  }
}

@media (max-width: 1024px) {
  .productCard {
    min-height: 140px;
  }
  
  .productImageContainer {
    height: 90px;
  }
  
  .productName {
    font-size: 12px;
  }
  
  .productInfo {
    padding: 10px;
  }
  
  .priceOverlay {
    font-size: 10px;
    padding: 2px 5px;
  }
}

@media (max-width: 768px) {
  .productCard {
    min-height: 120px;
  }
  
  .productImageContainer {
    height: 80px;
  }
  
  .productName {
    font-size: 11px;
  }
  
  .productInfo {
    padding: 8px;
  }
  
  .priceOverlay {
    font-size: 9px;
    padding: 2px 4px;
  }
}

@media (max-width: 480px) {
  .productCard {
    min-height: 100px;
  }
  
  .productImageContainer {
    height: 70px;
  }
  
  .productName {
    font-size: 10px;
  }
  
  .productInfo {
    padding: 6px;
  }
  
  .priceOverlay {
    font-size: 8px;
    padding: 1px 3px;
  }
}

===== src/Pages/pos/newSales/styles/ProductOptionsPopup.module.css =====
/* src/Pages/pos/newSales/components/ProductOptionsPopup.module.css */

.popupOverlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.popupContent {
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  max-width: 700px;
  width: 50%;
  max-height: 85vh;
  overflow-y: auto;
}

.popupHeader {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 20px;
  border-bottom: 1px solid #e9ecef;
  background: #f8f9fa;
}

.popupTitleSection {
  flex: 1;
}

.popupTitle {
  font-size: 18px;
  font-weight: 600;
  color: #333;
  margin: 0 0 5px 0;
  font-family: 'Cairo', sans-serif;
}

.popupSubtitle {
  font-size: 14px;
  color: #666;
  margin: 0;
  font-family: 'Cairo', sans-serif;
}

.popupClose {
  width: 32px;
  height: 32px;
  border: none;
  background: #e9ecef;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.popupClose:hover {
  background: #dee2e6;
  transform: scale(1.1);
}

.popupBody {
  padding: 20px;
}

.optionsContainer {
  display: flex;
  flex-direction: column;
  gap: 25px;
}

.optionGroup {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 20px;
  border-left: 4px solid #0373ed;
}

.groupHeader {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid #e9ecef;
}

.groupTitle {
  display: flex;
  align-items: center;
  gap: 10px;
}

.groupName {
  font-size: 16px;
  font-weight: 600;
  color: #333;
  font-family: 'Cairo', sans-serif;
}

.requiredBadge {
  background: #e74c3c;
  color: white;
  padding: 3px 8px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: 500;
  font-family: 'Cairo', sans-serif;
}

.groupInfo {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: #666;
  font-family: 'Cairo', sans-serif;
}

.selectionCount {
  font-weight: 600;
  color: #0373ed;
}

.minSelection {
  color: #666;
}

.optionsGrid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 12px;
}

.optionCard {
  background: white;
  border: 2px solid #e9ecef;
  border-radius: 12px;
  padding: 16px;
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.optionCard:hover {
  border-color: #0373ed;
  background: rgba(3, 115, 237, 0.05);
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(3, 115, 237, 0.15);
}

.optionCard.selected {
  border-color: #0373ed;
  background: rgba(3, 115, 237, 0.1);
  box-shadow: 0 4px 16px rgba(3, 115, 237, 0.2);
}

.optionContent {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
  text-align: center;
}

.optionInfo {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.optionName {
  font-size: 14px;
  font-weight: 600;
  color: #333;
  line-height: 1.3;
  font-family: 'Cairo', sans-serif;
}

.optionPrice {
  font-size: 12px;
  color: #e74c3c;
  font-weight: 500;
  font-family: 'Cairo', sans-serif;
}

.optionControls {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
}

/* ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÖÿ™ÿπÿØÿØÿ© */
.quantitySection {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  justify-content: center;
}

.removeBtn {
  width: 28px;
  height: 28px;
  border: none;
  border-radius: 50%;
  background: #dc3545;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  box-shadow: 0 2px 4px rgba(220, 53, 69, 0.2);
}

.removeBtn:hover {
  background: #c82333;
  transform: scale(1.1);
  box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
}

.quantityBadge {
  background: #0373ed;
  color: white;
  padding: 6px 12px;
  border-radius: 16px;
  font-size: 14px;
  font-weight: 600;
  min-width: 32px;
  text-align: center;
  font-family: 'Cairo', sans-serif;
  box-shadow: 0 2px 4px rgba(3, 115, 237, 0.2);
}

.addIcon {
  width: 32px;
  height: 32px;
  border: 2px dashed #0373ed;
  border-radius: 50%;
  color: #0373ed;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.optionCard:hover .addIcon {
  border-style: solid;
  background: rgba(3, 115, 237, 0.1);
}

.maxReached {
  padding: 6px 12px;
  background: #f8f9fa;
  border-radius: 16px;
  font-size: 12px;
  color: #666;
  font-family: 'Cairo', sans-serif;
}

/* ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÅÿ±ÿØŸäÿ© */
.singleSelect {
  display: flex;
  justify-content: center;
  align-items: center;
}

.selectedIcon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: #28a745;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 4px rgba(40, 167, 69, 0.2);
}

.unselectedIcon {
  width: 32px;
  height: 32px;
  border: 2px dashed #0373ed;
  border-radius: 50%;
  color: #0373ed;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.optionCard:hover .unselectedIcon {
  border-style: solid;
  background: rgba(3, 115, 237, 0.1);
}

.totalSection {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid #e9ecef;
}

.totalRow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 18px;
  font-weight: 600;
  font-family: 'Cairo', sans-serif;
}

.totalLabel {
  color: #333;
}

.totalValue {
  color: #0373ed;
}

.popupFooter {
  display: flex;
  gap: 12px;
  padding: 20px;
  border-top: 1px solid #e9ecef;
  background: #f8f9fa;
}

.btnCancel {
  flex: 1;
  padding: 12px;
  background: #f8f9fa;
  color: #666;
  border: 1px solid #ddd;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s ease;
  font-family: 'Cairo', sans-serif;
}

.btnCancel:hover {
  background: #e9ecef;
}

.btnConfirm {
  flex: 2;
  padding: 12px;
  background: #0373ed;
  color: white;
  border: 1px solid #0373ed;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s ease;
  font-family: 'Cairo', sans-serif;
}

.btnConfirm:hover:not(:disabled) {
  background: #0256c7;
}

.btnConfirm:disabled {
  background: #ccc;
  border-color: #ccc;
  cursor: not-allowed;
}

/* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÜŸÇÿ± */
.optionCard:active {
  transform: translateY(0);
  box-shadow: 0 2px 8px rgba(3, 115, 237, 0.2);
}

/* Responsive */
@media (max-width: 768px) {
  .popupContent {
    width: 98%;
    max-height: 90vh;
  }
  
  .optionsGrid {
    grid-template-columns: 1fr;
  }
  
  .groupHeader {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .popupFooter {
    flex-direction: column;
  }
  
  .optionGroup {
    padding: 15px;
  }
}

@media (max-width: 480px) {
  .popupHeader {
    padding: 15px;
  }
  
  .popupBody {
    padding: 15px;
  }
  
  .optionCard {
    padding: 12px;
  }
  
  .popupTitle {
    font-size: 16px;
  }
  
  .groupName {
    font-size: 14px;
  }
  
  .optionName {
    font-size: 13px;
  }
  
  .removeBtn {
    width: 24px;
    height: 24px;
  }
  
  .quantityBadge {
    padding: 4px 8px;
    font-size: 12px;
  }
  
  .selectedIcon,
  .unselectedIcon,
  .addIcon {
    width: 28px;
    height: 28px;
  }
}

===== src/Pages/pos/newSales/styles/responsive.css =====
/* src/Pages/pos/newSales/styles/responsive.css */
@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap');


html[dir="rtl"] .pos-system,
html[dir="rtl"] .pos-system * {
  direction: ltr !important;
}


/* ÿ™ÿ≠ÿØŸäÿØ ŸÜÿ∏ÿßŸÖ ÿßŸÑŸàÿ≠ÿØÿßÿ™ ÿßŸÑŸÖÿ±ŸÜ */
:root {
  --base-font-size: clamp(10px, 0.8vw, 16px);
  --scale-factor: clamp(0.8, 1vw, 1.2);
  
  /* Colors */
  --primary-blue: #0373ed;
  --primary-green: #23a929;
  --primary-red: #e53935;
  --primary-orange: #ffb74d;
  --bg-main: #f5f5f5;
  --bg-white: #ffffff;
  --text-primary: #000000;
  --text-secondary: rgba(0, 0, 0, 0.7);
  --border-color: rgba(0, 0, 0, 0.2);
  
  /* Responsive spacing */
  --spacing-xs: calc(0.25rem * var(--scale-factor));
  --spacing-sm: calc(0.5rem * var(--scale-factor));
  --spacing-md: calc(1rem * var(--scale-factor));
  --spacing-lg: calc(1.5rem * var(--scale-factor));
  --spacing-xl: calc(2rem * var(--scale-factor));
  --spacing-xxl: calc(3rem * var(--scale-factor));
  
  /* Component heights */
  --header-height: clamp(60px, 8vh, 100px);
  --keypad-height: clamp(80px, 8vh, 120px);
  --action-bar-height: clamp(50px, 7vh, 80px);
}

/* Reset and base styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;

}

html {
  font-size: var(--base-font-size);
  height: 100%;
}

body {
  font-family: 'Nunito', sans-serif;
  background-color: var(--bg-main);
  color: var(--text-primary);
  height: 100%;
  overflow: hidden;
    direction: ltr !important;

}

/* Main container */
.pos-system {
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
    direction: ltr !important;
}

/* Top Bar */
.top-bar {
  height: var(--header-height);
  background: var(--bg-white);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  flex-shrink: 0;
}

.top-bar-content {
  height: 100%;
  padding: 0 var(--spacing-xl);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.logo {
  height: 70%;
  width: auto;
  object-fit: contain;
}

.nav-items {
  display: flex;
  align-items: center;
  gap: var(--spacing-lg);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: 6px;
  text-decoration: none;
  color: var(--text-primary);
  font-size: clamp(12px, 1.2vw, 18px);
  font-weight: 500;
  transition: all 0.2s ease;
}

.nav-item:hover {
  background: rgba(3, 115, 237, 0.1);
}

.nav-item.active {
  color: var(--primary-blue);
}

.nav-item img {
  width: clamp(16px, 1.8vw, 24px);
  height: clamp(16px, 1.8vw, 24px);
}

.order-type-select {
  padding: var(--spacing-sm) var(--spacing-md);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  font-size: clamp(12px, 1.2vw, 16px);
  font-family: 'Nunito', sans-serif;
  background: var(--bg-white);
  min-width: 120px;
}

.menu-button {
  padding: var(--spacing-sm);
  background: transparent;
  border: none;
  cursor: pointer;
  border-radius: 6px;
  transition: background 0.2s ease;
}

.menu-button:hover {
  background: rgba(0, 0, 0, 0.05);
}

.menu-button img {
  width: clamp(20px, 2vw, 28px);
  height: clamp(20px, 2vw, 28px);
}

/* Main Content */
.main-content {
  flex: 1;
  display: flex;
  gap: var(--spacing-md);
  padding: var(--spacing-md);
  overflow: hidden;
}

/* Products Section */
.products-section {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  overflow: hidden;
}

/* Number Pad Bar */
.number-pad-bar {
  height: var(--keypad-height);
  display: flex;
  background: var(--bg-white);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  flex-shrink: 0;
}

.keypad-grid {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(12, 1fr);
  gap: 1px;
  background: var(--border-color);
}

.keypad-key {
  background: var(--bg-white);
  border: none;
  font-size: clamp(18px, 2.5vw, 32px);
  font-weight: 600;
  color: var(--text-primary);
  cursor: pointer;
  transition: background 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.keypad-key:hover {
  background: #f8f9fa;
}

.keypad-display {
  width: clamp(120px, 15vw, 200px);
  background: var(--primary-blue);
  color: white;
  font-size: clamp(20px, 2.8vw, 36px);
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

/* Action Buttons Bar */
.action-buttons-bar {
  height: var(--action-bar-height);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--spacing-md);
  flex-shrink: 0;
}

.action-chips {
  display: flex;
  gap: var(--spacing-md);
}

.action-chip {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: 6px;
  border: none;
  color: white;
  font-size: clamp(12px, 1.4vw, 18px);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  height: 100%;
}

.action-chip img {
  width: clamp(14px, 1.6vw, 20px);
  height: clamp(14px, 1.6vw, 20px);
}

.action-chip.extra { background: var(--primary-green); }
.action-chip.without { background: var(--primary-red); }
.action-chip.offer { background: var(--primary-orange); }

.action-chip:hover {
  opacity: 0.9;
  transform: translateY(-1px);
}

.search-container {
  position: relative;
  display: flex;
  background: var(--bg-white);
  border-radius: 6px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  height: 85%;
}

.search-icon {
  position: absolute;
  left: var(--spacing-md);
  top: 50%;
  transform: translateY(-50%);
  width: clamp(14px, 1.6vw, 20px);
  height: clamp(14px, 1.6vw, 20px);
  z-index: 1;
}

.search-input {
  width: clamp(200px, 25vw, 350px);
  padding: var(--spacing-sm) var(--spacing-md);
  padding-left: calc(var(--spacing-md) * 2 + 20px);
  border: none;
  font-size: clamp(12px, 1.4vw, 16px);
  font-family: 'Nunito', sans-serif;
  background: transparent;
  height: 100%;
}

.search-input:focus {
  outline: none;
}

.filter-button {
  width: clamp(40px, 5vw, 60px);
  background: var(--primary-blue);
  border: none;
  cursor: pointer;
  transition: background 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.filter-button:hover {
  background: #025bb5;
}

.filter-button img {
  width: clamp(16px, 1.8vw, 24px);
  height: clamp(16px, 1.8vw, 24px);
}

/* Product Grid */
.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 16px;
  padding: 20px;
  max-height: calc(100vh - 200px);
  overflow-y: auto;
  overflow-x: hidden;
}


.product-grid::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}

.product-grid::-webkit-scrollbar-track {
  background: transparent;
}

.product-grid::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

.product-card {
  aspect-ratio: 3/4;
  background: var(--bg-white);
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  border: none;
  display: flex;
  flex-direction: column;
    min-width: 0; /* ŸÑŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÑÿ™ŸÇŸÑÿµ */

}

.product-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.product-image {
  width: 100%;
  height: 70%;
  object-fit: cover;
    flex-shrink: 0;

}

.product-info {
  height: 30%;
  padding: clamp(4px, 0.8vw, 12px);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: clamp(4px, 0.6vw, 8px);
  width: 100%;
  min-height: 0;
}

.product-name {
  font-family: 'Cairo', sans-serif;
  font-size: clamp(8px, 1.2vw, 16px);
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.2;
  text-align: right; /* ŸÖÿ≠ÿßÿ∞ÿßÿ© ŸÑŸÑŸäŸÖŸäŸÜ ŸÑŸÑŸÜÿµ ÿßŸÑÿπÿ±ÿ®Ÿä */
  flex: 1; /* Ÿäÿ£ÿÆÿ∞ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑŸÖÿ™ÿßÿ≠ÿ© */
  min-width: 0; /* Ÿäÿ≥ŸÖÿ≠ ÿ®ÿßŸÑÿ™ŸÇŸÑÿµ */
  word-wrap: break-word;
    flex-direction: row; /* ÿ™ÿ∫ŸäŸäÿ± ŸÖŸÜ column ÿ•ŸÑŸâ row */

  overflow-wrap: break-word;
  hyphens: auto;
  display: -webkit-box;
  -webkit-line-clamp: 2; /* ÿßŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿ≥ÿ∑ÿ±ŸäŸÜ ŸÉÿ≠ÿØ ÿ£ŸÇÿµŸâ */
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.product-price {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: clamp(2px, 0.3vw, 4px);
  width: 100%;
}

.product-price .price {
  font-size: clamp(9px, 1.4vw, 18px);
  font-weight: 700;
  color: var(--text-primary);
  white-space: nowrap; /* ŸÖŸÜÿπ ÿßŸÑŸÜŸÇŸÑ ŸÑŸÑÿ≥ÿ∑ÿ± ÿßŸÑÿ™ÿßŸÑŸä */
}
.product-price .currency {
  font-size: clamp(7px, 1vw, 14px);
  font-weight: 600;
  color: var(--text-secondary);
  white-space: nowrap; /* ŸÖŸÜÿπ ÿßŸÑŸÜŸÇŸÑ ŸÑŸÑÿ≥ÿ∑ÿ± ÿßŸÑÿ™ÿßŸÑŸä */
}

/* Categories Sidebar */
.categories-sidebar {
  width: clamp(80px, 10vw, 120px);
  background: transparent;
  flex-shrink: 0;
}

.categories-list {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  height: 100%;
  overflow-y: auto;
  padding: var(--spacing-sm);
 scrollbar-width: none;
  scrollbar-color: var(--border-color) transparent;
}

.categories-list::-webkit-scrollbar {
  width: 4px;
}

.categories-list::-webkit-scrollbar-track {
  background: transparent;
}

.categories-list::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

.category-item {
  aspect-ratio: 1;
  background: var(--bg-white);
  border-radius: 8px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-sm);
  text-align: center;
}

.category-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.category-item.active {
  border-color: var(--primary-blue);
}

.category-item img {
  width: clamp(24px, 3vw, 48px);
  height: clamp(24px, 3vw, 48px);
  object-fit: contain;
}

.category-item span {
  font-family: 'Cairo', sans-serif;
  font-size: clamp(8px, 1vw, 14px);
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.2;
}

/* Order Summary */
.order-summary {
  width: clamp(280px, 35vw, 400px);
  background: var(--bg-white);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 2px 16px rgba(0, 0, 0, 0.1);
  flex-shrink: 0;
}

.order-header {
  height: clamp(50px, 7vh, 80px);
  display: flex;
  flex-shrink: 0;
}

.order-number {
  flex: 1;
  background: var(--primary-blue);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(16px, 2vw, 24px);
  font-weight: 700;
  border-radius: 8px 0 0 0;
}

.order-total {
  width: clamp(100px, 12vw, 150px);
  border: 2px solid var(--primary-blue);
  color: var(--primary-blue);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  border-radius: 0 8px 0 0;
}

.order-total .amount {
  font-size: clamp(16px, 2vw, 24px);
  font-weight: 700;
}

.order-total .currency {
  font-size: clamp(10px, 1.2vw, 16px);
  font-weight: 600;
}

.order-content {
  flex: 1;
  padding: var(--spacing-lg);
  overflow-y: auto;
  scrollbar-width: none;
  scrollbar-color: var(--border-color) transparent;
}

.order-content::-webkit-scrollbar {
  width: 6px;
}

.order-content::-webkit-scrollbar-track {
  background: transparent;
}

.order-content::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

.order-title {
  font-size: clamp(14px, 1.6vw, 20px);
  font-weight: 700;
  margin-bottom: var(--spacing-lg);
  color: var(--text-primary);
  
}

.customer-input {
  display: flex;
  margin-bottom: var(--spacing-lg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  overflow: hidden;
}

.customer-field {
  flex: 1;
  padding: var(--spacing-sm) var(--spacing-md);
  border: none;
  font-size: clamp(10px, 1.2vw, 14px);
  font-family: 'Nunito', sans-serif;
  background: transparent;
}

.customer-field:focus {
  outline: none;
}

.customer-button {
  width: clamp(30px, 4vw, 45px);
  background: var(--primary-blue);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s ease;
}

.customer-button:hover {
  background: #025bb5;
}

.customer-button img {
  width: clamp(12px, 1.4vw, 18px);
  height: clamp(12px, 1.4vw, 18px);
}

.order-items {
  max-height: 50vh; /* ÿ≤ŸäÿßÿØÿ© ŸÖŸÜ 40vh ÿ•ŸÑŸâ 50vh */
  margin-bottom: var(--spacing-md); /* ŸÉÿßŸÜ var(--spacing-lg) */
  scrollbar-width: thin;
  scrollbar-color: var(--border-color) transparent;
}

.order-items::-webkit-scrollbar {
  width: 4px;
}

.order-items::-webkit-scrollbar-track {
  background: transparent;
}

.order-items::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

.order-item {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding-bottom: var(--spacing-sm);
  margin-bottom: var(--spacing-sm);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.item-details {
  display: flex;
  gap: var(--spacing-sm);
  align-items: flex-start;
  flex: 1;
  min-width: 0; /* ŸÑŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÑÿ™ŸÇŸÑÿµ */
}

.delete-button {
  background: none;
  border: none;
  cursor: pointer;
  padding: var(--spacing-xs);
  border-radius: 4px;
  transition: background 0.2s ease;
}

.delete-button:hover {
  background: rgba(229, 57, 53, 0.1);
}

.delete-button img {
  width: clamp(12px, 1.4vw, 16px);
  height: clamp(12px, 1.4vw, 16px);
}

.item-info {
  flex: 1;
  min-width: 0;
}

.item-name {
  font-size: clamp(11px, 1.3vw, 16px);
  font-weight: 600;
  margin-bottom: var(--spacing-xs);
  color: var(--text-primary);
  line-height: 1.2;
}

.item-extra {
  font-size: clamp(9px, 1.1vw, 13px);
  color: var(--text-secondary);
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-xs);
}

.extra-price,
.extra-total {
  font-size: clamp(9px, 1.1vw, 13px);
  color: var(--text-secondary);
}

.item-prices {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  flex-shrink: 0;
  min-width: fit-content;
}

.item-price::after {
  content: "|";
  margin-left: var(--spacing-xs);
  color: var(--text-secondary);
  font-weight: normal;
}

.item-price {
  font-size: clamp(10px, 1.2vw, 14px);
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
}

.item-total {
  font-size: clamp(11px, 1.3vw, 16px);
  font-weight: 700;
  color: var(--primary-blue);
  white-space: nowrap;
}

.order-footer {
  padding: var(--spacing-md); /* ŸÉÿßŸÜ var(--spacing-lg) */
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
}

.summary-rows {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm); /* ŸÉÿßŸÜ var(--spacing-md) */
  margin-bottom: var(--spacing-md); /* ŸÉÿßŸÜ var(--spacing-lg) */
}

.summary-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(10px, 1.2vw, 15px); /* ŸÉÿßŸÜ 11px, 1.3vw, 16px */
  font-weight: 500;
  line-height: 1.3; /* ÿ•ÿ∂ÿßŸÅÿ© line-height ŸÑŸÑŸàÿ∂Ÿàÿ≠ */
}

.summary-row span:last-child {
  font-weight: 700;
  color: var(--text-primary); /* ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑŸÑŸàŸÜ */
}

.total-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(13px, 1.5vw, 19px); /* ŸÉÿßŸÜ 14px, 1.6vw, 20px */
  font-weight: 700;
  padding-top: var(--spacing-md); /* ŸÉÿßŸÜ var(--spacing-lg) */
  border-top: 2px solid var(--border-color);
  margin-bottom: var(--spacing-md); /* ŸÉÿßŸÜ var(--spacing-lg) */
}

.action-buttons {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--spacing-md);
}

.action-button {
  height: clamp(40px, 6vh, 60px);
  border-radius: 6px;
  border: none;
  color: white;
  font-size: clamp(10px, 1.2vw, 16px);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
}

.action-button img {
  width: clamp(12px, 1.4vw, 18px);
  height: clamp(12px, 1.4vw, 18px);
}

.action-button:hover {
  opacity: 0.9;
  transform: translateY(-1px);
}

.action-button.send { background: var(--primary-red); }
.action-button.print { background: var(--primary-blue); }
.action-button.pay { background: var(--primary-green); }

/* Responsive breakpoints */
@media (max-width: 1366px) {
  :root {
    --scale-factor: 0.9;
  }
    .product-grid {
    grid-template-columns: repeat(6, 1fr);
  }
    .summary-rows {
    gap: calc(var(--spacing-sm) * 0.8);
  }
  
  .order-items {
    max-height: 45vh;
  }
  
}

@media (max-width: 1024px) {
  :root {
    --scale-factor: 0.8;
  }
  
  .product-grid {
    grid-template-columns: repeat(6, 1fr);
  }
    .summary-rows {
    gap: calc(var(--spacing-sm) * 0.6);
  }
  
  .order-items {
    max-height: 42vh;
  }
}

@media (min-width: 1920px) {
  :root {
    --scale-factor: 1.1;
  }
}

@media (min-width: 2560px) {
  :root {
    --scale-factor: 1.3;
  }
}

/* Print styles */
@media print {
  .pos-system {
    transform: none !important;
    width: 100% !important;
    height: auto !important;
  }
}



/* ÿ•ÿ∂ÿßŸÅÿ© media query ŸÑŸÖŸÜÿ∑ŸÇÿ© 1400-1600px */
@media (min-width: 1400px) and (max-width: 1600px) {
  :root {
    --scale-factor: 0.95; /* ŸÇŸäŸÖÿ© Ÿàÿ≥ÿ∑ */
    --base-font-size: clamp(12px, 1vw, 18px); /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆÿ∑ */
  }
  
  .product-grid {
    grid-template-columns: repeat(7, 1fr);
    gap: var(--spacing-md);
  }
  
  /* ÿ™ÿ´ÿ®Ÿäÿ™ ÿßÿ±ÿ™ŸÅÿßÿπÿßÿ™ ÿßŸÑÿπŸÜÿßÿµÿ± */
  .action-buttons-bar {
    height: clamp(55px, 8vh, 85px);
  }
  
  
  .top-bar {
    height: clamp(65px, 9vh, 105px);
  }
}

.loading-message {
  grid-column: 1 / -1;
  text-align: center;
  padding: 2rem;
  font-size: 1.6rem;
  color: var(--text-secondary);
}

.item-size {
  font-size: clamp(9px, 1vw, 12px);
  color: var(--primary-blue);
  font-weight: 500;
}

.product-card .product-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-xs);
}

.product-card .product-name {
  order: 1;
}

.product-card .product-price {
  order: 2;
}


.item-size-inline {
  color: var(--primary-blue);
  font-weight: 500;
  font-size: 0.9em; /* ÿ£ÿµÿ∫ÿ± ŸÇŸÑŸäŸÑÿßŸã ŸÖŸÜ ÿßÿ≥ŸÖ ÿßŸÑÿµŸÜŸÅ */
}

.back-button {
  background-color: #f0f0f0 !important;
  border: 2px solid #ddd !important;
  color: var(--text-primary) !important;
}

.back-button:hover {
  background-color: #e0e0e0 !important;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ responsive ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸÖÿÆÿ™ŸÑŸÅÿ© */
@media (max-width: 1366px) {
  .product-name {
    font-size: clamp(7px, 1.1vw, 14px);
    -webkit-line-clamp: 2;
  }
  
  .product-price .price {
    font-size: clamp(8px, 1.3vw, 16px);
  }
  
  .product-price .currency {
    font-size: clamp(6px, 0.9vw, 12px);
  }
}

@media (max-width: 1024px) {
  .product-name {
    font-size: clamp(6px, 1vw, 12px);
    -webkit-line-clamp: 2;
  }
  
  .product-price .price {
    font-size: clamp(7px, 1.2vw, 14px);
  }
  
  .product-price .currency {
    font-size: clamp(5px, 0.8vw, 10px);
  }
  
  .item-prices {
    flex-direction: column;
    gap: 2px;
    align-items: flex-end;
  }
  
  .item-price::after {
    display: none;
  }
}

/* ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑŸÉÿ®Ÿäÿ±ÿ© */
@media (min-width: 1920px) {
  .product-name {
    font-size: clamp(10px, 1.4vw, 20px);
  }
  
  .product-price .price {
    font-size: clamp(12px, 1.6vw, 22px);
  }
  
  .product-price .currency {
    font-size: clamp(9px, 1.2vw, 18px);
  }
}

/* ÿ¨ÿπŸÑ ÿßŸÑÿµŸÅÿ≠ÿ© ÿØÿßÿ¶ŸÖÿßŸã LTR */
.pos-system {
  direction: ltr !important;
}

.pos-system * {
  direction: ltr !important;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¥ŸÉŸÑ ÿßŸÑŸÄ Material UI Icons */
.back-button {
  background-color: #f0f0f0 !important;
  border: 2px solid #ddd !important;
  color: var(--text-primary) !important;
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
}

.back-button:hover {
  background-color: #e0e0e0 !important;
}

.back-button .MuiSvgIcon-root {
  font-size: 18px !important;
  color: var(--text-primary) !important;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¥ŸÉŸÑ ÿ≤ÿ± ÿßŸÑÿ•ÿ∫ŸÑÿßŸÇ ŸÅŸä ÿßŸÑŸÄ popup */
.popup-close {
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  border-radius: 6px;
  transition: background 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.popup-close:hover {
  background: #f0f0f0;
}

.popup-close .MuiSvgIcon-root {
  font-size: 20px !important;
  color: var(--text-secondary) !important;
}

.popup-close:hover .MuiSvgIcon-root {
  color: var(--text-primary) !important;
}

/* ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ ÿßŸÑŸÄ popup overlay ŸäŸÖŸÉŸÜ ÿßŸÑÿ∂ÿ∫ÿ∑ ÿπŸÑŸäŸá */
.popup-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  cursor: pointer; /* ÿ•ÿ∂ÿßŸÅÿ© cursor ŸÑŸÑÿ•ÿ¥ÿßÿ±ÿ© ÿ£ŸÜŸá ŸÇÿßÿ®ŸÑ ŸÑŸÑÿ∂ÿ∫ÿ∑ */
}

.popup-content {
  cursor: default; /* ÿ•ÿ≤ÿßŸÑÿ© cursor ŸÖŸÜ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ */
  /* ÿ®ÿßŸÇŸä ÿßŸÑŸÄ styles ŸÉŸÖÿß ŸáŸä */
}

/* ÿ•ÿ∂ÿßŸÅÿ© animation ŸÑŸÑŸÄ popup */
.popup-overlay {
  animation: fadeIn 0.2s ease-out;
}

.popup-content {
  animation: slideIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideIn {
  from {
    transform: translateY(-20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}


/* ÿ∂ŸÖÿßŸÜ ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÅŸä ÿßŸÑÿµŸÅ ÿ≠ÿ≥ÿ® ÿ≠ÿ¨ŸÖ ÿßŸÑÿ¥ÿßÿ¥ÿ© */

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© ÿ¨ÿØÿßŸã - 7 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (min-width: 1920px) {
  .product-grid {
    grid-template-columns: repeat(7, 1fr);
    gap: 20px;
    padding: 24px;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÉÿ®Ÿäÿ±ÿ© - 6-7 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (max-width: 1600px) {
  .product-grid {
    grid-template-columns: repeat(6, 1fr);
    gap: 18px;
    padding: 22px;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÖÿ™Ÿàÿ≥ÿ∑ÿ© - 6 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (max-width: 1400px) {
  .product-grid {
    grid-template-columns: repeat(6, 1fr);
    gap: 16px;
    padding: 20px;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ŸÑÿßÿ®ÿ™Ÿàÿ® - 5-6 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (max-width: 1200px) {
  .product-grid {
    grid-template-columns: repeat(5, 1fr);
    gap: 14px;
    padding: 18px;
  }
}

/* ÿ¥ÿßÿ¥ÿßÿ™ ÿµÿ∫Ÿäÿ±ÿ© - 5 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (max-width: 1024px) {
  .product-grid {
    grid-template-columns: repeat(5, 1fr);
    gap: 12px;
    padding: 16px;
  }
}

/* ÿ™ÿßÿ®ŸÑÿ™ - 5 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (max-width: 768px) {
  .product-grid {
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
    padding: 14px;
  }
}

/* ŸÖŸàÿ®ÿßŸäŸÑ - 5 ŸÖŸÜÿ™ÿ¨ÿßÿ™ */
@media (max-width: 480px) {
  .product-grid {
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
    padding: 12px;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© ŸÑŸÑÿ¥ÿ®ŸÉÿ© */
.product-grid::-webkit-scrollbar {
  width: 8px;
}

.product-grid::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 4px;
}

.product-grid::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 4px;
}

.product-grid::-webkit-scrollbar-thumb:hover {
  background: #a8a8a8;
}

/* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿ¥ÿ®ŸÉÿ© */
.product-grid {
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}



/* ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ŸÑŸÑŸÄ CSS ÿßŸÑŸÖŸàÿ¨ŸàÿØ */

/* Order Item Selection */
.order-item {
  cursor: pointer;
  transition: all 0.3s ease;
}

.order-item.selected {
  background: rgba(3, 115, 237, 0.1);
  border-left: 4px solid #0373ed;
}

.order-item:hover {
  background: rgba(0, 0, 0, 0.05);
}

/* Extra/Without Items */
.extra-item {
  border-left: 3px solid #28a745;
}

.without-item {
  border-left: 3px solid #dc3545;
}

.extra-badge {
  background: #28a745;
  color: white;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 10px;
  margin-right: 4px;
  font-weight: 600;
}

.without-badge {
  background: #dc3545;
  color: white;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 10px;
  margin-right: 4px;
  font-weight: 600;
}

.item-total.negative {
  color: #dc3545;
  font-weight: 600;
}
/* Sub-items styling */
.sub-items-container {
  margin-top: 6px;
  padding-left: 8px;
  border-left: 2px solid #f0f0f0;
}

.sub-item {
  margin-bottom: 3px;
}

.sub-item-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 2px 0;
}

.sub-item-info {
  display: flex;
  align-items: center;
  gap: 4px;
  flex: 1;
}

.sub-item-badge {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 8px;
  font-weight: 600;
  color: white;
  flex-shrink: 0;
}

.sub-item-badge.extra {
  background: #28a745;
}

.sub-item-badge.without {
  background: #dc3545;
}

.sub-item-badge.option {
  background: #6c757d;
}

.sub-item-text {
  font-size: 10px;
  color: #666;
  line-height: 1.2;
}

.sub-item-delete {
  width: 16px;
  height: 16px;
  border: none;
  background: transparent;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.6;
  transition: opacity 0.2s ease;
}

.sub-item-delete:hover {
  opacity: 1;
}

.sub-item-delete img {
  width: 12px;
  height: 12px;
}

/* Loading and Error states */
.pos-system.loading,
.pos-system.error {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  flex-direction: column;
  gap: 20px;
}

.loading-spinner {
  font-size: 18px;
  color: #666;
}

.error-message {
  font-size: 16px;
  color: #dc3545;
  text-align: center;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .sub-item-text {
    font-size: 9px;
  }
  
  .sub-item-delete {
    width: 14px;
    height: 14px;
  }
  
  .sub-item-delete img {
    width: 10px;
    height: 10px;
  }
}



* ÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿ™ÿπŸÑŸäŸÇ */
.item-note {
  display: flex;
  align-items: flex-start;
  gap: 4px;
  margin-top: 4px;
  padding: 3px 6px;
  background: rgba(108, 117, 125, 0.1);
  border-radius: 4px;
  border-left: 2px solid #6c757d;
}

.note-icon {
  font-size: 10px;
  line-height: 1;
  flex-shrink: 0;
  margin-top: 1px;
}

.note-text {
  font-size: 10px;
  color: #6c757d;
  line-height: 1.2;
  font-style: italic;
  word-wrap: break-word;
  overflow-wrap: break-word;
  flex: 1;
}

/* ÿ™ÿ£ŸÉŸäÿØ ÿ£ŸÜ ÿßŸÑÿ™ÿπŸÑŸäŸÇ ÿ®ŸÜŸÅÿ≥ ÿ≠ÿ¨ŸÖ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
.item-note,
.option-detail,
.sub-item {
  font-size: 10px;
  line-height: 1.2;
  margin-top: 3px;
}

/* Responsive ŸÑŸÑÿ™ÿπŸÑŸäŸÇÿßÿ™ */
@media (max-width: 768px) {
  .item-note {
    padding: 2px 4px;
    margin-top: 3px;
  }
  
  .note-icon {
    font-size: 9px;
  }
  
  .note-text {
    font-size: 9px;
  }
}

@media (max-width: 480px) {
  .item-note {
    padding: 2px 3px;
    margin-top: 2px;
  }
  
  .note-icon {
    font-size: 8px;
  }
  
  .note-text {
    font-size: 8px;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© */
.item-note:empty {
  display: none;
}

.note-text:empty {
  display: none;
}

/* ÿ™ÿ£ÿ´Ÿäÿ± hover ÿÆŸÅŸäŸÅ */
.order-item:hover .item-note {
  background: rgba(108, 117, 125, 0.15);
}


/* ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅŸäÿ© */
.order-item.extra-item .item-note {
  background: rgba(40, 167, 69, 0.1);
  border-left-color: #28a745;
}

.order-item.extra-item .note-text {
  color: #28a745;
}

/* ŸÑŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ®ÿØŸàŸÜ */
.order-item.without-item .item-note {
  background: rgba(220, 53, 69, 0.1);
  border-left-color: #dc3545;
}

.order-item.without-item .note-text {
  color: #dc3545;
}




/* ÿ™ÿ≠ÿØŸäÿ´ Sub-items styling */
.order-item-container {
  margin-bottom: 8px;
}

.sub-items-container {
  margin-top: 6px;
  padding-left: 20px;
  border-left: 2px solid #f0f0f0;
}

.sub-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
  margin-bottom: 2px;
  min-height: 24px;
}

.sub-item-details {
  display: flex;
  align-items: center;
  gap: 6px;
  flex: 1;
}

.sub-item-info {
  display: flex;
  align-items: center;
  gap: 4px;
  flex: 1;
}

.sub-item-badge {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 8px;
  font-weight: 600;
  color: white;
  flex-shrink: 0;
}

.sub-item-badge.extra {
  background: #28a745;
}

.sub-item-badge.without {
  background: #dc3545;
}

.sub-item-badge.option {
  background: #6c757d;
}

.sub-item-name {
  font-size: 10px;
  color: #666;
  line-height: 1.2;
  font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
}

.sub-item-prices {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 2px;
  min-width: 60px;
}

.sub-item-price {
  font-size: 9px;
  color: #999;
  font-weight: 500;
}

.sub-item-total {
  font-size: 10px;
  color: #333;
  font-weight: 600;
}

.sub-item-total.negative {
  color: #dc3545;
}

.sub-item-delete {
  width: 16px;
  height: 16px;
  border: none;
  background: transparent;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.6;
  transition: opacity 0.2s ease;
  margin-left: 4px;
}

.sub-item-delete:hover {
  opacity: 1;
}

.sub-item-delete img {
  width: 10px;
  height: 10px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .sub-item-name {
    font-size: 9px;
  }
  
  .sub-item-price {
    font-size: 8px;
  }
  
  .sub-item-total {
    font-size: 9px;
  }
  
  .sub-item-delete {
    width: 14px;
    height: 14px;
  }
  
  .sub-item-delete img {
    width: 8px;
    height: 8px;
  }
}


/* ÿ≠ÿßŸÑÿ© ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑŸÖÿπÿ∑ŸÑÿ© */
.action-chip.disabled {
  opacity: 0.4;
  cursor: not-allowed;
  pointer-events: none;
}

.action-chip.disabled:hover {
  background: inherit;
  border-color: inherit;
  transform: none;
  box-shadow: none;
}

.action-chip.disabled img {
  opacity: 0.5;
}

.action-chip.disabled span {
  opacity: 0.5;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÄ tooltip */
.action-chip[title] {
  position: relative;
}

.action-chip[title]:hover::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  z-index: 1000;
  margin-bottom: 5px;
}

.action-chip[title]:hover::before {
  content: '';
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 5px solid transparent;
  border-top-color: #333;
  z-index: 1000;
}



===== src/Pages/pos/newSales/styles/TableSelectionPopup.module.css =====
/* src/Pages/pos/newSales/components/TableSelectionPopup.module.css */

/* Popup Overlay */
.popupOverlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.popupContainer {
  background: white;
  border-radius: 16px;
  width: 95%;
  max-width: 1400px;
  height: 90vh;
  position: relative;
  overflow: hidden;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

/* Close Button */
.closeBtn {
  position: absolute;
  top: 20px;
  left: 20px;
  background: #dc3545;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  z-index: 1001;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s ease;
  font-family: 'Cairo', sans-serif;
}

.closeBtn:hover {
  background: #c82333;
  transform: translateY(-2px);
}

/* Main Layout */
.posSystem {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.mainContent {
  flex: 1;
  display: flex;
  height: 100%;
  overflow: hidden;
}

/* Products Section (Tables) */
.productsSection {
  flex: 1;
  background: #f8f9fa;
  padding: 20px;
  overflow-y: auto;
  padding-top: 80px; /* Space for close button */
}

.productGrid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 16px;
  padding: 20px;
}

.productItem {
  background: white;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
  position: relative;
  min-height: 160px;
}

.productItem:hover:not(.occupied) {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
  border-color: #0373ed;
}

.productItem.occupied {
  opacity: 0.6;
  cursor: not-allowed;
  background: #f8f9fa;
}

.productItem.occupied::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(220, 53, 69, 0.1);
  border-radius: 12px;
}

.productImage {
  width: 60px;
  height: 60px;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f0f0f0;
}

.productImage img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.productName {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.productName span {
  font-size: 14px;
  font-weight: 600;
  color: #333;
  font-family: 'Cairo', sans-serif;
}

.productName small {
  font-size: 12px;
  color: #666;
  font-family: 'Cairo', sans-serif;
}

.status {
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 500;
  margin-top: 4px;
  display: inline-block;
  font-family: 'Cairo', sans-serif;
}

.status.available {
  background: #d4edda;
  color: #155724;
}

.status.occupied {
  background: #f8d7da;
  color: #721c24;
}

/* Categories Sidebar (Sections) */
.categoriesSidebar {
  width: 280px;
  background: white;
  border-left: 1px solid #e9ecef;
  padding: 20px;
  overflow-y: auto;
  height: 100%;
}

.categoriesList {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding-top: 20px;
}

.categoryItem {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: #f8f9fa;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
  text-align: left;
}

.categoryItem:hover {
  background: #e9ecef;
  transform: translateY(-2px);
}

.categoryItem.active {
  background: #0373ed;
  color: white;
  border-color: #0373ed;
}

.categoryItem.active span,
.categoryItem.active small {
  color: white;
}

.categoryItem img {
  width: 40px;
  height: 40px;
  border-radius: 6px;
  object-fit: cover;
  flex-shrink: 0;
}

.categoryItem span {
  font-size: 14px;
  font-weight: 600;
  color: #333;
  font-family: 'Cairo', sans-serif;
  line-height: 1.2;
}

.categoryItem small {
  font-size: 11px;
  color: #666;
  font-family: 'Cairo', sans-serif;
  margin-top: 2px;
}

/* Responsive Design */
@media (max-width: 1024px) {
  .productGrid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 12px;
    padding: 15px;
  }
  
  .categoriesSidebar {
    width: 240px;
  }
  
  .productItem {
    min-height: 140px;
    padding: 12px;
  }
}

@media (max-width: 768px) {
  .popupContainer {
    width: 98%;
    height: 95vh;
  }
  
  .mainContent {
    flex-direction: column;
  }
  
  .categoriesSidebar {
    width: 100%;
    height: 120px;
    border-left: none;
    border-top: 1px solid #e9ecef;
    padding: 15px;
  }
  
  .categoriesList {
    flex-direction: row;
    overflow-x: auto;
    gap: 8px;
    padding-top: 10px;
  }
  
  .categoryItem {
    min-width: 120px;
    padding: 8px;
    gap: 8px;
  }
  
  .categoryItem img {
    width: 32px;
    height: 32px;
  }
  
  .categoryItem span {
    font-size: 12px;
  }
  
  .categoryItem small {
    font-size: 10px;
  }
  
  .productsSection {
    padding: 15px;
    padding-top: 70px;
  }
  
  .productGrid {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
    padding: 10px;
  }
  
  .productItem {
    min-height: 120px;
    padding: 10px;
  }
  
  .productImage {
    width: 50px;
    height: 50px;
    margin-bottom: 8px;
  }
  
  .productName span {
    font-size: 12px;
  }
  
  .productName small {
    font-size: 10px;
  }
  
  .closeBtn {
    top: 10px;
    left: 10px;
    padding: 6px 12px;
    font-size: 12px;
  }
}

@media (max-width: 480px) {
  .productGrid {
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 8px;
  }
  
  .productItem {
    min-height: 100px;
    padding: 8px;
  }
  
  .productImage {
    width: 40px;
    height: 40px;
  }
  
  .productName span {
    font-size: 11px;
  }
  
  .status {
    font-size: 9px;
    padding: 1px 4px;
  }
}



/* ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑŸÖÿ§ŸÇÿ™ */
.timerOverlay {
  position: absolute;
  top: 8px;
  right: 8px;
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
  backdrop-filter: blur(4px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  z-index: 10;
}

.timerInfo {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.75rem;
  margin-top: 2px;
  color: #666;
}

.occupiedStatus {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.sectionStats {
  margin-top: 4px;
}

.tableCount {
  font-size: 0.7rem;
  color: #666;
  font-weight: 500;
}

.productItem.occupied {
  border: 2px solid #dc3545;
  background-color: #fee;
  cursor: not-allowed;
}

.productItem.available {
  border: 2px solid #28a745;
  background-color: #f0fff4;
  cursor: pointer;
}

.productItem.occupied:hover {
  transform: none;
  box-shadow: 0 4px 8px rgba(220, 53, 69, 0.2);
}

.productItem.available:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(40, 167, 69, 0.2);
}

.tableName {
  font-weight: 600;
  font-size: 1rem;
}

.tableCapacity {
  color: #666;
  font-size: 0.8rem;
}

/* ÿ£ŸÜŸÖÿßÿ∑ ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ */
.searchingMessage {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  color: #666;
  font-size: 14px;
}

.loadingSpinner {
  width: 16px;
  height: 16px;
  border: 2px solid #f3f3f3;
  border-top: 2px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}













/* TableSelectionPopup.module.css */

.productItem {
  position: relative;
  border-radius: 12px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
  cursor: pointer;
  overflow: hidden;
}

.productItem.occupied {
  background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%) !important;
  border: 2px solid #f44336 !important;
  box-shadow: 0 4px 12px rgba(244, 67, 54, 0.2);
}

.productItem.occupied:hover {
  background: linear-gradient(135deg, #ffcdd2 0%, #ef9a9a 100%) !important;
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(244, 67, 54, 0.3);
}

.productItem.available {
  background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c8 100%) !important;
  border: 2px solid #4caf50 !important;
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
}

.productItem.available:hover {
  background: linear-gradient(135deg, #c8e6c8 0%, #a5d6a5 100%) !important;
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(76, 175, 80, 0.3);
}

/* ÿ™ÿ≥ŸÖŸäÿ© ÿßŸÑÿ≠ÿßŸÑÿ© */
.status {
  position: absolute;
  top: 8px;
  right: 8px;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  z-index: 2;
}

.status.occupied {
  background: #f44336;
  color: white;
  animation: pulse 2s infinite;
}

.status.available {
  background: #4caf50;
  color: white;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.7; }
  100% { opacity: 1; }
}

/* ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ∑ÿßŸàŸÑÿ© ÿßŸÑŸÖÿ¥ÿ∫ŸàŸÑÿ© */
.occupiedInfo {
  background: rgba(244, 67, 54, 0.1);
  border: 1px solid rgba(244, 67, 54, 0.3);
  border-radius: 8px;
  padding: 8px;
  margin-top: 8px;
  font-size: 11px;
}

.orderTotal {
  font-weight: bold;
  color: #d32f2f;
  margin-bottom: 4px;
  font-size: 12px;
}

.openDuration {
  display: flex;
  align-items: center;
  gap: 4px;
  color: #666;
  margin-bottom: 4px;
  font-weight: 600;
}

.openDuration svg {
  color: #f44336;
  animation: tick 1s infinite;
}

@keyframes tick {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0.5; }
}

.itemsCount {
  color: #666;
  font-size: 10px;
}

/* ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑŸÖÿπÿßŸäŸÜÿ© */
.viewIcon {
  position: absolute;
  top: 8px;
  left: 8px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  border-radius: 50%;
  padding: 6px;
  font-size: 14px;
  z-index: 2;
  transition: all 0.3s ease;
}

.viewIcon:hover {
  background: rgba(0, 0, 0, 0.9);
  transform: scale(1.1);
}

/* ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ */
.occupiedStats {
  color: #f44336;
  font-weight: bold;
  font-size: 10px;
  margin-top: 2px;
}

===== src/Pages/pos/newSales/styles/tailwind.css =====
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Primary Colors */
    --primary-blue: #0373ed;
    --primary-green: #22a928;
    --primary-red: #e53935;
    --primary-orange: #ffb74d;

    /* Background Colors */
    --bg-main: #f5f5f5;
    --bg-card: #ffffff;
    --bg-overlay-light: #00000033;
    --bg-overlay-dark: #0000004c;

    /* Text Colors */
    --text-primary: #000000;
    --text-secondary: #0000007f;
    --text-white: #ffffff;
    --text-blue: #0373ed;
  }
}

@layer utilities {
  /* Primary Colors */
  .bg-primary-blue {
    background-color: var(--primary-blue);
  }
  .bg-primary-green {
    background-color: var(--primary-green);
  }
  .bg-primary-red {
    background-color: var(--primary-red);
  }
  .bg-primary-orange {
    background-color: var(--primary-orange);
  }

  /* Background Colors */
  .bg-main {
    background-color: var(--bg-main);
  }
  .bg-card {
    background-color: var(--bg-card);
  }
  .bg-overlay-light {
    background-color: var(--bg-overlay-light);
  }
  .bg-overlay-dark {
    background-color: var(--bg-overlay-dark);
  }

  /* Text Colors */
  .text-primary {
    color: var(--text-primary);
  }
  .text-secondary {
    color: var(--text-secondary);
  }
  .text-white {
    color: var(--text-white);
  }
  .text-blue {
    color: var(--text-blue);
  }
}
===== src/Pages/pos/newSales/styles/TodayOrdersPopup.module.css =====
/* src/Pages/pos/newSales/styles/TodayOrdersPopup.module.css */
.dialogPaper {
  max-height: 90vh;
  margin: 20px;
  border-radius: 12px !important;
}

.dialogTitle {
  background: linear-gradient(135deg, #0373ed 0%, #025bb5 100%);
  color: white !important;
  padding: 16px 24px !important;
  border-radius: 12px 12px 0 0 !important;
}

.dialogTitle .MuiTypography-root {
  font-weight: 600;
  font-family: 'Cairo', sans-serif;
}

.dialogContent {
  padding: 24px !important;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.filtersBar {
  display: flex;
  gap: 16px;
  align-items: center;
  padding: 16px;
  background: #f8f9fa;
  border-radius: 8px;
  flex-wrap: wrap;
}

.searchField {
  flex: 1;
  min-width: 250px;
}

.filterSelect {
  min-width: 150px;
}

.errorAlert {
  margin-bottom: 16px;
}

.tableContainer {
  flex: 1;
  max-height: 50vh;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.tableContainer .MuiTableHead-root {
  background: #f5f5f5;
}

.tableContainer .MuiTableCell-head {
  font-weight: 600;
  font-family: 'Cairo', sans-serif;
  background: #f5f5f5;
  border-bottom: 2px solid #dee2e6;
  padding: 12px 16px;
}

.tableRow {
  transition: background-color 0.2s ease;
}

.tableRow:hover {
  background-color: #f8f9fa;
}

.tableRow .MuiTableCell-root {
  padding: 12px 16px;
  border-bottom: 1px solid #e9ecef;
}

.invoiceId {
  font-family: 'Courier New', monospace;
  font-weight: 600;
  color: #495057;
}

.totalAmount {
  font-weight: 600;
  color: #28a745;
}

.viewButton {
  color: #0373ed;
  transition: all 0.2s ease;
}

.viewButton:hover {
  background-color: rgba(3, 115, 237, 0.1);
  transform: scale(1.1);
}

.loadingCell,
.emptyCell {
  padding: 40px 16px !important;
}

.paginationContainer {
  display: flex;
  justify-content: center;
  padding: 16px 0;
  border-top: 1px solid #e9ecef;
  margin-top: 16px;
}

.dialogActions {
  padding: 16px 24px !important;
  border-top: 1px solid #e9ecef;
  background: #f8f9fa;
  border-radius: 0 0 12px 12px;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
@media (max-width: 768px) {
  .dialogPaper {
    margin: 8px;
    max-height: 95vh;
  }
  
  .filtersBar {
    flex-direction: column;
    align-items: stretch;
  }
  
  .searchField,
  .filterSelect {
    min-width: auto;
    width: 100%;
  }
  
  .tableContainer {
    max-height: 40vh;
  }
  
  .tableContainer .MuiTableCell-head,
  .tableContainer .MuiTableCell-body {
    padding: 8px 12px;
    font-size: 0.875rem;
  }
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÑŸàÿ≠Ÿäÿ© */
@media (max-width: 1024px) {
  .tableContainer {
    max-height: 45vh;
  }
  
  .filtersBar {
    gap: 12px;
  }
}

/* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ */
.loadingCell {
  text-align: center;
}

.loadingCell .MuiCircularProgress-root {
  color: #0373ed;
}

/* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÄ Chips */
.tableRow .MuiChip-root {
  font-weight: 500;
  font-size: 0.75rem;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿπÿ±ÿ∂ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅŸäÿ© */
.tableRow .MuiBox-root {
  min-width: 120px;
}

.tableRow .MuiTypography-caption {
  display: block;
  font-size: 0.7rem;
  text-transform: uppercase;
  font-weight: 500;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑŸÅŸÑÿßÿ™ÿ± */
.filtersBar .MuiButton-root {
  white-space: nowrap;
  min-width: auto;
}

/* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿπŸÜŸàÿßŸÜ */
.dialogTitle .MuiIconButton-root {
  color: white;
}

.dialogTitle .MuiIconButton-root:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

===== src/Pages/pos/newSales/types/PosSystem.tsx =====
// src/Pages/pos/newSales/types/PosSystem.tsx
export interface PosProduct {
  id: string;
  name: string;
  nameArabic: string;
  image: string;
  categoryId: string;
  productType: number; // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ÿßŸÑÿ≠ŸÇŸÑ
  productPrices: PosPrice[];
  hasMultiplePrices: boolean;
  displayPrice?: number;
  productOptionGroups?: ProductOptionGroup[]; // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™
}


export interface ProductOptionGroup {
  id: string;
  name: string;
  isRequired: boolean;
  allowMultiple: boolean;
  minSelection: number;
  maxSelection: number;
  sortOrder: number;
  optionItems: ProductOptionItem[];
}

export interface ProductOptionItem {
  id: string;
  name: string;
  productPriceId?: string | null; // Change this line to support null
  useOriginalPrice: boolean;
  extraPrice: number;
  isCommentOnly: boolean;
  sortOrder: number;
}

export interface SelectedOption {
  groupId: string;
  itemId: string;
  itemName: string;
  quantity: number;
  extraPrice: number;
  isCommentOnly: boolean;
}

export interface PosPrice {
  id: string;
  name: string;
  nameArabic: string;
  price: number;
  barcode: string;
}

export interface CategoryItem {
  id: string;
  name: string;
  nameArabic: string;
  image: string;
  products?: PosProduct[]; // ‚úÖ ÿ•ÿ∂ÿßŸÅÿ© Ÿáÿ∞ÿß ÿßŸÑÿ≠ŸÇŸÑ
  parentId?: string;
  children?: CategoryItem[];
  hasChildren: boolean;
  hasProducts?: boolean;
  selected?: boolean;
}

export interface OrderItem {
  id: string;
  product: PosProduct;
  selectedPrice: PosPrice;
  quantity: number;
  totalPrice: number;
  selectedOptions?: SelectedOption[]; // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ©
  notes?: string;
    isExtra?: boolean;        // ÿ¨ÿØŸäÿØ
  isWithout?: boolean;      // ÿ¨ÿØŸäÿØ
  parentItemId?: string;    // ÿ¨ÿØŸäÿØ - ŸÑŸÑÿ±ÿ®ÿ∑ ÿ®ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑÿ£ÿµŸÑŸä
  subItems?: SubItem[]; // ÿ¨ÿØŸäÿØ - ŸÑŸÑÿπŸÜÿßÿµÿ± ÿßŸÑŸÅÿ±ÿπŸäÿ©
  discountPercentage?: number; // ÿ¨ÿØŸäÿØ
  discountAmount?: number; // ÿ¨ÿØŸäÿØ
}


export interface SubItem {
  id: string;
  type: 'option' | 'extra' | 'without';
  name: string;
  quantity: number;
  price: number;
  isRequired?: boolean; // ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©
  groupId?: string; // ŸÑŸÑŸÖÿ¨ŸÖŸàÿπÿßÿ™
  productId?: string; // ŸÑŸÑÿ•ÿ∂ÿßŸÅÿßÿ™/ÿ®ÿØŸàŸÜ
}

export interface OrderSummary {
  totalAfterTaxAndService: number;
  totalAfterDiscount: number;
  items: OrderItem[];
  subtotal: number;
  discount: number;
  tax: number;
  service: number;
  total: number;
}
===== src/Pages/pos/newSales/types/TableSystem.ts =====
// src/Pages/pos/newSales/types/TableSystem.ts
export interface Table {
  id?: string;
  name: string;
  sectionId: string;
  sectionName?: string;
  capacity: number;
  isOccupied?: boolean;
  currentOrderId?: string;
    image?: string; // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
}

export interface TableSection {
  id: string;
  name: string;
  branchName?: string;
  serviceCharge: number;
  tables: Table[];
  branchId: string;
  companyID?: string;
  isActive: boolean;
    image?: string; // ÿ•ÿ∂ÿßŸÅÿ© ÿ¨ÿØŸäÿØÿ©
}

export interface TableSelection {
  section: TableSection;
  table: Table;
}
