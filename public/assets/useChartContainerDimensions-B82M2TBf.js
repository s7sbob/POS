import{j as C,s as z,i as U,p as T}from"./Typography-BDkkff4Z.js";import{r as i,j as M}from"./index-BOycD4kd.js";import{u as V}from"./useId-B1jnamIH.js";import{u as N}from"./useThemeProps-VRAKZLnh.js";import{o as k}from"./ownerWindow-dn6wgS8C.js";function O(t){return t.bandwidth!==void 0}const at="DEFAULT_X_AXIS_KEY",ot="DEFAULT_Y_AXIS_KEY",q={top:50,bottom:50,left:50,right:50},K=(t,e,s)=>{const n=C({},q,s);return i.useMemo(()=>({left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:Math.max(0,t-n.left-n.right),height:Math.max(0,e-n.top-n.bottom)}),[t,e,n.top,n.bottom,n.left,n.right])},X=i.createContext({top:0,left:0,bottom:0,right:0,height:300,width:400,chartId:"",isPointInside:()=>!1}),F=i.createContext({isInitialized:!1,data:{current:null}});function ct(t){const{width:e,height:s,margin:n,svgRef:c,children:h}=t,u=K(e,s,n),f=V(),I=i.useCallback(({x:o,y:m},r)=>{if(r!=null&&r.targetElement&&(r!=null&&r.targetElement.closest("[data-drawing-container]")))return!0;const p=o>=u.left-1&&o<=u.left+u.width,y=m>=u.top-1&&m<=u.top+u.height;return(r==null?void 0:r.direction)==="x"?p:((r==null?void 0:r.direction)==="y"||p)&&y},[u]),x=i.useMemo(()=>C({chartId:f??""},u,{isPointInside:I}),[f,u,I]),a=i.useMemo(()=>({isInitialized:!0,data:c}),[c]);return M.jsx(F.Provider,{value:a,children:M.jsx(X.Provider,{value:x,children:h})})}function $(){const{left:t,top:e,width:s,height:n,bottom:c,right:h,isPointInside:u}=i.useContext(X);return i.useMemo(()=>({left:t,top:e,width:s,height:n,bottom:c,right:h,isPointInside:u}),[n,t,e,s,c,h,u])}function ut(t){return function(){return t}}const dt=Math.abs,lt=Math.atan2,ht=Math.cos,ft=Math.max,mt=Math.min,xt=Math.sin,gt=Math.sqrt,Ct=1e-12,j=Math.PI,D=j/2,It=2*j;function wt(t){return t>1?0:t<-1?j:Math.acos(t)}function pt(t){return t>=1?D:t<=-1?-D:Math.asin(t)}const B=i.createContext({isInitialized:!1,data:{xAxis:{},yAxis:{},xAxisIds:[],yAxisIds:[]}}),G=()=>{const{data:t}=i.useContext(B);return t},S=i.createContext({item:null,axis:{x:null,y:null},useVoronoiInteraction:!1,dispatch:()=>null}),W=(t,e)=>{switch(e.type){case"enterItem":return C({},t,{item:e.data});case"exitChart":return t.item===null&&t.axis.x===null&&t.axis.y===null?t:C({},t,{axis:{x:null,y:null},item:null});case"updateVoronoiUsage":return C({},t,{useVoronoiInteraction:e.useVoronoiInteraction});case"leaveItem":return t.item===null||Object.keys(e.data).some(s=>e.data[s]!==t.item[s])?t:C({},t,{item:null});case"updateAxis":return e.data.x===t.axis.x&&e.data.y===t.axis.y?t:C({},t,{axis:e.data});default:return t}};function At(t){const{children:e}=t,[s,n]=i.useReducer(W,{item:null,axis:{x:null,y:null},useVoronoiInteraction:!1}),c=i.useMemo(()=>C({},s,{dispatch:n}),[s]);return M.jsx(S.Provider,{value:c,children:e})}function H(){const{isInitialized:t,data:e}=i.useContext(F);if(!t)throw new Error(["MUI X: Could not find the svg ref context.","It looks like you rendered your component outside of a ChartsContainer parent component."].join(`
`));return e}function J(t,e){const s=t.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s.matrixTransform(t.getScreenCTM().inverse())}function v(t){return t instanceof Date?t.getTime():t}const Q=t=>{const e=H(),s=$(),{xAxis:n,yAxis:c,xAxisIds:h,yAxisIds:u}=G(),{dispatch:f}=i.useContext(S),I=h[0],x=u[0],a=i.useRef({isInChart:!1,x:-1,y:-1});i.useEffect(()=>{const o=e.current;if(o===null||t)return()=>{};function m(g,w){const{scale:d,data:l,reverse:_}=g;if(!O(d)){const A=d.invert(w);if(l===void 0)return{value:A,index:-1};const b=v(A),P=l==null?void 0:l.findIndex((Y,L)=>{const R=v(Y);return R>b&&(L===0||Math.abs(b-R)<=Math.abs(b-v(l[L-1])))||R<=b&&(L===l.length-1||Math.abs(v(A)-R)<Math.abs(v(A)-v(l[L+1])))});return{value:P!==void 0&&P>=0?l[P]:A,index:P}}const E=d.bandwidth()===0?Math.floor((w-Math.min(...d.range())+d.step()/2)/d.step()):Math.floor((w-Math.min(...d.range()))/d.step());if(E<0||E>=l.length)return null;if(_){const A=l.length-1-E;return{index:A,value:l[A]}}return{index:E,value:l[E]}}const r=()=>{a.current={isInChart:!1,x:-1,y:-1},f({type:"exitChart"})},p=g=>{const w="targetTouches"in g?g.targetTouches[0]:g,d=J(o,w);if(a.current.x=d.x,a.current.y=d.y,!s.isPointInside(d,{targetElement:g.target})){a.current.isInChart&&(f({type:"exitChart"}),a.current.isInChart=!1);return}a.current.isInChart=!0;const l=m(n[I],d.x),_=m(c[x],d.y);f({type:"updateAxis",data:{x:l,y:_}})},y=g=>{const w=g.currentTarget;w&&w.hasPointerCapture(g.pointerId)&&w.releasePointerCapture(g.pointerId)};return o.addEventListener("pointerdown",y),o.addEventListener("pointermove",p),o.addEventListener("pointerout",r),o.addEventListener("pointercancel",r),o.addEventListener("pointerleave",r),()=>{o.removeEventListener("pointerdown",y),o.removeEventListener("pointermove",p),o.removeEventListener("pointerout",r),o.removeEventListener("pointercancel",r),o.removeEventListener("pointerleave",r)}},[e,f,x,c,I,n,t,s])},Z=["children","width","height","viewBox","disableAxisListener","className","title","desc"],tt=z("svg",{name:"MuiChartsSurface",slot:"Root"})(()=>({touchAction:"none"})),vt=i.forwardRef(function(e,s){const n=N({props:e,name:"MuiChartsSurface"}),{children:c,width:h,height:u,viewBox:f,disableAxisListener:I=!1,className:x,title:a,desc:o}=n,m=U(n,Z),r=C({width:h,height:u,x:0,y:0},f);return Q(I),M.jsxs(tt,C({width:h,height:u,viewBox:`${r.x} ${r.y} ${r.width} ${r.height}`,ref:s,className:x},m,{children:[M.jsx("title",{children:a}),M.jsx("desc",{children:o}),c]}))}),Mt=(t,e,s)=>{const n=i.useRef({displayError:!1,initialCompute:!0,computeRun:0}),c=i.useRef(null),[h,u]=i.useState(0),[f,I]=i.useState(0),x=i.useCallback(()=>{const a=c==null?void 0:c.current;if(!a)return{};const m=k(a).getComputedStyle(a),r=Math.floor(parseFloat(m.height))||0,p=Math.floor(parseFloat(m.width))||0;return u(p),I(r),{width:p,height:r}},[]);return i.useEffect(()=>{n.current.displayError=!0},[]),T(()=>{if(!s||!n.current.initialCompute||n.current.computeRun>20)return;const a=x();a.width!==h||a.height!==f?n.current.computeRun+=1:n.current.initialCompute&&(n.current.initialCompute=!1)},[h,f,x,s]),T(()=>{if(t!==void 0&&e!==void 0)return()=>{};x();const a=c.current;if(typeof ResizeObserver>"u")return()=>{};let o;const m=new ResizeObserver(()=>{o=requestAnimationFrame(()=>{x()})});return a&&m.observe(a),()=>{o&&cancelAnimationFrame(o),a&&m.unobserve(a)}},[x,e,t]),{containerRef:c,width:t??h,height:e??f}};export{B as C,at as D,S as I,ot as a,$ as b,ut as c,X as d,ct as e,At as f,vt as g,Mt as h,O as i,H as j,ht as k,D as l,Ct as m,gt as n,mt as o,j as p,dt as q,lt as r,xt as s,It as t,G as u,pt as v,wt as w,ft as x,J as y};
